{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.slice.js\");\nrequire(\"core-js/modules/es.array.from.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.GlobalFormio = void 0;\nrequire(\"core-js/modules/es.regexp.exec.js\");\nrequire(\"core-js/modules/es.string.match.js\");\nrequire(\"core-js/modules/es.string.search.js\");\nrequire(\"core-js/modules/es.string.split.js\");\nrequire(\"core-js/modules/es.array.concat.js\");\nrequire(\"core-js/modules/es.regexp.constructor.js\");\nrequire(\"core-js/modules/es.regexp.to-string.js\");\nrequire(\"core-js/modules/es.string.replace.js\");\nrequire(\"core-js/modules/es.array.includes.js\");\nrequire(\"core-js/modules/es.string.includes.js\");\nrequire(\"core-js/modules/es.object.assign.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\nrequire(\"core-js/modules/es.number.constructor.js\");\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.array.sort.js\");\nrequire(\"core-js/modules/es.array.map.js\");\nrequire(\"core-js/modules/es.symbol.js\");\nrequire(\"core-js/modules/es.symbol.description.js\");\nrequire(\"core-js/modules/es.symbol.iterator.js\");\nrequire(\"core-js/modules/es.array.iterator.js\");\nrequire(\"core-js/modules/es.string.iterator.js\");\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\nvar _fetchPonyfill2 = _interopRequireDefault(require(\"fetch-ponyfill\"));\nvar _EventEmitter = _interopRequireDefault(require(\"./EventEmitter\"));\nvar _browserCookies = _interopRequireDefault(require(\"browser-cookies\"));\nvar _providers = _interopRequireDefault(require(\"./providers\"));\nvar _intersection2 = _interopRequireDefault(require(\"lodash/intersection\"));\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\nvar _cloneDeep2 = _interopRequireDefault(require(\"lodash/cloneDeep\"));\nvar _defaults2 = _interopRequireDefault(require(\"lodash/defaults\"));\nvar _utils = require(\"./utils/utils\");\nvar _jwtDecode = _interopRequireDefault(require(\"jwt-decode\"));\nrequire(\"./polyfills\");\nvar _CDN = _interopRequireDefault(require(\"./CDN\"));\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      var F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e2) {\n          throw _e2;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var normalCompletion = true,\n    didErr = false,\n    err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e3) {\n      didErr = true;\n      err = _e3;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _s, _e;\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n  return _arr;\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nvar _fetchPonyfill = (0, _fetchPonyfill2.default)({\n    Promise: _nativePromiseOnly.default\n  }),\n  fetch = _fetchPonyfill.fetch,\n  Headers = _fetchPonyfill.Headers;\nvar isBoolean = function isBoolean(val) {\n  return _typeof(val) === _typeof(true);\n};\nvar isNil = function isNil(val) {\n  return val === null || val === undefined;\n};\nvar isObject = function isObject(val) {\n  return val && _typeof(val) === 'object';\n};\nfunction cloneResponse(response) {\n  var copy = (0, _cloneDeep2.default)(response);\n  if (Array.isArray(response)) {\n    copy.skip = response.skip;\n    copy.limit = response.limit;\n    copy.serverCount = response.serverCount;\n  }\n  return copy;\n}\n/**\n * The Formio interface class.\n *\n *   let formio = new Formio('https://examples.form.io/example');\n */\n\nvar Formio = /*#__PURE__*/function () {\n  /* eslint-disable max-statements */\n  function Formio(path) {\n    var _this = this;\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    _classCallCheck(this, Formio);\n\n    // Ensure we have an instance of Formio.\n    if (!(this instanceof Formio)) {\n      return new Formio(path);\n    } // Initialize our variables.\n\n    this.base = '';\n    this.projectsUrl = '';\n    this.projectUrl = '';\n    this.projectId = '';\n    this.roleUrl = '';\n    this.rolesUrl = '';\n    this.roleId = '';\n    this.formUrl = '';\n    this.formsUrl = '';\n    this.formId = '';\n    this.submissionsUrl = '';\n    this.submissionUrl = '';\n    this.submissionId = '';\n    this.actionsUrl = '';\n    this.actionId = '';\n    this.actionUrl = '';\n    this.vsUrl = '';\n    this.vId = '';\n    this.vUrl = '';\n    this.query = ''; // Store the original path and options.\n\n    this.path = path;\n    this.options = options;\n    if (options.useSessionToken) {\n      Formio.useSessionToken(options);\n    }\n    if (options.hasOwnProperty('base')) {\n      this.base = options.base;\n    } else if (Formio.baseUrl) {\n      this.base = Formio.baseUrl;\n    } else if (typeof window !== 'undefined') {\n      this.base = window.location.href.match(/http[s]?:\\/\\/api./)[0];\n    }\n    if (!path) {\n      // Allow user to create new projects if this was instantiated without\n      // a url\n      this.projectUrl = Formio.projectUrl || \"\".concat(this.base, \"/project\");\n      this.projectsUrl = \"\".concat(this.base, \"/project\");\n      this.projectId = false;\n      this.query = '';\n      return;\n    }\n    if (options.hasOwnProperty('project')) {\n      this.projectUrl = options.project;\n    }\n    var project = this.projectUrl || Formio.projectUrl;\n    var projectRegEx = /(^|\\/)(project)($|\\/[^/]+)/;\n    var isProjectUrl = path.search(projectRegEx) !== -1; // The baseURL is the same as the projectUrl, and does not contain \"/project/MONGO_ID\" in\n    // its domain. This is almost certainly against the Open Source server.\n\n    if (project && this.base === project && !isProjectUrl) {\n      this.noProject = true;\n      this.projectUrl = this.base;\n    } // Normalize to an absolute path.\n\n    if (path.indexOf('http') !== 0 && path.indexOf('//') !== 0) {\n      path = this.base + path;\n    }\n    var hostparts = this.getUrlParts(path);\n    var parts = [];\n    var hostName = hostparts[1] + hostparts[2];\n    path = hostparts.length > 3 ? hostparts[3] : '';\n    var queryparts = path.split('?');\n    if (queryparts.length > 1) {\n      path = queryparts[0];\n      this.query = \"?\".concat(queryparts[1]);\n    } // Register a specific path.\n\n    var registerPath = function registerPath(name, base) {\n      _this[\"\".concat(name, \"sUrl\")] = \"\".concat(base, \"/\").concat(name);\n      var regex = new RegExp(\"/\".concat(name, \"/([^/]+)\"));\n      if (path.search(regex) !== -1) {\n        parts = path.match(regex);\n        _this[\"\".concat(name, \"Url\")] = parts ? base + parts[0] : '';\n        _this[\"\".concat(name, \"Id\")] = parts.length > 1 ? parts[1] : '';\n        base += parts[0];\n      }\n      return base;\n    }; // Register an array of items.\n\n    var registerItems = function registerItems(items, base, staticBase) {\n      for (var i in items) {\n        if (items.hasOwnProperty(i)) {\n          var item = items[i];\n          if (Array.isArray(item)) {\n            registerItems(item, base, true);\n          } else {\n            var newBase = registerPath(item, base);\n            base = staticBase ? base : newBase;\n          }\n        }\n      }\n    };\n    if (!this.projectUrl || this.projectUrl === this.base) {\n      // If a project uses Subdirectories path type, we need to specify a projectUrl\n      if (!this.projectUrl && !isProjectUrl && Formio.pathType === 'Subdirectories') {\n        var regex = \"^\".concat(hostName.replace(/\\//g, '\\\\/'), \".[^/]+\");\n        var match = project.match(new RegExp(regex));\n        this.projectUrl = match ? match[0] : hostName;\n      } else {\n        this.projectUrl = hostName;\n      }\n    } // Check if we have a specified path type.\n\n    var isNotSubdomainType = false;\n    if (Formio.pathType) {\n      isNotSubdomainType = Formio.pathType !== 'Subdomains';\n    }\n    if (!this.noProject) {\n      // Determine the projectUrl and projectId\n      if (isProjectUrl) {\n        // Get project id as project/:projectId.\n        registerItems(['project'], hostName);\n        path = path.replace(projectRegEx, '');\n      } else if (hostName === this.base) {\n        // Get project id as first part of path (subdirectory).\n        if (hostparts.length > 3 && path.split('/').length > 1) {\n          var isFile = path.match(/.json/);\n          var pathParts = path.split('/');\n          if (isFile) {\n            this.projectUrl = hostName;\n          } else {\n            pathParts.shift(); // Throw away the first /.\n\n            this.projectId = pathParts.shift();\n            path = \"/\".concat(pathParts.join('/'));\n            this.projectUrl = \"\".concat(hostName, \"/\").concat(this.projectId);\n          }\n        }\n      } else {\n        // Get project id from subdomain.\n        if (hostparts.length > 2 && (hostparts[2].split('.').length > 2 || hostName.includes('localhost')) && !isNotSubdomainType) {\n          this.projectUrl = hostName;\n          this.projectId = hostparts[2].split('.')[0];\n        }\n      }\n      this.projectsUrl = this.projectsUrl || \"\".concat(this.base, \"/project\");\n    } // Configure Role urls and role ids.\n\n    registerItems(['role'], this.projectUrl); // Configure Form urls and form ids.\n\n    if (/(^|\\/)(form)($|\\/)/.test(path)) {\n      registerItems(['form', ['submission', 'action', 'v']], this.projectUrl);\n    } else {\n      var subRegEx = new RegExp('/(submission|action|v)($|/.*)');\n      var subs = path.match(subRegEx);\n      this.pathType = subs && subs.length > 1 ? subs[1] : '';\n      path = path.replace(subRegEx, '');\n      path = path.replace(/\\/$/, '');\n      this.formsUrl = \"\".concat(this.projectUrl, \"/form\");\n      this.formUrl = path ? this.projectUrl + path : '';\n      this.formId = path.replace(/^\\/+|\\/+$/g, '');\n      var items = ['submission', 'action', 'v'];\n      for (var i in items) {\n        if (items.hasOwnProperty(i)) {\n          var item = items[i];\n          this[\"\".concat(item, \"sUrl\")] = \"\".concat(this.projectUrl + path, \"/\").concat(item);\n          if (this.pathType === item && subs.length > 2 && subs[2]) {\n            this[\"\".concat(item, \"Id\")] = subs[2].replace(/^\\/+|\\/+$/g, '');\n            this[\"\".concat(item, \"Url\")] = this.projectUrl + path + subs[0];\n          }\n        }\n      }\n    } // Set the app url if it is not set.\n\n    if (!Formio.projectUrlSet) {\n      Formio.projectUrl = this.projectUrl;\n    }\n  }\n  /* eslint-enable max-statements */\n\n  _createClass(Formio, [{\n    key: \"delete\",\n    value: function _delete(type, opts) {\n      var _id = \"\".concat(type, \"Id\");\n      var _url = \"\".concat(type, \"Url\");\n      if (!this[_id]) {\n        return _nativePromiseOnly.default.reject('Nothing to delete');\n      }\n      Formio.cache = {};\n      return this.makeRequest(type, this[_url], 'delete', null, opts);\n    }\n  }, {\n    key: \"index\",\n    value: function index(type, query, opts) {\n      var _url = \"\".concat(type, \"Url\");\n      query = query || '';\n      if (query && isObject(query)) {\n        query = \"?\".concat(Formio.serialize(query.params));\n      }\n      return this.makeRequest(type, this[_url] + query, 'get', null, opts);\n    }\n  }, {\n    key: \"save\",\n    value: function save(type, data, opts) {\n      var _id = \"\".concat(type, \"Id\");\n      var _url = \"\".concat(type, \"Url\");\n      var method = this[_id] || data._id ? 'put' : 'post';\n      var reqUrl = this[_id] ? this[_url] : this[\"\".concat(type, \"sUrl\")];\n      if (!this[_id] && data._id && method === 'put' && !reqUrl.includes(data._id)) {\n        reqUrl += \"/\".concat(data._id);\n      }\n      Formio.cache = {};\n      return this.makeRequest(type, reqUrl + this.query, method, data, opts);\n    }\n  }, {\n    key: \"load\",\n    value: function load(type, query, opts) {\n      var _id = \"\".concat(type, \"Id\");\n      var _url = \"\".concat(type, \"Url\");\n      if (query && isObject(query)) {\n        query = Formio.serialize(query.params);\n      }\n      if (query) {\n        query = this.query ? \"\".concat(this.query, \"&\").concat(query) : \"?\".concat(query);\n      } else {\n        query = this.query;\n      }\n      if (!this[_id]) {\n        return _nativePromiseOnly.default.reject(\"Missing \".concat(_id));\n      }\n      var url = this[_url] + query;\n      if (type === 'form' && !isNaN(parseInt(this.vId)) && parseInt(this.vId) !== 0) {\n        url += url.match(/\\?/) ? '&' : '?';\n        url += \"formRevision=\".concat(this.vId);\n      }\n      return this.makeRequest(type, url, 'get', null, opts);\n    }\n  }, {\n    key: \"makeRequest\",\n    value: function makeRequest() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      return Formio.makeRequest.apply(Formio, [this].concat(args));\n    }\n  }, {\n    key: \"loadProject\",\n    value: function loadProject(query, opts) {\n      return this.load('project', query, opts);\n    }\n  }, {\n    key: \"saveProject\",\n    value: function saveProject(data, opts) {\n      return this.save('project', data, opts);\n    }\n  }, {\n    key: \"deleteProject\",\n    value: function deleteProject(opts) {\n      return this.delete('project', opts);\n    }\n  }, {\n    key: \"loadRole\",\n    value: function loadRole(opts) {\n      return this.load('role', null, opts);\n    }\n  }, {\n    key: \"saveRole\",\n    value: function saveRole(data, opts) {\n      return this.save('role', data, opts);\n    }\n  }, {\n    key: \"deleteRole\",\n    value: function deleteRole(opts) {\n      return this.delete('role', opts);\n    }\n  }, {\n    key: \"loadRoles\",\n    value: function loadRoles(opts) {\n      return this.index('roles', null, opts);\n    }\n  }, {\n    key: \"loadForm\",\n    value: function loadForm(query, opts) {\n      var _this2 = this;\n      return this.load('form', query, opts).then(function (currentForm) {\n        // Check to see if there isn't a number in vId.\n        if (!currentForm.revisions || isNaN(parseInt(_this2.vId))) {\n          return currentForm;\n        } // If a submission already exists but form is marked to load current version of form.\n\n        if (currentForm.revisions === 'current' && _this2.submissionId) {\n          return currentForm;\n        } // eslint-disable-next-line eqeqeq\n\n        if (currentForm._vid == _this2.vId || currentForm.revisionId === _this2.vId) {\n          return currentForm;\n        } // If they specified a revision form, load the revised form components.\n\n        if (query && isObject(query)) {\n          query = Formio.serialize(query.params);\n        }\n        if (query) {\n          query = _this2.query ? \"\".concat(_this2.query, \"&\").concat(query) : \"?\".concat(query);\n        } else {\n          query = _this2.query;\n        }\n        return _this2.makeRequest('form', _this2.vUrl + query, 'get', null, opts).then(function (revisionForm) {\n          currentForm._vid = revisionForm._vid;\n          currentForm.components = revisionForm.components;\n          currentForm.settings = revisionForm.settings;\n          currentForm.revisionId = revisionForm.revisionId; // Using object.assign so we don't cross polinate multiple form loads.\n\n          return Object.assign({}, currentForm);\n        }) // If we couldn't load the revision, just return the original form.\n        .catch(function () {\n          return Object.assign({}, currentForm);\n        });\n      });\n    }\n  }, {\n    key: \"saveForm\",\n    value: function saveForm(data, opts) {\n      return this.save('form', data, opts);\n    }\n  }, {\n    key: \"deleteForm\",\n    value: function deleteForm(opts) {\n      return this.delete('form', opts);\n    }\n  }, {\n    key: \"loadForms\",\n    value: function loadForms(query, opts) {\n      return this.index('forms', query, opts);\n    }\n  }, {\n    key: \"loadSubmission\",\n    value: function loadSubmission(query, opts) {\n      var _this3 = this;\n      return this.load('submission', query, opts).then(function (submission) {\n        _this3.vId = submission._frid || submission._fvid;\n        _this3.vUrl = \"\".concat(_this3.formUrl, \"/v/\").concat(_this3.vId);\n        return submission;\n      });\n    }\n  }, {\n    key: \"saveSubmission\",\n    value: function saveSubmission(data, opts) {\n      if (!isNaN(parseInt(this.vId))) {\n        data._fvid = this.vId;\n      }\n      return this.save('submission', data, opts);\n    }\n  }, {\n    key: \"deleteSubmission\",\n    value: function deleteSubmission(opts) {\n      return this.delete('submission', opts);\n    }\n  }, {\n    key: \"loadSubmissions\",\n    value: function loadSubmissions(query, opts) {\n      return this.index('submissions', query, opts);\n    }\n  }, {\n    key: \"loadAction\",\n    value: function loadAction(query, opts) {\n      return this.load('action', query, opts);\n    }\n  }, {\n    key: \"saveAction\",\n    value: function saveAction(data, opts) {\n      return this.save('action', data, opts);\n    }\n  }, {\n    key: \"deleteAction\",\n    value: function deleteAction(opts) {\n      return this.delete('action', opts);\n    }\n  }, {\n    key: \"loadActions\",\n    value: function loadActions(query, opts) {\n      return this.index('actions', query, opts);\n    }\n  }, {\n    key: \"availableActions\",\n    value: function availableActions() {\n      return this.makeRequest('availableActions', \"\".concat(this.formUrl, \"/actions\"));\n    }\n  }, {\n    key: \"actionInfo\",\n    value: function actionInfo(name) {\n      return this.makeRequest('actionInfo', \"\".concat(this.formUrl, \"/actions/\").concat(name));\n    }\n  }, {\n    key: \"isObjectId\",\n    value: function isObjectId(id) {\n      var checkForHexRegExp = new RegExp('^[0-9a-fA-F]{24}$');\n      return checkForHexRegExp.test(id);\n    }\n  }, {\n    key: \"getProjectId\",\n    value: function getProjectId() {\n      if (!this.projectId) {\n        return _nativePromiseOnly.default.resolve('');\n      }\n      if (this.isObjectId(this.projectId)) {\n        return _nativePromiseOnly.default.resolve(this.projectId);\n      } else {\n        return this.loadProject().then(function (project) {\n          return project._id;\n        });\n      }\n    }\n  }, {\n    key: \"getFormId\",\n    value: function getFormId() {\n      if (!this.formId) {\n        return _nativePromiseOnly.default.resolve('');\n      }\n      if (this.isObjectId(this.formId)) {\n        return _nativePromiseOnly.default.resolve(this.formId);\n      } else {\n        return this.loadForm().then(function (form) {\n          return form._id;\n        });\n      }\n    }\n  }, {\n    key: \"currentUser\",\n    value: function currentUser(options) {\n      return Formio.currentUser(this, options);\n    }\n  }, {\n    key: \"accessInfo\",\n    value: function accessInfo() {\n      return Formio.accessInfo(this);\n    }\n    /**\n     * Returns the JWT token for this instance.\n     *\n     * @return {*}\n     */\n  }, {\n    key: \"getToken\",\n    value: function getToken(options) {\n      return Formio.getToken(Object.assign({\n        formio: this\n      }, this.options, options));\n    }\n    /**\n     * Sets the JWT token for this instance.\n     *\n     * @return {*}\n     */\n  }, {\n    key: \"setToken\",\n    value: function setToken(token, options) {\n      return Formio.setToken(token, Object.assign({\n        formio: this\n      }, this.options, options));\n    }\n    /**\n     * Returns a temporary authentication token for single purpose token generation.\n     */\n  }, {\n    key: \"getTempToken\",\n    value: function getTempToken(expire, allowed, options) {\n      var token = Formio.getToken(options);\n      if (!token) {\n        return _nativePromiseOnly.default.reject('You must be authenticated to generate a temporary auth token.');\n      }\n      var authUrl = Formio.authUrl || this.projectUrl;\n      return this.makeRequest('tempToken', \"\".concat(authUrl, \"/token\"), 'GET', null, {\n        ignoreCache: true,\n        header: new Headers({\n          'x-expire': expire,\n          'x-allow': allowed\n        })\n      });\n    }\n    /**\n     * Get a download url for a submission PDF of this submission.\n     *\n     * @return {*}\n     */\n  }, {\n    key: \"getDownloadUrl\",\n    value: function getDownloadUrl(form) {\n      var _this4 = this;\n      if (!this.submissionId) {\n        return _nativePromiseOnly.default.resolve('');\n      }\n      if (!form) {\n        // Make sure to load the form first.\n        return this.loadForm().then(function (_form) {\n          if (!_form) {\n            return '';\n          }\n          return _this4.getDownloadUrl(_form);\n        });\n      }\n      var apiUrl = \"/project/\".concat(form.project);\n      apiUrl += \"/form/\".concat(form._id);\n      apiUrl += \"/submission/\".concat(this.submissionId);\n      var postfix = form.submissionRevisions && form.settings.changeLog ? '/download/changelog' : '/download';\n      apiUrl += postfix;\n      var download = this.base + apiUrl;\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        _this4.getTempToken(3600, \"GET:\".concat(apiUrl)).then(function (tempToken) {\n          download += \"?token=\".concat(tempToken.key);\n          resolve(download);\n        }, function () {\n          resolve(download);\n        }).catch(reject);\n      });\n    }\n  }, {\n    key: \"uploadFile\",\n    value: function uploadFile(storage, file, fileName, dir, progressCallback, url, options, fileKey, groupPermissions, groupId, uploadStartCallback, abortCallback) {\n      var _this5 = this;\n      var requestArgs = {\n        provider: storage,\n        method: 'upload',\n        file: file,\n        fileName: fileName,\n        dir: dir\n      };\n      fileKey = fileKey || 'file';\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('fileRequest', requestArgs).then(function (result) {\n          if (storage && isNil(result)) {\n            var Provider = _providers.default.getProvider('storage', storage);\n            if (Provider) {\n              var provider = new Provider(_this5);\n              if (uploadStartCallback) {\n                uploadStartCallback();\n              }\n              return provider.uploadFile(file, fileName, dir, progressCallback, url, options, fileKey, groupPermissions, groupId, abortCallback);\n            } else {\n              throw 'Storage provider not found';\n            }\n          }\n          return result || {\n            url: ''\n          };\n        });\n      });\n      return Formio.pluginAlter('wrapFileRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"downloadFile\",\n    value: function downloadFile(file, options) {\n      var _this6 = this;\n      var requestArgs = {\n        method: 'download',\n        file: file\n      };\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('fileRequest', requestArgs).then(function (result) {\n          if (file.storage && isNil(result)) {\n            var Provider = _providers.default.getProvider('storage', file.storage);\n            if (Provider) {\n              var provider = new Provider(_this6);\n              return provider.downloadFile(file, options);\n            } else {\n              throw 'Storage provider not found';\n            }\n          }\n          return result || {\n            url: ''\n          };\n        });\n      });\n      return Formio.pluginAlter('wrapFileRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"deleteFile\",\n    value: function deleteFile(file, options) {\n      var _this7 = this;\n      var requestArgs = {\n        method: 'delete',\n        file: file\n      };\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('fileRequest', requestArgs).then(function (result) {\n          if (file.storage && isNil(result)) {\n            var Provider = _providers.default.getProvider('storage', file.storage);\n            if (Provider) {\n              var provider = new Provider(_this7);\n              return provider.deleteFile(file, options);\n            } else {\n              throw 'Storage provider not found';\n            }\n          }\n          return result || {\n            url: ''\n          };\n        });\n      });\n      return Formio.pluginAlter('wrapFileRequestPromise', request, requestArgs);\n    }\n    /**\n     * Returns the user permissions to a form and submission.\n     *\n     * @param user - The user or current user if undefined. For anonymous, use \"null\"\n     * @param form - The form or current form if undefined. For no form check, use \"null\"\n     * @param submission - The submisison or \"index\" if undefined.\n     *\n     * @return {create: boolean, read: boolean, edit: boolean, delete: boolean}\n     */\n  }, {\n    key: \"userPermissions\",\n    value: function userPermissions(user, form, submission) {\n      return _nativePromiseOnly.default.all([form !== undefined ? _nativePromiseOnly.default.resolve(form) : this.loadForm(), user !== undefined ? _nativePromiseOnly.default.resolve(user) : this.currentUser(), submission !== undefined || !this.submissionId ? _nativePromiseOnly.default.resolve(submission) : this.loadSubmission(), this.accessInfo()]).then(function (results) {\n        var form = results.shift();\n        var user = results.shift() || {\n          _id: false,\n          roles: []\n        };\n        var submission = results.shift();\n        var access = results.shift();\n        var permMap = {\n          create: 'create',\n          read: 'read',\n          update: 'edit',\n          delete: 'delete'\n        };\n        var perms = {\n          user: user,\n          form: form,\n          access: access,\n          create: false,\n          read: false,\n          edit: false,\n          delete: false\n        };\n        for (var roleName in access.roles) {\n          if (access.roles.hasOwnProperty(roleName)) {\n            var role = access.roles[roleName];\n            if (role.default && user._id === false) {\n              // User is anonymous. Add the anonymous role.\n              user.roles.push(role._id);\n            } else if (role.admin && user.roles.indexOf(role._id) !== -1) {\n              perms.create = true;\n              perms.read = true;\n              perms.delete = true;\n              perms.edit = true;\n              return perms;\n            }\n          }\n        }\n        if (form && form.submissionAccess) {\n          for (var i = 0; i < form.submissionAccess.length; i++) {\n            var permission = form.submissionAccess[i];\n            var _permission$type$spli = permission.type.split('_'),\n              _permission$type$spli2 = _slicedToArray(_permission$type$spli, 2),\n              perm = _permission$type$spli2[0],\n              scope = _permission$type$spli2[1];\n            if (['create', 'read', 'update', 'delete'].includes(perm)) {\n              if ((0, _intersection2.default)(permission.roles, user.roles).length) {\n                perms[permMap[perm]] = scope === 'all' || !submission || user._id === submission.owner;\n              }\n            }\n          }\n        } // check for Group Permissions\n\n        if (submission) {\n          // we would anyway need to loop through components for create permission, so we'll do that for all of them\n          (0, _utils.eachComponent)(form.components, function (component, path) {\n            if (component && component.defaultPermission) {\n              var value = (0, _get2.default)(submission.data, path); // make it work for single-select Group and multi-select Group\n\n              var groups = Array.isArray(value) ? value : [value];\n              groups.forEach(function (group) {\n                if (group && group._id &&\n                // group id is present\n                user.roles.indexOf(group._id) > -1 // user has group id in his roles\n                ) {\n                  if (component.defaultPermission === 'read') {\n                    perms[permMap.read] = true;\n                  }\n                  if (component.defaultPermission === 'create') {\n                    perms[permMap.create] = true;\n                    perms[permMap.read] = true;\n                  }\n                  if (component.defaultPermission === 'write') {\n                    perms[permMap.create] = true;\n                    perms[permMap.read] = true;\n                    perms[permMap.update] = true;\n                  }\n                  if (component.defaultPermission === 'admin') {\n                    perms[permMap.create] = true;\n                    perms[permMap.read] = true;\n                    perms[permMap.update] = true;\n                    perms[permMap.delete] = true;\n                  }\n                }\n              });\n            }\n          });\n        }\n        return perms;\n      });\n    }\n    /**\n     * Determine if the current user can submit a form.\n     * @return {*}\n     */\n  }, {\n    key: \"canSubmit\",\n    value: function canSubmit() {\n      var _this8 = this;\n      return this.userPermissions().then(function (perms) {\n        // If there is user and they cannot create, then check anonymous user permissions.\n        if (!perms.create && Formio.getUser()) {\n          return _this8.userPermissions(null).then(function (anonPerms) {\n            if (anonPerms.create) {\n              Formio.setUser(null);\n              return true;\n            }\n            return false;\n          });\n        }\n        return perms.create;\n      });\n    }\n  }, {\n    key: \"getUrlParts\",\n    value: function getUrlParts(url) {\n      return Formio.getUrlParts(url, this);\n    }\n  }], [{\n    key: \"useSessionToken\",\n    value: function useSessionToken(options) {\n      var tokenName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"Token\");\n      var token = localStorage.getItem(tokenName);\n      if (token) {\n        localStorage.removeItem(tokenName);\n        sessionStorage.setItem(tokenName, token);\n      }\n      var userName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"User\");\n      var user = localStorage.getItem(userName);\n      if (user) {\n        localStorage.removeItem(userName);\n        sessionStorage.setItem(userName, user);\n      }\n      localStorage.setItem('useSessionToken', true);\n    }\n  }, {\n    key: \"loadProjects\",\n    value: function loadProjects(query, opts) {\n      query = query || '';\n      if (isObject(query)) {\n        query = \"?\".concat(Formio.serialize(query.params));\n      }\n      return Formio.makeStaticRequest(\"\".concat(Formio.baseUrl, \"/project\").concat(query), 'GET', null, opts);\n    }\n  }, {\n    key: \"getUrlParts\",\n    value: function getUrlParts(url, formio) {\n      var base = formio && formio.base ? formio.base : Formio.baseUrl;\n      var regex = '^(http[s]?:\\\\/\\\\/)';\n      if (base && url.indexOf(base) === 0) {\n        regex += \"(\".concat(base.replace(/^http[s]?:\\/\\//, ''), \")\");\n      } else {\n        regex += '([^/]+)';\n      }\n      regex += '($|\\\\/.*)';\n      return url.match(new RegExp(regex));\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize(obj, _interpolate) {\n      var str = [];\n      var interpolate = function interpolate(item) {\n        return _interpolate ? _interpolate(item) : item;\n      };\n      for (var p in obj) {\n        if (obj.hasOwnProperty(p)) {\n          str.push(\"\".concat(encodeURIComponent(p), \"=\").concat(encodeURIComponent(interpolate(obj[p]))));\n        }\n      }\n      return str.join('&');\n    }\n  }, {\n    key: \"getRequestArgs\",\n    value: function getRequestArgs(formio, type, url, method, data, opts) {\n      method = (method || 'GET').toUpperCase();\n      if (!opts || !isObject(opts)) {\n        opts = {};\n      }\n      var requestArgs = {\n        url: url,\n        method: method,\n        data: data || null,\n        opts: opts\n      };\n      if (type) {\n        requestArgs.type = type;\n      }\n      if (formio) {\n        requestArgs.formio = formio;\n      }\n      return requestArgs;\n    }\n  }, {\n    key: \"makeStaticRequest\",\n    value: function makeStaticRequest(url, method, data, opts) {\n      var requestArgs = Formio.getRequestArgs(null, '', url, method, data, opts);\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('staticRequest', requestArgs).then(function (result) {\n          if (isNil(result)) {\n            return Formio.request(requestArgs.url, requestArgs.method, requestArgs.data, requestArgs.opts.header, requestArgs.opts);\n          }\n          return result;\n        });\n      });\n      return Formio.pluginAlter('wrapStaticRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"makeRequest\",\n    value: function makeRequest(formio, type, url, method, data, opts) {\n      if (!formio) {\n        return Formio.makeStaticRequest(url, method, data, opts);\n      }\n      var requestArgs = Formio.getRequestArgs(formio, type, url, method, data, opts);\n      requestArgs.opts = requestArgs.opts || {};\n      requestArgs.opts.formio = formio; //for Formio requests default Accept and Content-type headers\n\n      if (!requestArgs.opts.headers) {\n        requestArgs.opts.headers = {};\n      }\n      requestArgs.opts.headers = (0, _defaults2.default)(requestArgs.opts.headers, {\n        'Accept': 'application/json',\n        'Content-type': 'application/json'\n      });\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('request', requestArgs).then(function (result) {\n          if (isNil(result)) {\n            return Formio.request(requestArgs.url, requestArgs.method, requestArgs.data, requestArgs.opts.header, requestArgs.opts);\n          }\n          return result;\n        });\n      });\n      return Formio.pluginAlter('wrapRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"request\",\n    value: function request(url, method, data, header, opts) {\n      if (!url) {\n        return _nativePromiseOnly.default.reject('No url provided');\n      }\n      var _Formio = Formio;\n      method = (method || 'GET').toUpperCase(); // For reverse compatibility, if they provided the ignoreCache parameter,\n      // then change it back to the options format where that is a parameter.\n\n      if (isBoolean(opts)) {\n        opts = {\n          ignoreCache: opts\n        };\n      }\n      if (!opts || !isObject(opts)) {\n        opts = {};\n      } // Generate a cachekey.\n\n      var cacheKey = btoa(encodeURI(url)); // Get the cached promise to save multiple loads.\n\n      if (!opts.ignoreCache && method === 'GET' && _Formio.cache.hasOwnProperty(cacheKey)) {\n        return _nativePromiseOnly.default.resolve(cloneResponse(_Formio.cache[cacheKey]));\n      } // Set up and fetch request\n\n      var headers = header || new Headers(opts.headers || {\n        'Accept': 'application/json',\n        'Content-type': 'application/json'\n      });\n      var token = _Formio.getToken(opts);\n      if (token && !opts.noToken) {\n        headers.append('x-jwt-token', token);\n      } // The fetch-ponyfill can't handle a proper Headers class anymore. Change it back to an object.\n\n      var headerObj = {};\n      headers.forEach(function (value, name) {\n        headerObj[name] = value;\n      });\n      var options = {\n        method: method,\n        headers: headerObj,\n        mode: 'cors'\n      };\n      if (data) {\n        options.body = JSON.stringify(data);\n      } // Allow plugins to alter the options.\n\n      options = _Formio.pluginAlter('requestOptions', options, url);\n      if (options.namespace || _Formio.namespace) {\n        opts.namespace = options.namespace || _Formio.namespace;\n      }\n      var requestToken = options.headers['x-jwt-token'];\n      var result = _Formio.pluginAlter('wrapFetchRequestPromise', _Formio.fetch(url, options), {\n        url: url,\n        method: method,\n        data: data,\n        opts: opts\n      }).then(function (response) {\n        // Allow plugins to respond.\n        response = _Formio.pluginAlter('requestResponse', response, _Formio, data);\n        if (!response.ok) {\n          if (response.status === 440) {\n            _Formio.setToken(null, opts);\n            _Formio.events.emit('formio.sessionExpired', response.body);\n          } else if (response.status === 401) {\n            _Formio.events.emit('formio.unauthorized', response.body);\n          } else if (response.status === 416) {\n            _Formio.events.emit('formio.rangeIsNotSatisfiable', response.body);\n          } else if (response.status === 504) {\n            return _nativePromiseOnly.default.reject(new Error('Network request failed'));\n          } // Parse and return the error as a rejected promise to reject this promise\n\n          return (response.headers.get('content-type').includes('application/json') ? response.json() : response.text()).then(function (error) {\n            return _nativePromiseOnly.default.reject(error);\n          });\n        } // Handle fetch results\n\n        var token = response.headers.get('x-jwt-token'); // In some strange cases, the fetch library will return an x-jwt-token without sending\n        // one to the server. This has even been debugged on the server to verify that no token\n        // was introduced with the request, but the response contains a token. This is an Invalid\n        // case where we do not send an x-jwt-token and get one in return for any GET request.\n\n        var tokenIntroduced = false;\n        if (method === 'GET' && !requestToken && token && !opts.external && !url.includes('token=') && !url.includes('x-jwt-token=')) {\n          console.warn('Token was introduced in request.');\n          tokenIntroduced = true;\n        }\n        if (response.status >= 200 && response.status < 300 && token && token !== '' && !tokenIntroduced) {\n          _Formio.setToken(token, opts);\n        } // 204 is no content. Don't try to .json() it.\n\n        if (response.status === 204) {\n          return {};\n        }\n        var getResult = response.headers.get('content-type').includes('application/json') ? response.json() : response.text();\n        return getResult.then(function (result) {\n          // Add some content-range metadata to the result here\n          var range = response.headers.get('content-range');\n          if (range && isObject(result)) {\n            range = range.split('/');\n            if (range[0] !== '*') {\n              var skipLimit = range[0].split('-');\n              result.skip = Number(skipLimit[0]);\n              result.limit = skipLimit[1] - skipLimit[0] + 1;\n            }\n            result.serverCount = range[1] === '*' ? range[1] : Number(range[1]);\n          }\n          if (!opts.getHeaders) {\n            return result;\n          }\n          var headers = {};\n          response.headers.forEach(function (item, key) {\n            headers[key] = item;\n          }); // Return the result with the headers.\n\n          return {\n            result: result,\n            headers: headers\n          };\n        });\n      }).then(function (result) {\n        if (opts.getHeaders) {\n          return result;\n        } // Cache the response.\n\n        if (method === 'GET') {\n          _Formio.cache[cacheKey] = result;\n        }\n        return cloneResponse(result);\n      }).catch(function (err) {\n        if (err === 'Bad Token') {\n          _Formio.setToken(null, opts);\n          _Formio.events.emit('formio.badToken', err);\n        }\n        if (err.message) {\n          err = new Error(\"Could not connect to API server (\".concat(err.message, \"): \").concat(url));\n          err.networkError = true;\n        }\n        if (method === 'GET') {\n          delete _Formio.cache[cacheKey];\n        }\n        return _nativePromiseOnly.default.reject(err);\n      });\n      return result;\n    } // Needed to maintain reverse compatability...\n  }, {\n    key: \"token\",\n    get: function get() {\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n      return Formio.tokens.formioToken || '';\n    } // Needed to maintain reverse compatability...\n    ,\n\n    set: function set(token) {\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n      Formio.tokens.formioToken = token || '';\n    }\n  }, {\n    key: \"setToken\",\n    value: function setToken() {\n      var token = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var opts = arguments.length > 1 ? arguments[1] : undefined;\n      token = token || '';\n      opts = typeof opts === 'string' ? {\n        namespace: opts\n      } : opts || {};\n      var tokenName = \"\".concat(opts.namespace || Formio.namespace || 'formio', \"Token\");\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n      var storage = localStorage.getItem('useSessionToken') ? sessionStorage : localStorage;\n      if (!token) {\n        if (!opts.fromUser) {\n          opts.fromToken = true;\n          Formio.setUser(null, opts);\n        } // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n        try {\n          storage.removeItem(tokenName);\n        } catch (err) {\n          _browserCookies.default.erase(tokenName, {\n            path: '/'\n          });\n        }\n        Formio.tokens[tokenName] = token;\n        return _nativePromiseOnly.default.resolve(null);\n      }\n      if (Formio.tokens[tokenName] !== token) {\n        Formio.tokens[tokenName] = token; // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n        try {\n          storage.setItem(tokenName, token);\n        } catch (err) {\n          _browserCookies.default.set(tokenName, token, {\n            path: '/'\n          });\n        }\n      } // Return or updates the current user\n\n      return this.currentUserResolved ? Formio.currentUser(opts.formio, opts) : _nativePromiseOnly.default.resolve(null);\n    }\n  }, {\n    key: \"getToken\",\n    value: function getToken(options) {\n      options = typeof options === 'string' ? {\n        namespace: options\n      } : options || {};\n      var tokenName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"Token\");\n      var decodedTokenName = options.decode ? \"\".concat(tokenName, \"Decoded\") : tokenName;\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n      if (Formio.tokens[decodedTokenName]) {\n        return Formio.tokens[decodedTokenName];\n      }\n      try {\n        var token = localStorage.getItem('useSessionToken') ? sessionStorage.getItem(tokenName) : localStorage.getItem(tokenName);\n        Formio.tokens[tokenName] = token || '';\n        if (options.decode) {\n          Formio.tokens[decodedTokenName] = Formio.tokens[tokenName] ? (0, _jwtDecode.default)(Formio.tokens[tokenName]) : {};\n          return Formio.tokens[decodedTokenName];\n        }\n        return Formio.tokens[tokenName];\n      } catch (e) {\n        Formio.tokens[tokenName] = _browserCookies.default.get(tokenName);\n        return Formio.tokens[tokenName];\n      }\n    }\n  }, {\n    key: \"setUser\",\n    value: function setUser(user) {\n      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var userName = \"\".concat(opts.namespace || Formio.namespace || 'formio', \"User\");\n      var storage = localStorage.getItem('useSessionToken') ? sessionStorage : localStorage;\n      if (!user) {\n        if (!opts.fromToken) {\n          opts.fromUser = true;\n          Formio.setToken(null, opts);\n        } // Emit an event on the cleared user.\n\n        Formio.events.emit('formio.user', null); // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n        try {\n          return storage.removeItem(userName);\n        } catch (err) {\n          return _browserCookies.default.erase(userName, {\n            path: '/'\n          });\n        }\n      } // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n      try {\n        storage.setItem(userName, JSON.stringify(user));\n      } catch (err) {\n        _browserCookies.default.set(userName, JSON.stringify(user), {\n          path: '/'\n        });\n      } // Emit an event on the authenticated user.\n\n      Formio.events.emit('formio.user', user);\n    }\n  }, {\n    key: \"getUser\",\n    value: function getUser(options) {\n      options = options || {};\n      var userName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"User\");\n      try {\n        return JSON.parse((localStorage.getItem('useSessionToken') ? sessionStorage : localStorage).getItem(userName) || null);\n      } catch (e) {\n        return JSON.parse(_browserCookies.default.get(userName));\n      }\n    }\n  }, {\n    key: \"setBaseUrl\",\n    value: function setBaseUrl(url) {\n      Formio.baseUrl = url;\n      if (!Formio.projectUrlSet) {\n        Formio.projectUrl = url;\n      }\n    }\n  }, {\n    key: \"getBaseUrl\",\n    value: function getBaseUrl() {\n      return Formio.baseUrl;\n    }\n  }, {\n    key: \"setApiUrl\",\n    value: function setApiUrl(url) {\n      return Formio.setBaseUrl(url);\n    }\n  }, {\n    key: \"getApiUrl\",\n    value: function getApiUrl() {\n      return Formio.getBaseUrl();\n    }\n  }, {\n    key: \"setAppUrl\",\n    value: function setAppUrl(url) {\n      console.warn('Formio.setAppUrl() is deprecated. Use Formio.setProjectUrl instead.');\n      Formio.projectUrl = url;\n      Formio.projectUrlSet = true;\n    }\n  }, {\n    key: \"setProjectUrl\",\n    value: function setProjectUrl(url) {\n      Formio.projectUrl = url;\n      Formio.projectUrlSet = true;\n    }\n  }, {\n    key: \"setAuthUrl\",\n    value: function setAuthUrl(url) {\n      Formio.authUrl = url;\n    }\n  }, {\n    key: \"getAppUrl\",\n    value: function getAppUrl() {\n      console.warn('Formio.getAppUrl() is deprecated. Use Formio.getProjectUrl instead.');\n      return Formio.projectUrl;\n    }\n  }, {\n    key: \"getProjectUrl\",\n    value: function getProjectUrl() {\n      return Formio.projectUrl;\n    }\n  }, {\n    key: \"clearCache\",\n    value: function clearCache() {\n      Formio.cache = {};\n    }\n  }, {\n    key: \"noop\",\n    value: function noop() {}\n  }, {\n    key: \"identity\",\n    value: function identity(value) {\n      return value;\n    }\n  }, {\n    key: \"deregisterPlugin\",\n    value: function deregisterPlugin(plugin) {\n      var beforeLength = Formio.plugins.length;\n      Formio.plugins = Formio.plugins.filter(function (p) {\n        if (p !== plugin && p.__name !== plugin) {\n          return true;\n        }\n        (p.deregister || Formio.noop).call(plugin, Formio);\n        return false;\n      });\n      return beforeLength !== Formio.plugins.length;\n    }\n  }, {\n    key: \"registerPlugin\",\n    value: function registerPlugin(plugin, name) {\n      var __Formio = Formio;\n      __Formio.plugins.push(plugin);\n      __Formio.plugins.sort(function (a, b) {\n        return (b.priority || 0) - (a.priority || 0);\n      });\n      plugin.__name = name;\n      (plugin.init || __Formio.noop).call(plugin, __Formio);\n    }\n  }, {\n    key: \"getPlugin\",\n    value: function getPlugin(name) {\n      var _iterator = _createForOfIteratorHelper(Formio.plugins),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var plugin = _step.value;\n          if (plugin.__name === name) {\n            return plugin;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return null;\n    }\n  }, {\n    key: \"pluginWait\",\n    value: function pluginWait(pluginFn) {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n      return _nativePromiseOnly.default.all(Formio.plugins.map(function (plugin) {\n        var _ref;\n        return (_ref = plugin[pluginFn] || Formio.noop).call.apply(_ref, [plugin].concat(args));\n      }));\n    }\n  }, {\n    key: \"pluginGet\",\n    value: function pluginGet(pluginFn) {\n      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        args[_key3 - 1] = arguments[_key3];\n      }\n      var callPlugin = function callPlugin(index) {\n        var _ref2;\n        var plugin = Formio.plugins[index];\n        if (!plugin) {\n          return _nativePromiseOnly.default.resolve(null);\n        }\n        return _nativePromiseOnly.default.resolve((_ref2 = plugin[pluginFn] || Formio.noop).call.apply(_ref2, [plugin].concat(args))).then(function (result) {\n          if (!isNil(result)) {\n            return result;\n          }\n          return callPlugin(index + 1);\n        });\n      };\n      return callPlugin(0);\n    }\n  }, {\n    key: \"pluginAlter\",\n    value: function pluginAlter(pluginFn, value) {\n      for (var _len4 = arguments.length, args = new Array(_len4 > 2 ? _len4 - 2 : 0), _key4 = 2; _key4 < _len4; _key4++) {\n        args[_key4 - 2] = arguments[_key4];\n      }\n      return Formio.plugins.reduce(function (value, plugin) {\n        return (plugin[pluginFn] || Formio.identity).apply(void 0, [value].concat(args));\n      }, value);\n    }\n  }, {\n    key: \"accessInfo\",\n    value: function accessInfo(formio) {\n      var projectUrl = formio ? formio.projectUrl : Formio.projectUrl;\n      return Formio.makeRequest(formio, 'accessInfo', \"\".concat(projectUrl, \"/access\"));\n    }\n  }, {\n    key: \"projectRoles\",\n    value: function projectRoles(formio) {\n      var projectUrl = formio ? formio.projectUrl : Formio.projectUrl;\n      return Formio.makeRequest(formio, 'projectRoles', \"\".concat(projectUrl, \"/role\"));\n    }\n  }, {\n    key: \"currentUser\",\n    value: function currentUser(formio, options) {\n      var _this9 = this;\n      var authUrl = Formio.authUrl;\n      if (!authUrl) {\n        authUrl = formio ? formio.projectUrl : Formio.projectUrl || Formio.baseUrl;\n      }\n      authUrl += '/current';\n      var user = Formio.getUser(options);\n      if (user) {\n        return Formio.pluginAlter('wrapStaticRequestPromise', _nativePromiseOnly.default.resolve(user), {\n          url: authUrl,\n          method: 'GET',\n          options: options\n        });\n      }\n      var token = Formio.getToken(options);\n      if ((!options || !options.external) && !token) {\n        return Formio.pluginAlter('wrapStaticRequestPromise', _nativePromiseOnly.default.resolve(null), {\n          url: authUrl,\n          method: 'GET',\n          options: options\n        });\n      }\n      authUrl = \"\".concat(Formio.baseUrl, \"/current\");\n      this.currentUserResolved = false;\n      return Formio.makeRequest(formio, 'currentUser', authUrl, 'GET', null, options).then(function (response) {\n        _this9.currentUserResolved = true;\n        Formio.setUser(response, options);\n        return response;\n      });\n    }\n  }, {\n    key: \"logout\",\n    value: function logout(formio, options) {\n      options = options || {};\n      options.formio = formio;\n      var projectUrl = Formio.authUrl ? Formio.authUrl : formio ? formio.projectUrl : Formio.baseUrl;\n      var logout = function logout() {\n        Formio.setToken(null, options);\n        Formio.setUser(null, options);\n        Formio.clearCache();\n        localStorage.removeItem('useSessionToken');\n      };\n      return Formio.makeRequest(formio, 'logout', \"\".concat(projectUrl, \"/logout\")).then(function (result) {\n        logout();\n        return result;\n      }).catch(function (err) {\n        logout();\n        throw err;\n      });\n    }\n  }, {\n    key: \"pageQuery\",\n    value: function pageQuery() {\n      var pageQuery = {};\n      pageQuery.paths = [];\n      var hashes = location.hash.substr(1).replace(/\\?/g, '&').split('&');\n      var parts = [];\n      location.search.substr(1).split('&').forEach(function (item) {\n        parts = item.split('=');\n        if (parts.length > 1) {\n          pageQuery[parts[0]] = parts[1] && decodeURIComponent(parts[1]);\n        }\n      });\n      hashes.forEach(function (item) {\n        parts = item.split('=');\n        if (parts.length > 1) {\n          pageQuery[parts[0]] = parts[1] && decodeURIComponent(parts[1]);\n        } else if (item.indexOf('/') === 0) {\n          pageQuery.paths = item.substr(1).split('/');\n        }\n      });\n      return pageQuery;\n    }\n  }, {\n    key: \"oAuthCurrentUser\",\n    value: function oAuthCurrentUser(formio, token) {\n      return Formio.currentUser(formio, {\n        external: true,\n        headers: {\n          Authorization: \"Bearer \".concat(token)\n        }\n      });\n    }\n  }, {\n    key: \"samlInit\",\n    value: function samlInit(options) {\n      options = options || {};\n      var query = Formio.pageQuery();\n      if (query.saml) {\n        Formio.setUser(null);\n        var retVal = Formio.setToken(query.saml);\n        var uri = window.location.toString();\n        uri = uri.substring(0, uri.indexOf('?'));\n        if (window.location.hash) {\n          uri += window.location.hash;\n        }\n        window.history.replaceState({}, document.title, uri);\n        return retVal;\n      } // Set the relay if not provided.\n\n      if (!options.relay) {\n        options.relay = window.location.href;\n      } // go to the saml sso endpoint for this project.\n\n      var authUrl = Formio.authUrl || Formio.projectUrl;\n      window.location.href = \"\".concat(authUrl, \"/saml/sso?relay=\").concat(encodeURI(options.relay));\n      return false;\n    }\n  }, {\n    key: \"oktaInit\",\n    value: function oktaInit(options) {\n      options = options || {};\n      if ((typeof OktaAuth === \"undefined\" ? \"undefined\" : _typeof(OktaAuth)) !== undefined) {\n        options.OktaAuth = OktaAuth;\n      }\n      if (_typeof(options.OktaAuth) === undefined) {\n        var errorMessage = 'Cannot find OktaAuth. Please include the Okta JavaScript SDK within your application. See https://developer.okta.com/code/javascript/okta_auth_sdk for an example.';\n        console.warn(errorMessage);\n        return _nativePromiseOnly.default.reject(errorMessage);\n      }\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        var Okta = options.OktaAuth;\n        delete options.OktaAuth;\n        var authClient = new Okta(options);\n        authClient.tokenManager.get('accessToken').then(function (accessToken) {\n          if (accessToken) {\n            resolve(Formio.oAuthCurrentUser(options.formio, accessToken.accessToken));\n          } else if (location.hash) {\n            authClient.token.parseFromUrl().then(function (token) {\n              authClient.tokenManager.add('accessToken', token);\n              resolve(Formio.oAuthCurrentUser(options.formio, token.accessToken));\n            }).catch(function (err) {\n              console.warn(err);\n              reject(err);\n            });\n          } else {\n            authClient.token.getWithRedirect({\n              responseType: 'token',\n              scopes: options.scopes\n            });\n            resolve(false);\n          }\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"ssoInit\",\n    value: function ssoInit(type, options) {\n      switch (type) {\n        case 'saml':\n          return Formio.samlInit(options);\n        case 'okta':\n          return Formio.oktaInit(options);\n        default:\n          console.warn('Unknown SSO type');\n          return _nativePromiseOnly.default.reject('Unknown SSO type');\n      }\n    }\n  }, {\n    key: \"requireLibrary\",\n    value: function requireLibrary(name, property, src, polling, onload) {\n      if (!Formio.libraries.hasOwnProperty(name)) {\n        Formio.libraries[name] = {};\n        Formio.libraries[name].ready = new _nativePromiseOnly.default(function (resolve, reject) {\n          Formio.libraries[name].resolve = resolve;\n          Formio.libraries[name].reject = reject;\n        });\n        var callbackName = \"\".concat(name, \"Callback\");\n        if (!polling && !window[callbackName]) {\n          window[callbackName] = function () {\n            return Formio.libraries[name].resolve();\n          };\n        } // See if the plugin already exists.\n\n        var plugin = (0, _get2.default)(window, property);\n        if (plugin) {\n          Formio.libraries[name].resolve(plugin);\n        } else {\n          src = Array.isArray(src) ? src : [src];\n          src.forEach(function (lib) {\n            var attrs = {};\n            var elementType = '';\n            if (typeof lib === 'string') {\n              lib = {\n                type: 'script',\n                src: lib\n              };\n            }\n            switch (lib.type) {\n              case 'script':\n                elementType = 'script';\n                attrs = {\n                  src: lib.src,\n                  type: 'text/javascript',\n                  defer: true,\n                  async: true,\n                  referrerpolicy: 'origin'\n                };\n                break;\n              case 'styles':\n                elementType = 'link';\n                attrs = {\n                  href: lib.src,\n                  rel: 'stylesheet'\n                };\n                break;\n            } // Add the script to the top of the page.\n\n            var element = document.createElement(elementType);\n            if (element.setAttribute) {\n              for (var attr in attrs) {\n                element.setAttribute(attr, attrs[attr]);\n              }\n            }\n            if (onload) {\n              element.addEventListener('load', function () {\n                Formio.libraries[name].loaded = true;\n                onload(Formio.libraries[name].ready);\n              });\n            }\n            var _document = document,\n              head = _document.head;\n            if (head) {\n              head.appendChild(element);\n            }\n          }); // if no callback is provided, then check periodically for the script.\n\n          if (polling) {\n            var interval = setInterval(function () {\n              var plugin = (0, _get2.default)(window, property);\n              if (plugin) {\n                clearInterval(interval);\n                Formio.libraries[name].resolve(plugin);\n              }\n            }, 200);\n          }\n        }\n      }\n      var lib = Formio.libraries[name];\n      return onload && lib.loaded ? onload(lib.ready) : lib.ready;\n    }\n  }, {\n    key: \"libraryReady\",\n    value: function libraryReady(name) {\n      if (Formio.libraries.hasOwnProperty(name) && Formio.libraries[name].ready) {\n        return Formio.libraries[name].ready;\n      }\n      return _nativePromiseOnly.default.reject(\"\".concat(name, \" library was not required.\"));\n    }\n  }, {\n    key: \"addToGlobal\",\n    value: function addToGlobal(global) {\n      if (_typeof(global) === 'object' && !global.Formio) {\n        global.Formio = Formio;\n      }\n    }\n  }, {\n    key: \"setPathType\",\n    value: function setPathType(type) {\n      if (typeof type === 'string') {\n        Formio.pathType = type;\n      }\n    }\n  }, {\n    key: \"getPathType\",\n    value: function getPathType() {\n      return Formio.pathType;\n    }\n  }, {\n    key: \"rulesEntities\",\n    get: function get() {\n      return {\n        ValueSources: Formio.ValueSources,\n        Conjunctions: Formio.Conjunctions,\n        Operators: Formio.Operators,\n        Transformers: Formio.Transformers,\n        QuickRules: Formio.QuickRules,\n        Rules: Formio.Rules\n      };\n    }\n  }, {\n    key: \"GlobalFormio\",\n    get: function get() {\n      if (typeof global !== 'undefined' && global.Formio) {\n        return global.Formio;\n      } else if (typeof window !== 'undefined' && window.Formio) {\n        return window.Formio;\n      }\n      return Formio;\n    }\n  }]);\n  return Formio;\n}(); // Define all the static properties.\n\n_defineProperty(Formio, \"currentUserResolved\", true);\nFormio.libraries = {};\nFormio.Promise = _nativePromiseOnly.default;\nFormio.fetch = fetch;\nFormio.Headers = Headers;\nFormio.baseUrl = 'https://api.form.io';\nFormio.projectUrl = Formio.baseUrl;\nFormio.authUrl = '';\nFormio.projectUrlSet = false;\nFormio.plugins = [];\nFormio.cache = {};\nFormio.Providers = _providers.default;\nFormio.version = '4.14.12';\nFormio.pathType = '';\nFormio.events = new _EventEmitter.default();\nFormio.cdn = new _CDN.default();\nif (typeof global !== 'undefined') {\n  Formio.addToGlobal(global);\n}\nif (typeof window !== 'undefined') {\n  Formio.addToGlobal(window);\n}\nvar GlobalFormio = Formio.GlobalFormio;\nexports.GlobalFormio = GlobalFormio;\nvar _default = Formio;\nexports.default = _default;","map":{"version":3,"names":["require","Object","defineProperty","exports","value","default","GlobalFormio","_nativePromiseOnly","_interopRequireDefault","_fetchPonyfill2","_EventEmitter","_browserCookies","_providers","_intersection2","_get2","_cloneDeep2","_defaults2","_utils","_jwtDecode","_CDN","obj","__esModule","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","e","_e2","f","TypeError","normalCompletion","didErr","err","call","step","next","_e3","return","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","minLen","_arrayLikeToArray","prototype","toString","slice","constructor","name","from","test","len","arr2","_i","_arr","_n","_d","_s","_e","push","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","_defineProperty","_typeof","_fetchPonyfill","Promise","fetch","Headers","isBoolean","val","isNil","undefined","isObject","cloneResponse","response","copy","skip","limit","serverCount","Formio","path","_this","options","arguments","base","projectsUrl","projectUrl","projectId","roleUrl","rolesUrl","roleId","formUrl","formsUrl","formId","submissionsUrl","submissionUrl","submissionId","actionsUrl","actionId","actionUrl","vsUrl","vId","vUrl","query","useSessionToken","hasOwnProperty","baseUrl","window","location","href","match","concat","project","projectRegEx","isProjectUrl","search","noProject","indexOf","hostparts","getUrlParts","parts","hostName","queryparts","split","registerPath","regex","RegExp","registerItems","items","staticBase","item","newBase","pathType","replace","isNotSubdomainType","isFile","pathParts","shift","join","includes","subRegEx","subs","projectUrlSet","_delete","type","opts","_id","_url","reject","cache","makeRequest","index","serialize","params","save","data","method","reqUrl","load","url","isNaN","parseInt","_len","args","_key","apply","loadProject","saveProject","deleteProject","delete","loadRole","saveRole","deleteRole","loadRoles","loadForm","_this2","then","currentForm","revisions","_vid","revisionId","revisionForm","components","settings","assign","catch","saveForm","deleteForm","loadForms","loadSubmission","_this3","submission","_frid","_fvid","saveSubmission","deleteSubmission","loadSubmissions","loadAction","saveAction","deleteAction","loadActions","availableActions","actionInfo","isObjectId","id","checkForHexRegExp","getProjectId","resolve","getFormId","form","currentUser","accessInfo","getToken","formio","setToken","token","getTempToken","expire","allowed","authUrl","ignoreCache","header","getDownloadUrl","_this4","_form","apiUrl","postfix","submissionRevisions","changeLog","download","tempToken","uploadFile","storage","file","fileName","dir","progressCallback","fileKey","groupPermissions","groupId","uploadStartCallback","abortCallback","_this5","requestArgs","provider","request","pluginWait","pluginGet","result","Provider","getProvider","pluginAlter","downloadFile","_this6","deleteFile","_this7","userPermissions","user","all","results","roles","access","permMap","create","read","update","perms","edit","roleName","role","admin","submissionAccess","permission","_permission$type$spli","_permission$type$spli2","perm","scope","owner","eachComponent","component","defaultPermission","groups","forEach","group","canSubmit","_this8","getUser","anonPerms","setUser","tokenName","namespace","localStorage","getItem","removeItem","sessionStorage","setItem","userName","loadProjects","makeStaticRequest","_interpolate","str","interpolate","p","encodeURIComponent","getRequestArgs","toUpperCase","headers","_Formio","cacheKey","btoa","encodeURI","noToken","append","headerObj","mode","body","JSON","stringify","requestToken","ok","status","events","emit","Error","get","json","text","error","tokenIntroduced","external","console","warn","getResult","range","skipLimit","Number","getHeaders","message","networkError","tokens","formioToken","set","fromUser","fromToken","erase","currentUserResolved","decodedTokenName","decode","parse","setBaseUrl","getBaseUrl","setApiUrl","getApiUrl","setAppUrl","setProjectUrl","setAuthUrl","getAppUrl","getProjectUrl","clearCache","noop","identity","deregisterPlugin","plugin","beforeLength","plugins","filter","__name","deregister","registerPlugin","__Formio","sort","a","b","priority","init","getPlugin","_iterator","_step","pluginFn","_len2","_key2","map","_ref","_len3","_key3","callPlugin","_ref2","_len4","_key4","reduce","projectRoles","_this9","logout","pageQuery","paths","hashes","hash","substr","decodeURIComponent","oAuthCurrentUser","Authorization","samlInit","saml","retVal","uri","substring","history","replaceState","document","title","relay","oktaInit","OktaAuth","errorMessage","Okta","authClient","tokenManager","accessToken","parseFromUrl","add","getWithRedirect","responseType","scopes","ssoInit","requireLibrary","property","src","polling","onload","libraries","ready","callbackName","lib","attrs","elementType","defer","async","referrerpolicy","rel","element","createElement","setAttribute","attr","addEventListener","loaded","_document","head","appendChild","interval","setInterval","clearInterval","libraryReady","addToGlobal","global","setPathType","getPathType","ValueSources","Conjunctions","Operators","Transformers","QuickRules","Rules","Providers","version","cdn","_default"],"sources":["D:/task/node_modules/formiojs/Formio.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.GlobalFormio = void 0;\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.string.search.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.regexp.constructor.js\");\n\nrequire(\"core-js/modules/es.regexp.to-string.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.sort.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _fetchPonyfill2 = _interopRequireDefault(require(\"fetch-ponyfill\"));\n\nvar _EventEmitter = _interopRequireDefault(require(\"./EventEmitter\"));\n\nvar _browserCookies = _interopRequireDefault(require(\"browser-cookies\"));\n\nvar _providers = _interopRequireDefault(require(\"./providers\"));\n\nvar _intersection2 = _interopRequireDefault(require(\"lodash/intersection\"));\n\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _cloneDeep2 = _interopRequireDefault(require(\"lodash/cloneDeep\"));\n\nvar _defaults2 = _interopRequireDefault(require(\"lodash/defaults\"));\n\nvar _utils = require(\"./utils/utils\");\n\nvar _jwtDecode = _interopRequireDefault(require(\"jwt-decode\"));\n\nrequire(\"./polyfills\");\n\nvar _CDN = _interopRequireDefault(require(\"./CDN\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nvar _fetchPonyfill = (0, _fetchPonyfill2.default)({\n  Promise: _nativePromiseOnly.default\n}),\n    fetch = _fetchPonyfill.fetch,\n    Headers = _fetchPonyfill.Headers;\n\nvar isBoolean = function isBoolean(val) {\n  return _typeof(val) === _typeof(true);\n};\n\nvar isNil = function isNil(val) {\n  return val === null || val === undefined;\n};\n\nvar isObject = function isObject(val) {\n  return val && _typeof(val) === 'object';\n};\n\nfunction cloneResponse(response) {\n  var copy = (0, _cloneDeep2.default)(response);\n\n  if (Array.isArray(response)) {\n    copy.skip = response.skip;\n    copy.limit = response.limit;\n    copy.serverCount = response.serverCount;\n  }\n\n  return copy;\n}\n/**\n * The Formio interface class.\n *\n *   let formio = new Formio('https://examples.form.io/example');\n */\n\n\nvar Formio = /*#__PURE__*/function () {\n  /* eslint-disable max-statements */\n  function Formio(path) {\n    var _this = this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Formio);\n\n    // Ensure we have an instance of Formio.\n    if (!(this instanceof Formio)) {\n      return new Formio(path);\n    } // Initialize our variables.\n\n\n    this.base = '';\n    this.projectsUrl = '';\n    this.projectUrl = '';\n    this.projectId = '';\n    this.roleUrl = '';\n    this.rolesUrl = '';\n    this.roleId = '';\n    this.formUrl = '';\n    this.formsUrl = '';\n    this.formId = '';\n    this.submissionsUrl = '';\n    this.submissionUrl = '';\n    this.submissionId = '';\n    this.actionsUrl = '';\n    this.actionId = '';\n    this.actionUrl = '';\n    this.vsUrl = '';\n    this.vId = '';\n    this.vUrl = '';\n    this.query = ''; // Store the original path and options.\n\n    this.path = path;\n    this.options = options;\n\n    if (options.useSessionToken) {\n      Formio.useSessionToken(options);\n    }\n\n    if (options.hasOwnProperty('base')) {\n      this.base = options.base;\n    } else if (Formio.baseUrl) {\n      this.base = Formio.baseUrl;\n    } else if (typeof window !== 'undefined') {\n      this.base = window.location.href.match(/http[s]?:\\/\\/api./)[0];\n    }\n\n    if (!path) {\n      // Allow user to create new projects if this was instantiated without\n      // a url\n      this.projectUrl = Formio.projectUrl || \"\".concat(this.base, \"/project\");\n      this.projectsUrl = \"\".concat(this.base, \"/project\");\n      this.projectId = false;\n      this.query = '';\n      return;\n    }\n\n    if (options.hasOwnProperty('project')) {\n      this.projectUrl = options.project;\n    }\n\n    var project = this.projectUrl || Formio.projectUrl;\n    var projectRegEx = /(^|\\/)(project)($|\\/[^/]+)/;\n    var isProjectUrl = path.search(projectRegEx) !== -1; // The baseURL is the same as the projectUrl, and does not contain \"/project/MONGO_ID\" in\n    // its domain. This is almost certainly against the Open Source server.\n\n    if (project && this.base === project && !isProjectUrl) {\n      this.noProject = true;\n      this.projectUrl = this.base;\n    } // Normalize to an absolute path.\n\n\n    if (path.indexOf('http') !== 0 && path.indexOf('//') !== 0) {\n      path = this.base + path;\n    }\n\n    var hostparts = this.getUrlParts(path);\n    var parts = [];\n    var hostName = hostparts[1] + hostparts[2];\n    path = hostparts.length > 3 ? hostparts[3] : '';\n    var queryparts = path.split('?');\n\n    if (queryparts.length > 1) {\n      path = queryparts[0];\n      this.query = \"?\".concat(queryparts[1]);\n    } // Register a specific path.\n\n\n    var registerPath = function registerPath(name, base) {\n      _this[\"\".concat(name, \"sUrl\")] = \"\".concat(base, \"/\").concat(name);\n      var regex = new RegExp(\"/\".concat(name, \"/([^/]+)\"));\n\n      if (path.search(regex) !== -1) {\n        parts = path.match(regex);\n        _this[\"\".concat(name, \"Url\")] = parts ? base + parts[0] : '';\n        _this[\"\".concat(name, \"Id\")] = parts.length > 1 ? parts[1] : '';\n        base += parts[0];\n      }\n\n      return base;\n    }; // Register an array of items.\n\n\n    var registerItems = function registerItems(items, base, staticBase) {\n      for (var i in items) {\n        if (items.hasOwnProperty(i)) {\n          var item = items[i];\n\n          if (Array.isArray(item)) {\n            registerItems(item, base, true);\n          } else {\n            var newBase = registerPath(item, base);\n            base = staticBase ? base : newBase;\n          }\n        }\n      }\n    };\n\n    if (!this.projectUrl || this.projectUrl === this.base) {\n      // If a project uses Subdirectories path type, we need to specify a projectUrl\n      if (!this.projectUrl && !isProjectUrl && Formio.pathType === 'Subdirectories') {\n        var regex = \"^\".concat(hostName.replace(/\\//g, '\\\\/'), \".[^/]+\");\n        var match = project.match(new RegExp(regex));\n        this.projectUrl = match ? match[0] : hostName;\n      } else {\n        this.projectUrl = hostName;\n      }\n    } // Check if we have a specified path type.\n\n\n    var isNotSubdomainType = false;\n\n    if (Formio.pathType) {\n      isNotSubdomainType = Formio.pathType !== 'Subdomains';\n    }\n\n    if (!this.noProject) {\n      // Determine the projectUrl and projectId\n      if (isProjectUrl) {\n        // Get project id as project/:projectId.\n        registerItems(['project'], hostName);\n        path = path.replace(projectRegEx, '');\n      } else if (hostName === this.base) {\n        // Get project id as first part of path (subdirectory).\n        if (hostparts.length > 3 && path.split('/').length > 1) {\n          var isFile = path.match(/.json/);\n          var pathParts = path.split('/');\n\n          if (isFile) {\n            this.projectUrl = hostName;\n          } else {\n            pathParts.shift(); // Throw away the first /.\n\n            this.projectId = pathParts.shift();\n            path = \"/\".concat(pathParts.join('/'));\n            this.projectUrl = \"\".concat(hostName, \"/\").concat(this.projectId);\n          }\n        }\n      } else {\n        // Get project id from subdomain.\n        if (hostparts.length > 2 && (hostparts[2].split('.').length > 2 || hostName.includes('localhost')) && !isNotSubdomainType) {\n          this.projectUrl = hostName;\n          this.projectId = hostparts[2].split('.')[0];\n        }\n      }\n\n      this.projectsUrl = this.projectsUrl || \"\".concat(this.base, \"/project\");\n    } // Configure Role urls and role ids.\n\n\n    registerItems(['role'], this.projectUrl); // Configure Form urls and form ids.\n\n    if (/(^|\\/)(form)($|\\/)/.test(path)) {\n      registerItems(['form', ['submission', 'action', 'v']], this.projectUrl);\n    } else {\n      var subRegEx = new RegExp('/(submission|action|v)($|/.*)');\n      var subs = path.match(subRegEx);\n      this.pathType = subs && subs.length > 1 ? subs[1] : '';\n      path = path.replace(subRegEx, '');\n      path = path.replace(/\\/$/, '');\n      this.formsUrl = \"\".concat(this.projectUrl, \"/form\");\n      this.formUrl = path ? this.projectUrl + path : '';\n      this.formId = path.replace(/^\\/+|\\/+$/g, '');\n      var items = ['submission', 'action', 'v'];\n\n      for (var i in items) {\n        if (items.hasOwnProperty(i)) {\n          var item = items[i];\n          this[\"\".concat(item, \"sUrl\")] = \"\".concat(this.projectUrl + path, \"/\").concat(item);\n\n          if (this.pathType === item && subs.length > 2 && subs[2]) {\n            this[\"\".concat(item, \"Id\")] = subs[2].replace(/^\\/+|\\/+$/g, '');\n            this[\"\".concat(item, \"Url\")] = this.projectUrl + path + subs[0];\n          }\n        }\n      }\n    } // Set the app url if it is not set.\n\n\n    if (!Formio.projectUrlSet) {\n      Formio.projectUrl = this.projectUrl;\n    }\n  }\n  /* eslint-enable max-statements */\n\n\n  _createClass(Formio, [{\n    key: \"delete\",\n    value: function _delete(type, opts) {\n      var _id = \"\".concat(type, \"Id\");\n\n      var _url = \"\".concat(type, \"Url\");\n\n      if (!this[_id]) {\n        return _nativePromiseOnly.default.reject('Nothing to delete');\n      }\n\n      Formio.cache = {};\n      return this.makeRequest(type, this[_url], 'delete', null, opts);\n    }\n  }, {\n    key: \"index\",\n    value: function index(type, query, opts) {\n      var _url = \"\".concat(type, \"Url\");\n\n      query = query || '';\n\n      if (query && isObject(query)) {\n        query = \"?\".concat(Formio.serialize(query.params));\n      }\n\n      return this.makeRequest(type, this[_url] + query, 'get', null, opts);\n    }\n  }, {\n    key: \"save\",\n    value: function save(type, data, opts) {\n      var _id = \"\".concat(type, \"Id\");\n\n      var _url = \"\".concat(type, \"Url\");\n\n      var method = this[_id] || data._id ? 'put' : 'post';\n      var reqUrl = this[_id] ? this[_url] : this[\"\".concat(type, \"sUrl\")];\n\n      if (!this[_id] && data._id && method === 'put' && !reqUrl.includes(data._id)) {\n        reqUrl += \"/\".concat(data._id);\n      }\n\n      Formio.cache = {};\n      return this.makeRequest(type, reqUrl + this.query, method, data, opts);\n    }\n  }, {\n    key: \"load\",\n    value: function load(type, query, opts) {\n      var _id = \"\".concat(type, \"Id\");\n\n      var _url = \"\".concat(type, \"Url\");\n\n      if (query && isObject(query)) {\n        query = Formio.serialize(query.params);\n      }\n\n      if (query) {\n        query = this.query ? \"\".concat(this.query, \"&\").concat(query) : \"?\".concat(query);\n      } else {\n        query = this.query;\n      }\n\n      if (!this[_id]) {\n        return _nativePromiseOnly.default.reject(\"Missing \".concat(_id));\n      }\n\n      var url = this[_url] + query;\n\n      if (type === 'form' && !isNaN(parseInt(this.vId)) && parseInt(this.vId) !== 0) {\n        url += url.match(/\\?/) ? '&' : '?';\n        url += \"formRevision=\".concat(this.vId);\n      }\n\n      return this.makeRequest(type, url, 'get', null, opts);\n    }\n  }, {\n    key: \"makeRequest\",\n    value: function makeRequest() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return Formio.makeRequest.apply(Formio, [this].concat(args));\n    }\n  }, {\n    key: \"loadProject\",\n    value: function loadProject(query, opts) {\n      return this.load('project', query, opts);\n    }\n  }, {\n    key: \"saveProject\",\n    value: function saveProject(data, opts) {\n      return this.save('project', data, opts);\n    }\n  }, {\n    key: \"deleteProject\",\n    value: function deleteProject(opts) {\n      return this.delete('project', opts);\n    }\n  }, {\n    key: \"loadRole\",\n    value: function loadRole(opts) {\n      return this.load('role', null, opts);\n    }\n  }, {\n    key: \"saveRole\",\n    value: function saveRole(data, opts) {\n      return this.save('role', data, opts);\n    }\n  }, {\n    key: \"deleteRole\",\n    value: function deleteRole(opts) {\n      return this.delete('role', opts);\n    }\n  }, {\n    key: \"loadRoles\",\n    value: function loadRoles(opts) {\n      return this.index('roles', null, opts);\n    }\n  }, {\n    key: \"loadForm\",\n    value: function loadForm(query, opts) {\n      var _this2 = this;\n\n      return this.load('form', query, opts).then(function (currentForm) {\n        // Check to see if there isn't a number in vId.\n        if (!currentForm.revisions || isNaN(parseInt(_this2.vId))) {\n          return currentForm;\n        } // If a submission already exists but form is marked to load current version of form.\n\n\n        if (currentForm.revisions === 'current' && _this2.submissionId) {\n          return currentForm;\n        } // eslint-disable-next-line eqeqeq\n\n\n        if (currentForm._vid == _this2.vId || currentForm.revisionId === _this2.vId) {\n          return currentForm;\n        } // If they specified a revision form, load the revised form components.\n\n\n        if (query && isObject(query)) {\n          query = Formio.serialize(query.params);\n        }\n\n        if (query) {\n          query = _this2.query ? \"\".concat(_this2.query, \"&\").concat(query) : \"?\".concat(query);\n        } else {\n          query = _this2.query;\n        }\n\n        return _this2.makeRequest('form', _this2.vUrl + query, 'get', null, opts).then(function (revisionForm) {\n          currentForm._vid = revisionForm._vid;\n          currentForm.components = revisionForm.components;\n          currentForm.settings = revisionForm.settings;\n          currentForm.revisionId = revisionForm.revisionId; // Using object.assign so we don't cross polinate multiple form loads.\n\n          return Object.assign({}, currentForm);\n        }) // If we couldn't load the revision, just return the original form.\n        .catch(function () {\n          return Object.assign({}, currentForm);\n        });\n      });\n    }\n  }, {\n    key: \"saveForm\",\n    value: function saveForm(data, opts) {\n      return this.save('form', data, opts);\n    }\n  }, {\n    key: \"deleteForm\",\n    value: function deleteForm(opts) {\n      return this.delete('form', opts);\n    }\n  }, {\n    key: \"loadForms\",\n    value: function loadForms(query, opts) {\n      return this.index('forms', query, opts);\n    }\n  }, {\n    key: \"loadSubmission\",\n    value: function loadSubmission(query, opts) {\n      var _this3 = this;\n\n      return this.load('submission', query, opts).then(function (submission) {\n        _this3.vId = submission._frid || submission._fvid;\n        _this3.vUrl = \"\".concat(_this3.formUrl, \"/v/\").concat(_this3.vId);\n        return submission;\n      });\n    }\n  }, {\n    key: \"saveSubmission\",\n    value: function saveSubmission(data, opts) {\n      if (!isNaN(parseInt(this.vId))) {\n        data._fvid = this.vId;\n      }\n\n      return this.save('submission', data, opts);\n    }\n  }, {\n    key: \"deleteSubmission\",\n    value: function deleteSubmission(opts) {\n      return this.delete('submission', opts);\n    }\n  }, {\n    key: \"loadSubmissions\",\n    value: function loadSubmissions(query, opts) {\n      return this.index('submissions', query, opts);\n    }\n  }, {\n    key: \"loadAction\",\n    value: function loadAction(query, opts) {\n      return this.load('action', query, opts);\n    }\n  }, {\n    key: \"saveAction\",\n    value: function saveAction(data, opts) {\n      return this.save('action', data, opts);\n    }\n  }, {\n    key: \"deleteAction\",\n    value: function deleteAction(opts) {\n      return this.delete('action', opts);\n    }\n  }, {\n    key: \"loadActions\",\n    value: function loadActions(query, opts) {\n      return this.index('actions', query, opts);\n    }\n  }, {\n    key: \"availableActions\",\n    value: function availableActions() {\n      return this.makeRequest('availableActions', \"\".concat(this.formUrl, \"/actions\"));\n    }\n  }, {\n    key: \"actionInfo\",\n    value: function actionInfo(name) {\n      return this.makeRequest('actionInfo', \"\".concat(this.formUrl, \"/actions/\").concat(name));\n    }\n  }, {\n    key: \"isObjectId\",\n    value: function isObjectId(id) {\n      var checkForHexRegExp = new RegExp('^[0-9a-fA-F]{24}$');\n      return checkForHexRegExp.test(id);\n    }\n  }, {\n    key: \"getProjectId\",\n    value: function getProjectId() {\n      if (!this.projectId) {\n        return _nativePromiseOnly.default.resolve('');\n      }\n\n      if (this.isObjectId(this.projectId)) {\n        return _nativePromiseOnly.default.resolve(this.projectId);\n      } else {\n        return this.loadProject().then(function (project) {\n          return project._id;\n        });\n      }\n    }\n  }, {\n    key: \"getFormId\",\n    value: function getFormId() {\n      if (!this.formId) {\n        return _nativePromiseOnly.default.resolve('');\n      }\n\n      if (this.isObjectId(this.formId)) {\n        return _nativePromiseOnly.default.resolve(this.formId);\n      } else {\n        return this.loadForm().then(function (form) {\n          return form._id;\n        });\n      }\n    }\n  }, {\n    key: \"currentUser\",\n    value: function currentUser(options) {\n      return Formio.currentUser(this, options);\n    }\n  }, {\n    key: \"accessInfo\",\n    value: function accessInfo() {\n      return Formio.accessInfo(this);\n    }\n    /**\n     * Returns the JWT token for this instance.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getToken\",\n    value: function getToken(options) {\n      return Formio.getToken(Object.assign({\n        formio: this\n      }, this.options, options));\n    }\n    /**\n     * Sets the JWT token for this instance.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"setToken\",\n    value: function setToken(token, options) {\n      return Formio.setToken(token, Object.assign({\n        formio: this\n      }, this.options, options));\n    }\n    /**\n     * Returns a temporary authentication token for single purpose token generation.\n     */\n\n  }, {\n    key: \"getTempToken\",\n    value: function getTempToken(expire, allowed, options) {\n      var token = Formio.getToken(options);\n\n      if (!token) {\n        return _nativePromiseOnly.default.reject('You must be authenticated to generate a temporary auth token.');\n      }\n\n      var authUrl = Formio.authUrl || this.projectUrl;\n      return this.makeRequest('tempToken', \"\".concat(authUrl, \"/token\"), 'GET', null, {\n        ignoreCache: true,\n        header: new Headers({\n          'x-expire': expire,\n          'x-allow': allowed\n        })\n      });\n    }\n    /**\n     * Get a download url for a submission PDF of this submission.\n     *\n     * @return {*}\n     */\n\n  }, {\n    key: \"getDownloadUrl\",\n    value: function getDownloadUrl(form) {\n      var _this4 = this;\n\n      if (!this.submissionId) {\n        return _nativePromiseOnly.default.resolve('');\n      }\n\n      if (!form) {\n        // Make sure to load the form first.\n        return this.loadForm().then(function (_form) {\n          if (!_form) {\n            return '';\n          }\n\n          return _this4.getDownloadUrl(_form);\n        });\n      }\n\n      var apiUrl = \"/project/\".concat(form.project);\n      apiUrl += \"/form/\".concat(form._id);\n      apiUrl += \"/submission/\".concat(this.submissionId);\n      var postfix = form.submissionRevisions && form.settings.changeLog ? '/download/changelog' : '/download';\n      apiUrl += postfix;\n      var download = this.base + apiUrl;\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        _this4.getTempToken(3600, \"GET:\".concat(apiUrl)).then(function (tempToken) {\n          download += \"?token=\".concat(tempToken.key);\n          resolve(download);\n        }, function () {\n          resolve(download);\n        }).catch(reject);\n      });\n    }\n  }, {\n    key: \"uploadFile\",\n    value: function uploadFile(storage, file, fileName, dir, progressCallback, url, options, fileKey, groupPermissions, groupId, uploadStartCallback, abortCallback) {\n      var _this5 = this;\n\n      var requestArgs = {\n        provider: storage,\n        method: 'upload',\n        file: file,\n        fileName: fileName,\n        dir: dir\n      };\n      fileKey = fileKey || 'file';\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('fileRequest', requestArgs).then(function (result) {\n          if (storage && isNil(result)) {\n            var Provider = _providers.default.getProvider('storage', storage);\n\n            if (Provider) {\n              var provider = new Provider(_this5);\n\n              if (uploadStartCallback) {\n                uploadStartCallback();\n              }\n\n              return provider.uploadFile(file, fileName, dir, progressCallback, url, options, fileKey, groupPermissions, groupId, abortCallback);\n            } else {\n              throw 'Storage provider not found';\n            }\n          }\n\n          return result || {\n            url: ''\n          };\n        });\n      });\n      return Formio.pluginAlter('wrapFileRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"downloadFile\",\n    value: function downloadFile(file, options) {\n      var _this6 = this;\n\n      var requestArgs = {\n        method: 'download',\n        file: file\n      };\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('fileRequest', requestArgs).then(function (result) {\n          if (file.storage && isNil(result)) {\n            var Provider = _providers.default.getProvider('storage', file.storage);\n\n            if (Provider) {\n              var provider = new Provider(_this6);\n              return provider.downloadFile(file, options);\n            } else {\n              throw 'Storage provider not found';\n            }\n          }\n\n          return result || {\n            url: ''\n          };\n        });\n      });\n      return Formio.pluginAlter('wrapFileRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"deleteFile\",\n    value: function deleteFile(file, options) {\n      var _this7 = this;\n\n      var requestArgs = {\n        method: 'delete',\n        file: file\n      };\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('fileRequest', requestArgs).then(function (result) {\n          if (file.storage && isNil(result)) {\n            var Provider = _providers.default.getProvider('storage', file.storage);\n\n            if (Provider) {\n              var provider = new Provider(_this7);\n              return provider.deleteFile(file, options);\n            } else {\n              throw 'Storage provider not found';\n            }\n          }\n\n          return result || {\n            url: ''\n          };\n        });\n      });\n      return Formio.pluginAlter('wrapFileRequestPromise', request, requestArgs);\n    }\n    /**\n     * Returns the user permissions to a form and submission.\n     *\n     * @param user - The user or current user if undefined. For anonymous, use \"null\"\n     * @param form - The form or current form if undefined. For no form check, use \"null\"\n     * @param submission - The submisison or \"index\" if undefined.\n     *\n     * @return {create: boolean, read: boolean, edit: boolean, delete: boolean}\n     */\n\n  }, {\n    key: \"userPermissions\",\n    value: function userPermissions(user, form, submission) {\n      return _nativePromiseOnly.default.all([form !== undefined ? _nativePromiseOnly.default.resolve(form) : this.loadForm(), user !== undefined ? _nativePromiseOnly.default.resolve(user) : this.currentUser(), submission !== undefined || !this.submissionId ? _nativePromiseOnly.default.resolve(submission) : this.loadSubmission(), this.accessInfo()]).then(function (results) {\n        var form = results.shift();\n        var user = results.shift() || {\n          _id: false,\n          roles: []\n        };\n        var submission = results.shift();\n        var access = results.shift();\n        var permMap = {\n          create: 'create',\n          read: 'read',\n          update: 'edit',\n          delete: 'delete'\n        };\n        var perms = {\n          user: user,\n          form: form,\n          access: access,\n          create: false,\n          read: false,\n          edit: false,\n          delete: false\n        };\n\n        for (var roleName in access.roles) {\n          if (access.roles.hasOwnProperty(roleName)) {\n            var role = access.roles[roleName];\n\n            if (role.default && user._id === false) {\n              // User is anonymous. Add the anonymous role.\n              user.roles.push(role._id);\n            } else if (role.admin && user.roles.indexOf(role._id) !== -1) {\n              perms.create = true;\n              perms.read = true;\n              perms.delete = true;\n              perms.edit = true;\n              return perms;\n            }\n          }\n        }\n\n        if (form && form.submissionAccess) {\n          for (var i = 0; i < form.submissionAccess.length; i++) {\n            var permission = form.submissionAccess[i];\n\n            var _permission$type$spli = permission.type.split('_'),\n                _permission$type$spli2 = _slicedToArray(_permission$type$spli, 2),\n                perm = _permission$type$spli2[0],\n                scope = _permission$type$spli2[1];\n\n            if (['create', 'read', 'update', 'delete'].includes(perm)) {\n              if ((0, _intersection2.default)(permission.roles, user.roles).length) {\n                perms[permMap[perm]] = scope === 'all' || !submission || user._id === submission.owner;\n              }\n            }\n          }\n        } // check for Group Permissions\n\n\n        if (submission) {\n          // we would anyway need to loop through components for create permission, so we'll do that for all of them\n          (0, _utils.eachComponent)(form.components, function (component, path) {\n            if (component && component.defaultPermission) {\n              var value = (0, _get2.default)(submission.data, path); // make it work for single-select Group and multi-select Group\n\n              var groups = Array.isArray(value) ? value : [value];\n              groups.forEach(function (group) {\n                if (group && group._id && // group id is present\n                user.roles.indexOf(group._id) > -1 // user has group id in his roles\n                ) {\n                  if (component.defaultPermission === 'read') {\n                    perms[permMap.read] = true;\n                  }\n\n                  if (component.defaultPermission === 'create') {\n                    perms[permMap.create] = true;\n                    perms[permMap.read] = true;\n                  }\n\n                  if (component.defaultPermission === 'write') {\n                    perms[permMap.create] = true;\n                    perms[permMap.read] = true;\n                    perms[permMap.update] = true;\n                  }\n\n                  if (component.defaultPermission === 'admin') {\n                    perms[permMap.create] = true;\n                    perms[permMap.read] = true;\n                    perms[permMap.update] = true;\n                    perms[permMap.delete] = true;\n                  }\n                }\n              });\n            }\n          });\n        }\n\n        return perms;\n      });\n    }\n    /**\n     * Determine if the current user can submit a form.\n     * @return {*}\n     */\n\n  }, {\n    key: \"canSubmit\",\n    value: function canSubmit() {\n      var _this8 = this;\n\n      return this.userPermissions().then(function (perms) {\n        // If there is user and they cannot create, then check anonymous user permissions.\n        if (!perms.create && Formio.getUser()) {\n          return _this8.userPermissions(null).then(function (anonPerms) {\n            if (anonPerms.create) {\n              Formio.setUser(null);\n              return true;\n            }\n\n            return false;\n          });\n        }\n\n        return perms.create;\n      });\n    }\n  }, {\n    key: \"getUrlParts\",\n    value: function getUrlParts(url) {\n      return Formio.getUrlParts(url, this);\n    }\n  }], [{\n    key: \"useSessionToken\",\n    value: function useSessionToken(options) {\n      var tokenName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"Token\");\n      var token = localStorage.getItem(tokenName);\n\n      if (token) {\n        localStorage.removeItem(tokenName);\n        sessionStorage.setItem(tokenName, token);\n      }\n\n      var userName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"User\");\n      var user = localStorage.getItem(userName);\n\n      if (user) {\n        localStorage.removeItem(userName);\n        sessionStorage.setItem(userName, user);\n      }\n\n      localStorage.setItem('useSessionToken', true);\n    }\n  }, {\n    key: \"loadProjects\",\n    value: function loadProjects(query, opts) {\n      query = query || '';\n\n      if (isObject(query)) {\n        query = \"?\".concat(Formio.serialize(query.params));\n      }\n\n      return Formio.makeStaticRequest(\"\".concat(Formio.baseUrl, \"/project\").concat(query), 'GET', null, opts);\n    }\n  }, {\n    key: \"getUrlParts\",\n    value: function getUrlParts(url, formio) {\n      var base = formio && formio.base ? formio.base : Formio.baseUrl;\n      var regex = '^(http[s]?:\\\\/\\\\/)';\n\n      if (base && url.indexOf(base) === 0) {\n        regex += \"(\".concat(base.replace(/^http[s]?:\\/\\//, ''), \")\");\n      } else {\n        regex += '([^/]+)';\n      }\n\n      regex += '($|\\\\/.*)';\n      return url.match(new RegExp(regex));\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize(obj, _interpolate) {\n      var str = [];\n\n      var interpolate = function interpolate(item) {\n        return _interpolate ? _interpolate(item) : item;\n      };\n\n      for (var p in obj) {\n        if (obj.hasOwnProperty(p)) {\n          str.push(\"\".concat(encodeURIComponent(p), \"=\").concat(encodeURIComponent(interpolate(obj[p]))));\n        }\n      }\n\n      return str.join('&');\n    }\n  }, {\n    key: \"getRequestArgs\",\n    value: function getRequestArgs(formio, type, url, method, data, opts) {\n      method = (method || 'GET').toUpperCase();\n\n      if (!opts || !isObject(opts)) {\n        opts = {};\n      }\n\n      var requestArgs = {\n        url: url,\n        method: method,\n        data: data || null,\n        opts: opts\n      };\n\n      if (type) {\n        requestArgs.type = type;\n      }\n\n      if (formio) {\n        requestArgs.formio = formio;\n      }\n\n      return requestArgs;\n    }\n  }, {\n    key: \"makeStaticRequest\",\n    value: function makeStaticRequest(url, method, data, opts) {\n      var requestArgs = Formio.getRequestArgs(null, '', url, method, data, opts);\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('staticRequest', requestArgs).then(function (result) {\n          if (isNil(result)) {\n            return Formio.request(requestArgs.url, requestArgs.method, requestArgs.data, requestArgs.opts.header, requestArgs.opts);\n          }\n\n          return result;\n        });\n      });\n      return Formio.pluginAlter('wrapStaticRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"makeRequest\",\n    value: function makeRequest(formio, type, url, method, data, opts) {\n      if (!formio) {\n        return Formio.makeStaticRequest(url, method, data, opts);\n      }\n\n      var requestArgs = Formio.getRequestArgs(formio, type, url, method, data, opts);\n      requestArgs.opts = requestArgs.opts || {};\n      requestArgs.opts.formio = formio; //for Formio requests default Accept and Content-type headers\n\n      if (!requestArgs.opts.headers) {\n        requestArgs.opts.headers = {};\n      }\n\n      requestArgs.opts.headers = (0, _defaults2.default)(requestArgs.opts.headers, {\n        'Accept': 'application/json',\n        'Content-type': 'application/json'\n      });\n      var request = Formio.pluginWait('preRequest', requestArgs).then(function () {\n        return Formio.pluginGet('request', requestArgs).then(function (result) {\n          if (isNil(result)) {\n            return Formio.request(requestArgs.url, requestArgs.method, requestArgs.data, requestArgs.opts.header, requestArgs.opts);\n          }\n\n          return result;\n        });\n      });\n      return Formio.pluginAlter('wrapRequestPromise', request, requestArgs);\n    }\n  }, {\n    key: \"request\",\n    value: function request(url, method, data, header, opts) {\n      if (!url) {\n        return _nativePromiseOnly.default.reject('No url provided');\n      }\n\n      var _Formio = Formio;\n      method = (method || 'GET').toUpperCase(); // For reverse compatibility, if they provided the ignoreCache parameter,\n      // then change it back to the options format where that is a parameter.\n\n      if (isBoolean(opts)) {\n        opts = {\n          ignoreCache: opts\n        };\n      }\n\n      if (!opts || !isObject(opts)) {\n        opts = {};\n      } // Generate a cachekey.\n\n\n      var cacheKey = btoa(encodeURI(url)); // Get the cached promise to save multiple loads.\n\n      if (!opts.ignoreCache && method === 'GET' && _Formio.cache.hasOwnProperty(cacheKey)) {\n        return _nativePromiseOnly.default.resolve(cloneResponse(_Formio.cache[cacheKey]));\n      } // Set up and fetch request\n\n\n      var headers = header || new Headers(opts.headers || {\n        'Accept': 'application/json',\n        'Content-type': 'application/json'\n      });\n\n      var token = _Formio.getToken(opts);\n\n      if (token && !opts.noToken) {\n        headers.append('x-jwt-token', token);\n      } // The fetch-ponyfill can't handle a proper Headers class anymore. Change it back to an object.\n\n\n      var headerObj = {};\n      headers.forEach(function (value, name) {\n        headerObj[name] = value;\n      });\n      var options = {\n        method: method,\n        headers: headerObj,\n        mode: 'cors'\n      };\n\n      if (data) {\n        options.body = JSON.stringify(data);\n      } // Allow plugins to alter the options.\n\n\n      options = _Formio.pluginAlter('requestOptions', options, url);\n\n      if (options.namespace || _Formio.namespace) {\n        opts.namespace = options.namespace || _Formio.namespace;\n      }\n\n      var requestToken = options.headers['x-jwt-token'];\n\n      var result = _Formio.pluginAlter('wrapFetchRequestPromise', _Formio.fetch(url, options), {\n        url: url,\n        method: method,\n        data: data,\n        opts: opts\n      }).then(function (response) {\n        // Allow plugins to respond.\n        response = _Formio.pluginAlter('requestResponse', response, _Formio, data);\n\n        if (!response.ok) {\n          if (response.status === 440) {\n            _Formio.setToken(null, opts);\n\n            _Formio.events.emit('formio.sessionExpired', response.body);\n          } else if (response.status === 401) {\n            _Formio.events.emit('formio.unauthorized', response.body);\n          } else if (response.status === 416) {\n            _Formio.events.emit('formio.rangeIsNotSatisfiable', response.body);\n          } else if (response.status === 504) {\n            return _nativePromiseOnly.default.reject(new Error('Network request failed'));\n          } // Parse and return the error as a rejected promise to reject this promise\n\n\n          return (response.headers.get('content-type').includes('application/json') ? response.json() : response.text()).then(function (error) {\n            return _nativePromiseOnly.default.reject(error);\n          });\n        } // Handle fetch results\n\n\n        var token = response.headers.get('x-jwt-token'); // In some strange cases, the fetch library will return an x-jwt-token without sending\n        // one to the server. This has even been debugged on the server to verify that no token\n        // was introduced with the request, but the response contains a token. This is an Invalid\n        // case where we do not send an x-jwt-token and get one in return for any GET request.\n\n        var tokenIntroduced = false;\n\n        if (method === 'GET' && !requestToken && token && !opts.external && !url.includes('token=') && !url.includes('x-jwt-token=')) {\n          console.warn('Token was introduced in request.');\n          tokenIntroduced = true;\n        }\n\n        if (response.status >= 200 && response.status < 300 && token && token !== '' && !tokenIntroduced) {\n          _Formio.setToken(token, opts);\n        } // 204 is no content. Don't try to .json() it.\n\n\n        if (response.status === 204) {\n          return {};\n        }\n\n        var getResult = response.headers.get('content-type').includes('application/json') ? response.json() : response.text();\n        return getResult.then(function (result) {\n          // Add some content-range metadata to the result here\n          var range = response.headers.get('content-range');\n\n          if (range && isObject(result)) {\n            range = range.split('/');\n\n            if (range[0] !== '*') {\n              var skipLimit = range[0].split('-');\n              result.skip = Number(skipLimit[0]);\n              result.limit = skipLimit[1] - skipLimit[0] + 1;\n            }\n\n            result.serverCount = range[1] === '*' ? range[1] : Number(range[1]);\n          }\n\n          if (!opts.getHeaders) {\n            return result;\n          }\n\n          var headers = {};\n          response.headers.forEach(function (item, key) {\n            headers[key] = item;\n          }); // Return the result with the headers.\n\n          return {\n            result: result,\n            headers: headers\n          };\n        });\n      }).then(function (result) {\n        if (opts.getHeaders) {\n          return result;\n        } // Cache the response.\n\n\n        if (method === 'GET') {\n          _Formio.cache[cacheKey] = result;\n        }\n\n        return cloneResponse(result);\n      }).catch(function (err) {\n        if (err === 'Bad Token') {\n          _Formio.setToken(null, opts);\n\n          _Formio.events.emit('formio.badToken', err);\n        }\n\n        if (err.message) {\n          err = new Error(\"Could not connect to API server (\".concat(err.message, \"): \").concat(url));\n          err.networkError = true;\n        }\n\n        if (method === 'GET') {\n          delete _Formio.cache[cacheKey];\n        }\n\n        return _nativePromiseOnly.default.reject(err);\n      });\n\n      return result;\n    } // Needed to maintain reverse compatability...\n\n  }, {\n    key: \"token\",\n    get: function get() {\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n\n      return Formio.tokens.formioToken || '';\n    } // Needed to maintain reverse compatability...\n    ,\n    set: function set(token) {\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n\n      Formio.tokens.formioToken = token || '';\n    }\n  }, {\n    key: \"setToken\",\n    value: function setToken() {\n      var token = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var opts = arguments.length > 1 ? arguments[1] : undefined;\n      token = token || '';\n      opts = typeof opts === 'string' ? {\n        namespace: opts\n      } : opts || {};\n      var tokenName = \"\".concat(opts.namespace || Formio.namespace || 'formio', \"Token\");\n\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n\n      var storage = localStorage.getItem('useSessionToken') ? sessionStorage : localStorage;\n\n      if (!token) {\n        if (!opts.fromUser) {\n          opts.fromToken = true;\n          Formio.setUser(null, opts);\n        } // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n\n        try {\n          storage.removeItem(tokenName);\n        } catch (err) {\n          _browserCookies.default.erase(tokenName, {\n            path: '/'\n          });\n        }\n\n        Formio.tokens[tokenName] = token;\n        return _nativePromiseOnly.default.resolve(null);\n      }\n\n      if (Formio.tokens[tokenName] !== token) {\n        Formio.tokens[tokenName] = token; // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n        try {\n          storage.setItem(tokenName, token);\n        } catch (err) {\n          _browserCookies.default.set(tokenName, token, {\n            path: '/'\n          });\n        }\n      } // Return or updates the current user\n\n\n      return this.currentUserResolved ? Formio.currentUser(opts.formio, opts) : _nativePromiseOnly.default.resolve(null);\n    }\n  }, {\n    key: \"getToken\",\n    value: function getToken(options) {\n      options = typeof options === 'string' ? {\n        namespace: options\n      } : options || {};\n      var tokenName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"Token\");\n      var decodedTokenName = options.decode ? \"\".concat(tokenName, \"Decoded\") : tokenName;\n\n      if (!Formio.tokens) {\n        Formio.tokens = {};\n      }\n\n      if (Formio.tokens[decodedTokenName]) {\n        return Formio.tokens[decodedTokenName];\n      }\n\n      try {\n        var token = localStorage.getItem('useSessionToken') ? sessionStorage.getItem(tokenName) : localStorage.getItem(tokenName);\n        Formio.tokens[tokenName] = token || '';\n\n        if (options.decode) {\n          Formio.tokens[decodedTokenName] = Formio.tokens[tokenName] ? (0, _jwtDecode.default)(Formio.tokens[tokenName]) : {};\n          return Formio.tokens[decodedTokenName];\n        }\n\n        return Formio.tokens[tokenName];\n      } catch (e) {\n        Formio.tokens[tokenName] = _browserCookies.default.get(tokenName);\n        return Formio.tokens[tokenName];\n      }\n    }\n  }, {\n    key: \"setUser\",\n    value: function setUser(user) {\n      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var userName = \"\".concat(opts.namespace || Formio.namespace || 'formio', \"User\");\n      var storage = localStorage.getItem('useSessionToken') ? sessionStorage : localStorage;\n\n      if (!user) {\n        if (!opts.fromToken) {\n          opts.fromUser = true;\n          Formio.setToken(null, opts);\n        } // Emit an event on the cleared user.\n\n\n        Formio.events.emit('formio.user', null); // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n        try {\n          return storage.removeItem(userName);\n        } catch (err) {\n          return _browserCookies.default.erase(userName, {\n            path: '/'\n          });\n        }\n      } // iOS in private browse mode will throw an error but we can't detect ahead of time that we are in private mode.\n\n\n      try {\n        storage.setItem(userName, JSON.stringify(user));\n      } catch (err) {\n        _browserCookies.default.set(userName, JSON.stringify(user), {\n          path: '/'\n        });\n      } // Emit an event on the authenticated user.\n\n\n      Formio.events.emit('formio.user', user);\n    }\n  }, {\n    key: \"getUser\",\n    value: function getUser(options) {\n      options = options || {};\n      var userName = \"\".concat(options.namespace || Formio.namespace || 'formio', \"User\");\n\n      try {\n        return JSON.parse((localStorage.getItem('useSessionToken') ? sessionStorage : localStorage).getItem(userName) || null);\n      } catch (e) {\n        return JSON.parse(_browserCookies.default.get(userName));\n      }\n    }\n  }, {\n    key: \"setBaseUrl\",\n    value: function setBaseUrl(url) {\n      Formio.baseUrl = url;\n\n      if (!Formio.projectUrlSet) {\n        Formio.projectUrl = url;\n      }\n    }\n  }, {\n    key: \"getBaseUrl\",\n    value: function getBaseUrl() {\n      return Formio.baseUrl;\n    }\n  }, {\n    key: \"setApiUrl\",\n    value: function setApiUrl(url) {\n      return Formio.setBaseUrl(url);\n    }\n  }, {\n    key: \"getApiUrl\",\n    value: function getApiUrl() {\n      return Formio.getBaseUrl();\n    }\n  }, {\n    key: \"setAppUrl\",\n    value: function setAppUrl(url) {\n      console.warn('Formio.setAppUrl() is deprecated. Use Formio.setProjectUrl instead.');\n      Formio.projectUrl = url;\n      Formio.projectUrlSet = true;\n    }\n  }, {\n    key: \"setProjectUrl\",\n    value: function setProjectUrl(url) {\n      Formio.projectUrl = url;\n      Formio.projectUrlSet = true;\n    }\n  }, {\n    key: \"setAuthUrl\",\n    value: function setAuthUrl(url) {\n      Formio.authUrl = url;\n    }\n  }, {\n    key: \"getAppUrl\",\n    value: function getAppUrl() {\n      console.warn('Formio.getAppUrl() is deprecated. Use Formio.getProjectUrl instead.');\n      return Formio.projectUrl;\n    }\n  }, {\n    key: \"getProjectUrl\",\n    value: function getProjectUrl() {\n      return Formio.projectUrl;\n    }\n  }, {\n    key: \"clearCache\",\n    value: function clearCache() {\n      Formio.cache = {};\n    }\n  }, {\n    key: \"noop\",\n    value: function noop() {}\n  }, {\n    key: \"identity\",\n    value: function identity(value) {\n      return value;\n    }\n  }, {\n    key: \"deregisterPlugin\",\n    value: function deregisterPlugin(plugin) {\n      var beforeLength = Formio.plugins.length;\n      Formio.plugins = Formio.plugins.filter(function (p) {\n        if (p !== plugin && p.__name !== plugin) {\n          return true;\n        }\n\n        (p.deregister || Formio.noop).call(plugin, Formio);\n        return false;\n      });\n      return beforeLength !== Formio.plugins.length;\n    }\n  }, {\n    key: \"registerPlugin\",\n    value: function registerPlugin(plugin, name) {\n      var __Formio = Formio;\n\n      __Formio.plugins.push(plugin);\n\n      __Formio.plugins.sort(function (a, b) {\n        return (b.priority || 0) - (a.priority || 0);\n      });\n\n      plugin.__name = name;\n\n      (plugin.init || __Formio.noop).call(plugin, __Formio);\n    }\n  }, {\n    key: \"getPlugin\",\n    value: function getPlugin(name) {\n      var _iterator = _createForOfIteratorHelper(Formio.plugins),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var plugin = _step.value;\n\n          if (plugin.__name === name) {\n            return plugin;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"pluginWait\",\n    value: function pluginWait(pluginFn) {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      return _nativePromiseOnly.default.all(Formio.plugins.map(function (plugin) {\n        var _ref;\n\n        return (_ref = plugin[pluginFn] || Formio.noop).call.apply(_ref, [plugin].concat(args));\n      }));\n    }\n  }, {\n    key: \"pluginGet\",\n    value: function pluginGet(pluginFn) {\n      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        args[_key3 - 1] = arguments[_key3];\n      }\n\n      var callPlugin = function callPlugin(index) {\n        var _ref2;\n\n        var plugin = Formio.plugins[index];\n\n        if (!plugin) {\n          return _nativePromiseOnly.default.resolve(null);\n        }\n\n        return _nativePromiseOnly.default.resolve((_ref2 = plugin[pluginFn] || Formio.noop).call.apply(_ref2, [plugin].concat(args))).then(function (result) {\n          if (!isNil(result)) {\n            return result;\n          }\n\n          return callPlugin(index + 1);\n        });\n      };\n\n      return callPlugin(0);\n    }\n  }, {\n    key: \"pluginAlter\",\n    value: function pluginAlter(pluginFn, value) {\n      for (var _len4 = arguments.length, args = new Array(_len4 > 2 ? _len4 - 2 : 0), _key4 = 2; _key4 < _len4; _key4++) {\n        args[_key4 - 2] = arguments[_key4];\n      }\n\n      return Formio.plugins.reduce(function (value, plugin) {\n        return (plugin[pluginFn] || Formio.identity).apply(void 0, [value].concat(args));\n      }, value);\n    }\n  }, {\n    key: \"accessInfo\",\n    value: function accessInfo(formio) {\n      var projectUrl = formio ? formio.projectUrl : Formio.projectUrl;\n      return Formio.makeRequest(formio, 'accessInfo', \"\".concat(projectUrl, \"/access\"));\n    }\n  }, {\n    key: \"projectRoles\",\n    value: function projectRoles(formio) {\n      var projectUrl = formio ? formio.projectUrl : Formio.projectUrl;\n      return Formio.makeRequest(formio, 'projectRoles', \"\".concat(projectUrl, \"/role\"));\n    }\n  }, {\n    key: \"currentUser\",\n    value: function currentUser(formio, options) {\n      var _this9 = this;\n\n      var authUrl = Formio.authUrl;\n\n      if (!authUrl) {\n        authUrl = formio ? formio.projectUrl : Formio.projectUrl || Formio.baseUrl;\n      }\n\n      authUrl += '/current';\n      var user = Formio.getUser(options);\n\n      if (user) {\n        return Formio.pluginAlter('wrapStaticRequestPromise', _nativePromiseOnly.default.resolve(user), {\n          url: authUrl,\n          method: 'GET',\n          options: options\n        });\n      }\n\n      var token = Formio.getToken(options);\n\n      if ((!options || !options.external) && !token) {\n        return Formio.pluginAlter('wrapStaticRequestPromise', _nativePromiseOnly.default.resolve(null), {\n          url: authUrl,\n          method: 'GET',\n          options: options\n        });\n      }\n\n      authUrl = \"\".concat(Formio.baseUrl, \"/current\");\n      this.currentUserResolved = false;\n      return Formio.makeRequest(formio, 'currentUser', authUrl, 'GET', null, options).then(function (response) {\n        _this9.currentUserResolved = true;\n        Formio.setUser(response, options);\n        return response;\n      });\n    }\n  }, {\n    key: \"logout\",\n    value: function logout(formio, options) {\n      options = options || {};\n      options.formio = formio;\n      var projectUrl = Formio.authUrl ? Formio.authUrl : formio ? formio.projectUrl : Formio.baseUrl;\n\n      var logout = function logout() {\n        Formio.setToken(null, options);\n        Formio.setUser(null, options);\n        Formio.clearCache();\n        localStorage.removeItem('useSessionToken');\n      };\n\n      return Formio.makeRequest(formio, 'logout', \"\".concat(projectUrl, \"/logout\")).then(function (result) {\n        logout();\n        return result;\n      }).catch(function (err) {\n        logout();\n        throw err;\n      });\n    }\n  }, {\n    key: \"pageQuery\",\n    value: function pageQuery() {\n      var pageQuery = {};\n      pageQuery.paths = [];\n      var hashes = location.hash.substr(1).replace(/\\?/g, '&').split('&');\n      var parts = [];\n      location.search.substr(1).split('&').forEach(function (item) {\n        parts = item.split('=');\n\n        if (parts.length > 1) {\n          pageQuery[parts[0]] = parts[1] && decodeURIComponent(parts[1]);\n        }\n      });\n      hashes.forEach(function (item) {\n        parts = item.split('=');\n\n        if (parts.length > 1) {\n          pageQuery[parts[0]] = parts[1] && decodeURIComponent(parts[1]);\n        } else if (item.indexOf('/') === 0) {\n          pageQuery.paths = item.substr(1).split('/');\n        }\n      });\n      return pageQuery;\n    }\n  }, {\n    key: \"oAuthCurrentUser\",\n    value: function oAuthCurrentUser(formio, token) {\n      return Formio.currentUser(formio, {\n        external: true,\n        headers: {\n          Authorization: \"Bearer \".concat(token)\n        }\n      });\n    }\n  }, {\n    key: \"samlInit\",\n    value: function samlInit(options) {\n      options = options || {};\n      var query = Formio.pageQuery();\n\n      if (query.saml) {\n        Formio.setUser(null);\n        var retVal = Formio.setToken(query.saml);\n        var uri = window.location.toString();\n        uri = uri.substring(0, uri.indexOf('?'));\n\n        if (window.location.hash) {\n          uri += window.location.hash;\n        }\n\n        window.history.replaceState({}, document.title, uri);\n        return retVal;\n      } // Set the relay if not provided.\n\n\n      if (!options.relay) {\n        options.relay = window.location.href;\n      } // go to the saml sso endpoint for this project.\n\n\n      var authUrl = Formio.authUrl || Formio.projectUrl;\n      window.location.href = \"\".concat(authUrl, \"/saml/sso?relay=\").concat(encodeURI(options.relay));\n      return false;\n    }\n  }, {\n    key: \"oktaInit\",\n    value: function oktaInit(options) {\n      options = options || {};\n\n      if ((typeof OktaAuth === \"undefined\" ? \"undefined\" : _typeof(OktaAuth)) !== undefined) {\n        options.OktaAuth = OktaAuth;\n      }\n\n      if (_typeof(options.OktaAuth) === undefined) {\n        var errorMessage = 'Cannot find OktaAuth. Please include the Okta JavaScript SDK within your application. See https://developer.okta.com/code/javascript/okta_auth_sdk for an example.';\n        console.warn(errorMessage);\n        return _nativePromiseOnly.default.reject(errorMessage);\n      }\n\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        var Okta = options.OktaAuth;\n        delete options.OktaAuth;\n        var authClient = new Okta(options);\n        authClient.tokenManager.get('accessToken').then(function (accessToken) {\n          if (accessToken) {\n            resolve(Formio.oAuthCurrentUser(options.formio, accessToken.accessToken));\n          } else if (location.hash) {\n            authClient.token.parseFromUrl().then(function (token) {\n              authClient.tokenManager.add('accessToken', token);\n              resolve(Formio.oAuthCurrentUser(options.formio, token.accessToken));\n            }).catch(function (err) {\n              console.warn(err);\n              reject(err);\n            });\n          } else {\n            authClient.token.getWithRedirect({\n              responseType: 'token',\n              scopes: options.scopes\n            });\n            resolve(false);\n          }\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    }\n  }, {\n    key: \"ssoInit\",\n    value: function ssoInit(type, options) {\n      switch (type) {\n        case 'saml':\n          return Formio.samlInit(options);\n\n        case 'okta':\n          return Formio.oktaInit(options);\n\n        default:\n          console.warn('Unknown SSO type');\n          return _nativePromiseOnly.default.reject('Unknown SSO type');\n      }\n    }\n  }, {\n    key: \"requireLibrary\",\n    value: function requireLibrary(name, property, src, polling, onload) {\n      if (!Formio.libraries.hasOwnProperty(name)) {\n        Formio.libraries[name] = {};\n        Formio.libraries[name].ready = new _nativePromiseOnly.default(function (resolve, reject) {\n          Formio.libraries[name].resolve = resolve;\n          Formio.libraries[name].reject = reject;\n        });\n        var callbackName = \"\".concat(name, \"Callback\");\n\n        if (!polling && !window[callbackName]) {\n          window[callbackName] = function () {\n            return Formio.libraries[name].resolve();\n          };\n        } // See if the plugin already exists.\n\n\n        var plugin = (0, _get2.default)(window, property);\n\n        if (plugin) {\n          Formio.libraries[name].resolve(plugin);\n        } else {\n          src = Array.isArray(src) ? src : [src];\n          src.forEach(function (lib) {\n            var attrs = {};\n            var elementType = '';\n\n            if (typeof lib === 'string') {\n              lib = {\n                type: 'script',\n                src: lib\n              };\n            }\n\n            switch (lib.type) {\n              case 'script':\n                elementType = 'script';\n                attrs = {\n                  src: lib.src,\n                  type: 'text/javascript',\n                  defer: true,\n                  async: true,\n                  referrerpolicy: 'origin'\n                };\n                break;\n\n              case 'styles':\n                elementType = 'link';\n                attrs = {\n                  href: lib.src,\n                  rel: 'stylesheet'\n                };\n                break;\n            } // Add the script to the top of the page.\n\n\n            var element = document.createElement(elementType);\n\n            if (element.setAttribute) {\n              for (var attr in attrs) {\n                element.setAttribute(attr, attrs[attr]);\n              }\n            }\n\n            if (onload) {\n              element.addEventListener('load', function () {\n                Formio.libraries[name].loaded = true;\n                onload(Formio.libraries[name].ready);\n              });\n            }\n\n            var _document = document,\n                head = _document.head;\n\n            if (head) {\n              head.appendChild(element);\n            }\n          }); // if no callback is provided, then check periodically for the script.\n\n          if (polling) {\n            var interval = setInterval(function () {\n              var plugin = (0, _get2.default)(window, property);\n\n              if (plugin) {\n                clearInterval(interval);\n                Formio.libraries[name].resolve(plugin);\n              }\n            }, 200);\n          }\n        }\n      }\n\n      var lib = Formio.libraries[name];\n      return onload && lib.loaded ? onload(lib.ready) : lib.ready;\n    }\n  }, {\n    key: \"libraryReady\",\n    value: function libraryReady(name) {\n      if (Formio.libraries.hasOwnProperty(name) && Formio.libraries[name].ready) {\n        return Formio.libraries[name].ready;\n      }\n\n      return _nativePromiseOnly.default.reject(\"\".concat(name, \" library was not required.\"));\n    }\n  }, {\n    key: \"addToGlobal\",\n    value: function addToGlobal(global) {\n      if (_typeof(global) === 'object' && !global.Formio) {\n        global.Formio = Formio;\n      }\n    }\n  }, {\n    key: \"setPathType\",\n    value: function setPathType(type) {\n      if (typeof type === 'string') {\n        Formio.pathType = type;\n      }\n    }\n  }, {\n    key: \"getPathType\",\n    value: function getPathType() {\n      return Formio.pathType;\n    }\n  }, {\n    key: \"rulesEntities\",\n    get: function get() {\n      return {\n        ValueSources: Formio.ValueSources,\n        Conjunctions: Formio.Conjunctions,\n        Operators: Formio.Operators,\n        Transformers: Formio.Transformers,\n        QuickRules: Formio.QuickRules,\n        Rules: Formio.Rules\n      };\n    }\n  }, {\n    key: \"GlobalFormio\",\n    get: function get() {\n      if (typeof global !== 'undefined' && global.Formio) {\n        return global.Formio;\n      } else if (typeof window !== 'undefined' && window.Formio) {\n        return window.Formio;\n      }\n\n      return Formio;\n    }\n  }]);\n\n  return Formio;\n}(); // Define all the static properties.\n\n\n_defineProperty(Formio, \"currentUserResolved\", true);\n\nFormio.libraries = {};\nFormio.Promise = _nativePromiseOnly.default;\nFormio.fetch = fetch;\nFormio.Headers = Headers;\nFormio.baseUrl = 'https://api.form.io';\nFormio.projectUrl = Formio.baseUrl;\nFormio.authUrl = '';\nFormio.projectUrlSet = false;\nFormio.plugins = [];\nFormio.cache = {};\nFormio.Providers = _providers.default;\nFormio.version = '4.14.12';\nFormio.pathType = '';\nFormio.events = new _EventEmitter.default();\nFormio.cdn = new _CDN.default();\n\nif (typeof global !== 'undefined') {\n  Formio.addToGlobal(global);\n}\n\nif (typeof window !== 'undefined') {\n  Formio.addToGlobal(window);\n}\n\nvar GlobalFormio = Formio.GlobalFormio;\nexports.GlobalFormio = GlobalFormio;\nvar _default = Formio;\nexports.default = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script"}