{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nrequire(\"core-js/modules/es.reflect.construct.js\");\nrequire(\"core-js/modules/es.reflect.get.js\");\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\nrequire(\"core-js/modules/es.symbol.js\");\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\nrequire(\"core-js/modules/es.symbol.description.js\");\nrequire(\"core-js/modules/es.symbol.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.map.js\");\nrequire(\"core-js/modules/es.array.sort.js\");\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/es.regexp.exec.js\");\nrequire(\"core-js/modules/es.string.replace.js\");\nrequire(\"core-js/modules/es.array.includes.js\");\nrequire(\"core-js/modules/es.string.includes.js\");\nrequire(\"core-js/modules/es.object.keys.js\");\nrequire(\"core-js/modules/es.array.concat.js\");\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\nrequire(\"core-js/modules/es.array.slice.js\");\nrequire(\"core-js/modules/es.string.match.js\");\nrequire(\"core-js/modules/es.array.from.js\");\nrequire(\"core-js/modules/es.string.iterator.js\");\nrequire(\"core-js/modules/es.array.find.js\");\nrequire(\"core-js/modules/es.array.find-index.js\");\nrequire(\"core-js/modules/es.array.splice.js\");\nrequire(\"core-js/modules/es.array.iterator.js\");\nrequire(\"core-js/modules/es.map.js\");\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\nrequire(\"core-js/modules/es.string.starts-with.js\");\nrequire(\"core-js/modules/es.regexp.flags.js\");\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\nvar _Webform = _interopRequireDefault(require(\"./Webform\"));\nvar _Component2 = _interopRequireDefault(require(\"./components/_classes/component/Component\"));\nvar _tippy = _interopRequireDefault(require(\"tippy.js\"));\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\nvar _Components = _interopRequireDefault(require(\"./components/Components\"));\nvar _Formio = require(\"./Formio\");\nvar _utils = require(\"./utils/utils\");\nvar _formUtils = require(\"./utils/formUtils\");\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get.bind();\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get.apply(this, arguments);\n}\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nrequire('./components/builder');\nvar Templates = _Formio.GlobalFormio.Templates;\nif (!Templates) {\n  Templates = require('./templates/Templates').default;\n}\nvar dragula;\nif (typeof window !== 'undefined') {\n  // Import from \"dist\" because it would require and \"global\" would not be defined in Angular apps.\n  dragula = require('dragula/dist/dragula');\n}\nvar WebformBuilder = /*#__PURE__*/function (_Component) {\n  _inherits(WebformBuilder, _Component);\n  var _super = _createSuper(WebformBuilder);\n\n  // eslint-disable-next-line max-statements\n  function WebformBuilder() {\n    var _this;\n    _classCallCheck(this, WebformBuilder);\n    var element, options;\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Reset skipInit in case PDFBuilder has set it.\n\n    options.skipInit = false;\n    options.display = options.display || 'form';\n    _this = _super.call(this, null, options);\n    _this.element = element;\n    _this.builderHeight = 0;\n    _this.schemas = {};\n    _this.repeatablePaths = [];\n    _this.sideBarScroll = _lodash.default.get(_this.options, 'sideBarScroll', true);\n    _this.sideBarScrollOffset = _lodash.default.get(_this.options, 'sideBarScrollOffset', 0);\n    _this.dragDropEnabled = true; // Setup the builder options.\n\n    _this.builder = _lodash.default.defaultsDeep({}, _this.options.builder, _this.defaultGroups); // Turn off if explicitely said to do so...\n\n    _lodash.default.each(_this.defaultGroups, function (config, key) {\n      if (config === false) {\n        _this.builder[key] = false;\n      }\n    }); // Add the groups.\n\n    _this.groups = {};\n    _this.groupOrder = [];\n    var _loop = function _loop(group) {\n      if (_this.builder[group]) {\n        _this.builder[group].key = group;\n        _this.groups[group] = _this.builder[group];\n        _this.groups[group].components = _this.groups[group].components || {};\n        _this.groups[group].componentOrder = _this.groups[group].componentOrder || [];\n        _this.groups[group].subgroups = Object.keys(_this.groups[group].groups || {}).map(function (groupKey) {\n          _this.groups[group].groups[groupKey].componentOrder = Object.keys(_this.groups[group].groups[groupKey].components).map(function (key) {\n            return key;\n          });\n          return _this.groups[group].groups[groupKey];\n        });\n        _this.groupOrder.push(_this.groups[group]);\n      }\n    };\n    for (var group in _this.builder) {\n      _loop(group);\n    }\n    _this.groupOrder = _this.groupOrder.filter(function (group) {\n      return group && !group.ignore;\n    }).sort(function (a, b) {\n      return a.weight - b.weight;\n    }).map(function (group) {\n      return group.key;\n    });\n    for (var type in _Components.default.components) {\n      var component = _Components.default.components[type];\n      if (component.builderInfo && component.builderInfo.schema) {\n        _this.schemas[type] = component.builderInfo.schema;\n        component.type = type;\n        var builderInfo = component.builderInfo;\n        builderInfo.key = component.type;\n        _this.addBuilderComponentInfo(builderInfo);\n      }\n    } // Filter out any extra components.\n    // Add the components in each group.\n\n    for (var _group in _this.groups) {\n      var info = _this.groups[_group];\n      for (var key in info.components) {\n        var compKey = _group === 'resource' ? \"component-\".concat(key) : key;\n        var comp = info.components[compKey];\n        if (comp === true && _Components.default.components[key] && _Components.default.components[key].builderInfo) {\n          comp = _Components.default.components[key].builderInfo;\n        }\n        if (comp && comp.schema) {\n          _this.schemas[key] = comp.schema;\n          info.components[compKey] = comp;\n          info.components[compKey].key = key;\n        } else {\n          // Do not include this component in the components array.\n          delete info.components[compKey];\n        }\n      } // Order the components.\n\n      _this.orderComponents(info);\n    }\n    _this.options.hooks = _this.options.hooks || {};\n    _this.options.hooks.renderComponent = function (html, _ref) {\n      var _self$component;\n      var component = _ref.component,\n        self = _ref.self;\n      if (self.type === 'form' && !self.key) {\n        var template = _this.hook('renderComponentFormTemplate', html.replace('formio-component-form', '')); // The main webform shouldn't have this class as it adds extra styles.\n\n        return template;\n      }\n      if (_this.options.disabled && _this.options.disabled.includes(self.key) || self.parent.noDragDrop) {\n        return html;\n      }\n      return _this.renderTemplate('builderComponent', {\n        html: html,\n        disableBuilderActions: self === null || self === void 0 ? void 0 : (_self$component = self.component) === null || _self$component === void 0 ? void 0 : _self$component.disableBuilderActions,\n        childComponent: component\n      });\n    };\n    _this.options.hooks.renderComponents = function (html, _ref2) {\n      var components = _ref2.components,\n        self = _ref2.self;\n\n      // if Datagrid and already has a component, don't make it droppable.\n      if (self.type === 'datagrid' && components.length > 0 || self.noDragDrop) {\n        return html;\n      }\n      if (!components || !components.length && !components.nodrop || self.type === 'form' && components.length <= 1 && (components.length === 0 || components[0].type === 'button')) {\n        html = _this.renderTemplate('builderPlaceholder', {\n          position: 0\n        }) + html;\n      }\n      return _this.renderTemplate('builderComponents', {\n        key: self.key,\n        type: self.type,\n        html: html\n      });\n    };\n    _this.options.hooks.renderInput = function (html, _ref3) {\n      var self = _ref3.self;\n      if (self.type === 'hidden') {\n        return html + self.name;\n      }\n      return html;\n    };\n    _this.options.hooks.renderLoading = function (html, _ref4) {\n      var self = _ref4.self;\n      if (self.type === 'form' && self.key) {\n        return self.name;\n      }\n      return html;\n    };\n    _this.options.hooks.attachComponents = function (element, components, container, component) {\n      // Don't attach if no element was found or component doesn't participate in drag'n'drop.\n      if (!element) {\n        return;\n      }\n      if (component.noDragDrop) {\n        return element;\n      } // Attach container and component to element for later reference.\n\n      var containerElement = element.querySelector(\"[ref=\\\"\".concat(component.component.key, \"-container\\\"]\")) || element;\n      containerElement.formioContainer = container;\n      containerElement.formioComponent = component; // Add container to draggable list.\n\n      if (_this.dragula && _this.allowDrop(element)) {\n        _this.dragula.containers.push(containerElement);\n      } // If this is an existing datagrid element, don't make it draggable.\n\n      if ((component.type === 'datagrid' || component.type === 'datamap') && components.length > 0) {\n        return element;\n      } // Since we added a wrapper, need to return the original element so that we can find the components inside it.\n\n      return element.children[0];\n    };\n    _this.options.hooks.attachDatagrid = function (element, component) {\n      component.loadRefs(element, _defineProperty({}, \"\".concat(component.key, \"-container\"), 'single'));\n      var dataGridContainer = component.refs[\"\".concat(component.key, \"-container\")];\n      if (dataGridContainer) {\n        component.attachComponents(dataGridContainer.parentNode, [], component.component.components);\n      } // Need to set up horizontal rearrangement of fields.\n    };\n\n    _this.options.hooks.attachComponent = _this.attachComponent.bind(_assertThisInitialized(_this)); // Load resources tagged as 'builder'\n\n    var query = {\n      params: {\n        type: 'resource',\n        limit: 1000000,\n        select: '_id,title,name,components'\n      }\n    };\n    if (_this.options && _this.options.resourceTag) {\n      query.params.tags = [_this.options.resourceTag];\n    } else if (!_this.options || !_this.options.hasOwnProperty('resourceTag')) {\n      query.params.tags = ['builder'];\n    }\n    var formio = new _Formio.GlobalFormio(_Formio.GlobalFormio.projectUrl);\n    var isResourcesDisabled = _this.options.builder && _this.options.builder.resource === false;\n    formio.loadProject().then(function (project) {\n      if (project && (_lodash.default.get(project, 'settings.addConfigToForms', false) || _lodash.default.get(project, 'addConfigToForms', false))) {\n        var config = project.config || {};\n        _this.options.formConfig = config;\n        var pathToFormConfig = 'webform._form.config';\n        var webformConfig = _lodash.default.get(_assertThisInitialized(_this), pathToFormConfig);\n        if (_this.webform && !webformConfig) {\n          _lodash.default.set(_assertThisInitialized(_this), pathToFormConfig, config);\n        }\n      }\n    }).catch(function (err) {\n      console.warn(\"Could not load project settings: \".concat(err.message || err));\n    });\n    if (!formio.noProject && !isResourcesDisabled) {\n      var resourceOptions = _this.options.builder && _this.options.builder.resource;\n      formio.loadForms(query).then(function (resources) {\n        if (resources.length) {\n          _this.builder.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n          _this.groups.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n          if (!_this.groupOrder.includes('resource')) {\n            _this.groupOrder.push('resource');\n          }\n          _this.addExistingResourceFields(resources);\n        }\n      });\n    } // Notify components if they need to modify their render.\n\n    _this.options.attachMode = 'builder';\n    _this.webform = _this.webform || _this.createForm(_this.options);\n    _this.pathComponentsMapping = {};\n    _this.arrayDataComponentPaths = [];\n    _this.nestedDataComponents = [];\n    _this.arrayDataComponents = [];\n    return _this;\n  }\n  _createClass(WebformBuilder, [{\n    key: \"allowDrop\",\n    value: function allowDrop() {\n      return true;\n    }\n  }, {\n    key: \"addExistingResourceFields\",\n    value: function addExistingResourceFields(resources) {\n      var _this2 = this;\n      _lodash.default.each(resources, function (resource, index) {\n        var resourceKey = \"resource-\".concat(resource.name);\n        var subgroup = {\n          key: resourceKey,\n          title: resource.title,\n          components: [],\n          componentOrder: [],\n          default: index === 0\n        };\n        (0, _formUtils.eachComponent)(resource.components, function (component) {\n          if (component.type === 'button') return;\n          if (_this2.options && _this2.options.resourceFilter && (!component.tags || component.tags.indexOf(_this2.options.resourceFilter) === -1)) return;\n          var componentName = component.label;\n          if (!componentName && component.key) {\n            componentName = _lodash.default.upperFirst(component.key);\n          }\n          subgroup.componentOrder.push(\"component-\".concat(component.key));\n          subgroup.components[\"component-\".concat(component.key)] = _lodash.default.merge((0, _utils.fastCloneDeep)(_Components.default.components[component.type] ? _Components.default.components[component.type].builderInfo : _Components.default.components['unknown'].builderInfo), {\n            key: component.key,\n            title: componentName,\n            group: 'resource',\n            subgroup: resourceKey\n          }, {\n            schema: _objectSpread(_objectSpread({}, component), {}, {\n              label: component.label,\n              key: component.key,\n              lockKey: true,\n              source: !_this2.options.noSource ? resource._id : undefined,\n              isNew: true\n            })\n          });\n        }, true);\n        _this2.groups.resource.subgroups.push(subgroup);\n      });\n      this.triggerRedraw();\n    }\n  }, {\n    key: \"attachTooltip\",\n    value: function attachTooltip(component, title) {\n      return (0, _tippy.default)(component, {\n        allowHTML: true,\n        trigger: 'mouseenter focus',\n        placement: 'top',\n        delay: [200, 0],\n        zIndex: 10000,\n        content: title\n      });\n    }\n  }, {\n    key: \"attachComponent\",\n    value: function attachComponent(element, component) {\n      var _this3 = this;\n\n      // Add component to element for later reference.\n      element.formioComponent = component;\n      component.loadRefs(element, {\n        removeComponent: 'single',\n        editComponent: 'single',\n        moveComponent: 'single',\n        copyComponent: 'single',\n        pasteComponent: 'single',\n        editJson: 'single'\n      });\n      if (component.refs.copyComponent) {\n        this.attachTooltip(component.refs.copyComponent, this.t('Copy'));\n        component.addEventListener(component.refs.copyComponent, 'click', function () {\n          return _this3.copyComponent(component);\n        });\n      }\n      if (component.refs.pasteComponent) {\n        var pasteToolTip = this.attachTooltip(component.refs.pasteComponent, this.t('Paste below'));\n        component.addEventListener(component.refs.pasteComponent, 'click', function () {\n          pasteToolTip.hide();\n          _this3.pasteComponent(component);\n        });\n      }\n      if (component.refs.moveComponent) {\n        this.attachTooltip(component.refs.moveComponent, this.t('Move'));\n      }\n      var parent = this.getParentElement(element);\n      if (component.refs.editComponent) {\n        this.attachTooltip(component.refs.editComponent, this.t('Edit'));\n        component.addEventListener(component.refs.editComponent, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, false, component.component, {\n            inDataGrid: component.isInDataGrid\n          });\n        });\n      }\n      if (component.refs.editJson) {\n        this.attachTooltip(component.refs.editJson, this.t('Edit JSON'));\n        component.addEventListener(component.refs.editJson, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, true, component.component);\n        });\n      }\n      if (component.refs.removeComponent) {\n        this.attachTooltip(component.refs.removeComponent, this.t('Remove'));\n        component.addEventListener(component.refs.removeComponent, 'click', function () {\n          return _this3.removeComponent(component.schema, parent, component.component);\n        });\n      }\n      return element;\n    }\n  }, {\n    key: \"createForm\",\n    value: function createForm(options) {\n      this.webform = new _Webform.default(this.element, options);\n      if (this.element) {\n        this.loadRefs(this.element, {\n          form: 'single'\n        });\n        if (this.refs.form) {\n          this.webform.element = this.refs.form;\n        }\n      }\n      return this.webform;\n    }\n    /**\n     * Called when everything is ready.\n     *\n     * @returns {Promise} - Wait for webform to be ready.\n     */\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.webform.ready;\n    }\n  }, {\n    key: \"defaultGroups\",\n    get: function get() {\n      return {\n        basic: {\n          title: 'Basic',\n          weight: 0,\n          default: true\n        },\n        advanced: {\n          title: 'Advanced',\n          weight: 10\n        },\n        layout: {\n          title: 'Layout',\n          weight: 20\n        },\n        data: {\n          title: 'Data',\n          weight: 30\n        },\n        premium: {\n          title: 'Premium',\n          weight: 40\n        }\n      };\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      return _Webform.default.prototype.redraw.call(this);\n    }\n  }, {\n    key: \"form\",\n    get: function get() {\n      return this.webform.form;\n    },\n    set: function set(value) {\n      this.setForm(value);\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.webform.schema;\n    }\n  }, {\n    key: \"container\",\n    get: function get() {\n      return this.webform.form.components;\n    }\n    /**\n     * When a component sets its api key, we need to check if it is unique within its namespace. Find the namespace root\n     * so we can calculate this correctly.\n     * @param component\n     */\n  }, {\n    key: \"findNamespaceRoot\",\n    value: function findNamespaceRoot(component) {\n      var path = (0, _utils.getArrayFromComponentPath)(component.path); // First get the component with nested parents.\n\n      var comp = this.webform.getComponent(path);\n      comp = Array.isArray(comp) ? comp[0] : comp;\n      var namespaceKey = this.recurseNamespace(comp); // If there is no key, it is the root form.\n\n      if (!namespaceKey || this.form.key === namespaceKey) {\n        return this.form.components;\n      }\n      var componentSchema = component.component; // If the current component is the namespace, we don't need to find it again.\n\n      if (namespaceKey === component.key) {\n        return [].concat(_toConsumableArray(componentSchema.components), [componentSchema]);\n      } // Get the namespace component so we have the original object.\n\n      var namespaceComponent = (0, _formUtils.getComponent)(this.form.components, namespaceKey, true);\n      return namespaceComponent ? namespaceComponent.components : comp.components;\n    }\n  }, {\n    key: \"recurseNamespace\",\n    value: function recurseNamespace(component) {\n      // If there is no parent, we are at the root level.\n      if (!component) {\n        return null;\n      } // Some components are their own namespace.\n\n      if (['address', 'container', 'datagrid', 'editgrid', 'dynamicWizard', 'tree'].includes(component.type) || component.tree || component.arrayTree) {\n        return component.key;\n      } // Anything else, keep going up.\n\n      return this.recurseNamespace(component.parent);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n      return this.renderTemplate('builder', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this4.renderTemplate('builderSidebarGroup', {\n              group: _this4.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this4.id),\n              subgroups: _this4.groups[groupKey].subgroups.map(function (group) {\n                return _this4.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        form: this.webform.render()\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this5 = this;\n      this.on('change', function (form) {\n        _this5.populateRecaptchaSettings(form);\n      });\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"attach\", this).call(this, element).then(function () {\n        _this5.loadRefs(element, {\n          form: 'single',\n          sidebar: 'single',\n          'sidebar-search': 'single',\n          'sidebar-groups': 'single',\n          'container': 'multiple',\n          'sidebar-anchor': 'multiple',\n          'sidebar-group': 'multiple',\n          'sidebar-container': 'multiple'\n        });\n        if (_this5.sideBarScroll && Templates.current.handleBuilderSidebarScroll) {\n          Templates.current.handleBuilderSidebarScroll.call(_this5, _this5);\n        } // Add the paste status in form\n\n        if (typeof window !== 'undefined' && window.sessionStorage) {\n          var data = window.sessionStorage.getItem('formio.clipboard');\n          if (data) {\n            _this5.addClass(_this5.refs.form, 'builder-paste-mode');\n          }\n        }\n        if (!(0, _utils.bootstrapVersion)(_this5.options)) {\n          // Initialize\n          _this5.refs['sidebar-group'].forEach(function (group) {\n            group.style.display = group.getAttribute('data-default') === 'true' ? 'inherit' : 'none';\n          }); // Click event\n\n          _this5.refs['sidebar-anchor'].forEach(function (anchor, index) {\n            _this5.addEventListener(anchor, 'click', function () {\n              var clickedParentId = anchor.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n              var clickedId = anchor.getAttribute('data-target').slice('#group-'.length);\n              _this5.refs['sidebar-group'].forEach(function (group, groupIndex) {\n                var openByDefault = group.getAttribute('data-default') === 'true';\n                var groupId = group.getAttribute('id').slice('group-'.length);\n                var groupParent = group.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n                group.style.display = openByDefault && groupParent === clickedId || groupId === clickedParentId || groupIndex === index ? 'inherit' : 'none';\n              });\n            }, true);\n          });\n        }\n        _this5.addEventListener(_this5.refs['sidebar-search'], 'input', _lodash.default.debounce(function (e) {\n          var searchString = e.target.value;\n          _this5.searchFields(searchString);\n        }, 300));\n        if (_this5.dragDropEnabled) {\n          _this5.initDragula();\n        }\n        if (_this5.refs.form) {\n          return _this5.webform.attach(_this5.refs.form);\n        }\n      });\n    }\n  }, {\n    key: \"searchFields\",\n    value: function searchFields() {\n      var _this6 = this;\n      var searchString = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var searchValue = searchString.toLowerCase();\n      var sidebar = this.refs['sidebar'];\n      var sidebarGroups = this.refs['sidebar-groups'];\n      if (!sidebar || !sidebarGroups) {\n        return;\n      }\n      var filterGroupBy = function filterGroupBy(group) {\n        var searchValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n        var result = _lodash.default.toPlainObject(group);\n        var _result$subgroups = result.subgroups,\n          subgroups = _result$subgroups === void 0 ? [] : _result$subgroups,\n          components = result.components;\n        var filteredComponents = [];\n        for (var key in components) {\n          var isMatchedToTitle = components[key].title.toLowerCase().match(searchValue);\n          var isMatchedToKey = components[key].key.toLowerCase().match(searchValue);\n          if (isMatchedToTitle || isMatchedToKey) {\n            filteredComponents.push(components[key]);\n          }\n        }\n        _this6.orderComponents(result, filteredComponents);\n        if (searchValue) {\n          result.default = true;\n        }\n        if (result.componentOrder.length || subgroups.length) {\n          return result;\n        }\n        return null;\n      };\n      var filterGroupOrder = function filterGroupOrder(groupOrder, searchValue) {\n        var result = _lodash.default.cloneDeep(groupOrder);\n        return result.filter(function (key) {\n          return filterGroupBy(_this6.groups[key], searchValue);\n        });\n      };\n      var filterSubgroups = function filterSubgroups(groups, searchValue) {\n        var result = _lodash.default.clone(groups);\n        return result.map(function (subgroup) {\n          return filterGroupBy(subgroup, searchValue);\n        }).filter(function (subgroup) {\n          return !_lodash.default.isNull(subgroup);\n        });\n      };\n      var toTemplate = function toTemplate(groupKey) {\n        return {\n          group: filterGroupBy(_this6.groups[groupKey], searchValue),\n          groupKey: groupKey,\n          groupId: sidebar.id || sidebarGroups.id,\n          subgroups: filterSubgroups(_this6.groups[groupKey].subgroups, searchValue).map(function (group) {\n            return _this6.renderTemplate('builderSidebarGroup', {\n              group: group,\n              groupKey: group.key,\n              groupId: \"group-container-\".concat(groupKey),\n              subgroups: []\n            });\n          })\n        };\n      };\n      sidebarGroups.innerHTML = filterGroupOrder(this.groupOrder, searchValue).map(function (groupKey) {\n        return _this6.renderTemplate('builderSidebarGroup', toTemplate(groupKey));\n      }).join('');\n      this.loadRefs(this.element, {\n        'sidebar-groups': 'single',\n        'sidebar-anchor': 'multiple',\n        'sidebar-group': 'multiple',\n        'sidebar-container': 'multiple'\n      });\n      this.updateDragAndDrop();\n      if (searchValue === '') {\n        this.triggerRedraw();\n      }\n    }\n  }, {\n    key: \"orderComponents\",\n    value: function orderComponents(groupInfo, foundComponents) {\n      var components = foundComponents || groupInfo.components;\n      var isResource = groupInfo.key.indexOf('resource-') === 0;\n      if (components) {\n        groupInfo.componentOrder = Object.keys(components).map(function (key) {\n          return components[key];\n        }).filter(function (component) {\n          return component && !component.ignore && !component.ignoreForForm;\n        }).sort(function (a, b) {\n          return a.weight - b.weight;\n        }).map(function (component) {\n          return isResource ? \"component-\".concat(component.key) : component.key;\n        });\n      }\n    }\n  }, {\n    key: \"updateDragAndDrop\",\n    value: function updateDragAndDrop() {\n      if (this.dragDropEnabled) {\n        this.initDragula();\n      }\n      if (this.refs.form) {\n        return this.webform.attach(this.refs.form);\n      }\n    }\n  }, {\n    key: \"initDragula\",\n    value: function initDragula() {\n      var _this7 = this;\n      var options = this.options;\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n      var containersArray = Array.prototype.slice.call(this.refs['sidebar-container']).filter(function (item) {\n        return item.id !== 'group-container-resource';\n      });\n      if (!dragula) {\n        return;\n      }\n      this.dragula = dragula(containersArray, {\n        moves: function moves(el) {\n          var moves = true;\n          var list = Array.from(el.classList).filter(function (item) {\n            return item.indexOf('formio-component-') === 0;\n          });\n          list.forEach(function (item) {\n            var key = item.slice('formio-component-'.length);\n            if (options.disabled && options.disabled.includes(key)) {\n              moves = false;\n            }\n          });\n          if (el.classList.contains('no-drag')) {\n            moves = false;\n          }\n          return moves;\n        },\n        copy: function copy(el) {\n          return el.classList.contains('drag-copy');\n        },\n        accepts: function accepts(el, target) {\n          return !el.contains(target) && !target.classList.contains('no-drop');\n        }\n      }).on('drop', function (element, target, source, sibling) {\n        return _this7.onDrop(element, target, source, sibling);\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n      this.dragula = null;\n      if (this.sideBarScroll && Templates.current.clearBuilderSidebarScroll) {\n        Templates.current.clearBuilderSidebarScroll.call(this, this);\n      }\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"getComponentInfo\",\n    value: function getComponentInfo(key, group) {\n      var info; // This is a new component\n\n      if (this.schemas.hasOwnProperty(key)) {\n        info = (0, _utils.fastCloneDeep)(this.schemas[key]);\n      } else if (this.groups.hasOwnProperty(group)) {\n        var groupComponents = this.groups[group].components;\n        if (groupComponents.hasOwnProperty(key)) {\n          info = (0, _utils.fastCloneDeep)(groupComponents[key].schema);\n        }\n      } else if (group.slice(0, group.indexOf('-')) === 'resource') {\n        // This is an existing resource field.\n        var resourceGroups = this.groups.resource.subgroups;\n        var resourceGroup = _lodash.default.find(resourceGroups, {\n          key: group\n        });\n        if (resourceGroup && resourceGroup.components.hasOwnProperty(\"component-\".concat(key))) {\n          info = (0, _utils.fastCloneDeep)(resourceGroup.components[\"component-\".concat(key)].schema);\n        }\n      } else if (group === 'searchFields') {\n        //Search components go into this group\n        var _resourceGroups = this.groups.resource.subgroups;\n        for (var ix = 0; ix < _resourceGroups.length; ix++) {\n          var _resourceGroup = _resourceGroups[ix];\n          if (_resourceGroup.components.hasOwnProperty(\"component-\".concat(key))) {\n            info = (0, _utils.fastCloneDeep)(_resourceGroup.components[\"component-\".concat(key)].schema);\n            break;\n          }\n        }\n      }\n      if (info) {\n        info.key = this.generateKey(info);\n      }\n      return info;\n    }\n  }, {\n    key: \"getComponentsPath\",\n    value: function getComponentsPath(component, parent) {\n      // Get path to the component in the parent component.\n      var path = 'components';\n      var columnIndex = 0;\n      var tableRowIndex = 0;\n      var tableColumnIndex = 0;\n      var tabIndex = 0;\n      switch (parent.type) {\n        case 'table':\n          tableRowIndex = _lodash.default.findIndex(parent.rows, function (row) {\n            return row.some(function (column) {\n              return column.components.some(function (comp) {\n                return comp.key === component.key;\n              });\n            });\n          });\n          tableColumnIndex = _lodash.default.findIndex(parent.rows[tableRowIndex], function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"rows[\".concat(tableRowIndex, \"][\").concat(tableColumnIndex, \"].components\");\n          break;\n        case 'columns':\n          columnIndex = _lodash.default.findIndex(parent.columns, function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"columns[\".concat(columnIndex, \"].components\");\n          break;\n        case 'tabs':\n          tabIndex = _lodash.default.findIndex(parent.components, function (tab) {\n            return tab.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"components[\".concat(tabIndex, \"].components\");\n          break;\n      }\n      return path;\n    }\n    /* eslint-disable max-statements */\n  }, {\n    key: \"onDrop\",\n    value: function onDrop(element, target, source, sibling) {\n      var _this$groups$group,\n        _this8 = this;\n      if (!target) {\n        return;\n      } // If you try to drop within itself.\n\n      if (element.contains(target)) {\n        return;\n      }\n      var key = element.getAttribute('data-key');\n      var type = element.getAttribute('data-type');\n      var group = element.getAttribute('data-group');\n      var info, isNew, path, index;\n      if (key && group) {\n        // This is a new component.\n        info = this.getComponentInfo(key, group);\n        if (!info && type) {\n          info = this.getComponentInfo(type, group);\n        }\n        isNew = true;\n      } else if (source.formioContainer) {\n        index = _lodash.default.findIndex(source.formioContainer, {\n          key: element.formioComponent.component.key\n        });\n        if (index !== -1) {\n          // Grab and remove the component from the source container.\n          info = source.formioContainer.splice(_lodash.default.findIndex(source.formioContainer, {\n            key: element.formioComponent.component.key\n          }), 1); // Since splice returns an array of one object, we need to destructure it.\n\n          info = info[0];\n        }\n      } // If we haven't found the component, stop.\n\n      if (!info) {\n        return;\n      } // Show an error if siblings are disabled for a component and such a component already exists.\n\n      var compKey = group === 'resource' ? \"component-\".concat(key) : key;\n      var draggableComponent = ((_this$groups$group = this.groups[group]) === null || _this$groups$group === void 0 ? void 0 : _this$groups$group.components[compKey]) || {};\n      if (draggableComponent.disableSiblings) {\n        var isCompAlreadyExists = false;\n        (0, _formUtils.eachComponent)(this.webform.components, function (component) {\n          if (component.type === draggableComponent.schema.type) {\n            isCompAlreadyExists = true;\n            return;\n          }\n        }, true);\n        if (isCompAlreadyExists) {\n          this.webform.redraw();\n          this.webform.setAlert('danger', \"You cannot add more than one \".concat(draggableComponent.key, \" component to one page.\"));\n          return;\n        }\n      }\n      if (target !== source) {\n        // Ensure the key remains unique in its new container.\n        _builder.default.uniquify(this.findNamespaceRoot(target.formioComponent), info);\n      }\n      var parent = target.formioComponent; // Insert in the new container.\n\n      if (target.formioContainer) {\n        if (sibling) {\n          if (!sibling.getAttribute('data-noattach')) {\n            index = _lodash.default.findIndex(target.formioContainer, {\n              key: _lodash.default.get(sibling, 'formioComponent.component.key')\n            });\n            index = index === -1 ? 0 : index;\n          } else {\n            index = sibling.getAttribute('data-position');\n          }\n          if (index !== -1) {\n            target.formioContainer.splice(index, 0, info);\n          }\n        } else {\n          target.formioContainer.push(info);\n        }\n        path = this.getComponentsPath(info, parent.component);\n        index = _lodash.default.findIndex(_lodash.default.get(parent.schema, path), {\n          key: info.key\n        });\n        if (index === -1) {\n          index = 0;\n        }\n      }\n      if (parent && parent.addChildComponent) {\n        parent.addChildComponent(info, element, target, source, sibling);\n      }\n      var componentInDataGrid = parent.type === 'datagrid';\n      if (isNew && !this.options.noNewEdit && !info.noNewEdit) {\n        this.editComponent(info, target, isNew, null, null, {\n          inDataGrid: componentInDataGrid\n        });\n      } // Only rebuild the parts needing to be rebuilt.\n\n      var rebuild;\n      if (target !== source) {\n        if (source.formioContainer && source.contains(target)) {\n          rebuild = source.formioComponent.rebuild();\n        } else if (target.contains(source)) {\n          rebuild = target.formioComponent.rebuild();\n        } else {\n          if (source.formioContainer) {\n            rebuild = source.formioComponent.rebuild();\n          }\n          rebuild = target.formioComponent.rebuild();\n        }\n      } else {\n        // If they are the same, only rebuild one.\n        rebuild = target.formioComponent.rebuild();\n      }\n      if (!rebuild) {\n        rebuild = _nativePromiseOnly.default.resolve();\n      }\n      return rebuild.then(function () {\n        _this8.emit('addComponent', info, parent, path, index, isNew && !_this8.options.noNewEdit && !info.noNewEdit);\n        if (!isNew || _this8.options.noNewEdit || info.noNewEdit) {\n          _this8.emit('change', _this8.form);\n        }\n      });\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form) {\n      var _this9 = this;\n      if (!form.components) {\n        form.components = [];\n      }\n      var isShowSubmitButton = !this.options.noDefaultSubmitButton && !form.components.length; // Ensure there is at least a submit button.\n\n      if (isShowSubmitButton) {\n        form.components.push({\n          type: 'button',\n          label: 'Submit',\n          key: 'submit',\n          size: 'md',\n          block: false,\n          action: 'submit',\n          disableOnInvalid: true,\n          theme: 'primary'\n        });\n      }\n      if (this.webform) {\n        var shouldRebuild = !this.webform.form.components || form.components.length !== this.webform.form.components.length;\n        return this.webform.setForm(form, {\n          keepAsReference: true\n        }).then(function () {\n          if (_this9.refs.form) {\n            _this9.builderHeight = _this9.refs.form.offsetHeight;\n          }\n          if (!shouldRebuild) {\n            return _this9.form;\n          }\n          return _this9.rebuild().then(function () {\n            return _this9.form;\n          });\n        });\n      }\n      return _nativePromiseOnly.default.resolve(form);\n    }\n  }, {\n    key: \"populateRecaptchaSettings\",\n    value: function populateRecaptchaSettings(form) {\n      //populate isEnabled for recaptcha form settings\n      var isRecaptchaEnabled = false;\n      if (this.form.components) {\n        (0, _formUtils.eachComponent)(form.components, function (component) {\n          if (isRecaptchaEnabled) {\n            return;\n          }\n          if (component.type === 'recaptcha') {\n            isRecaptchaEnabled = true;\n            return false;\n          }\n        });\n        if (isRecaptchaEnabled) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', true);\n        } else if (_lodash.default.get(form, 'settings.recaptcha.isEnabled')) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', false);\n        }\n      }\n    }\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, parent, original) {\n      var _this10 = this;\n      if (!parent) {\n        return;\n      }\n      var remove = true;\n      var removingComponentsGroup = !component.skipRemoveConfirm && (Array.isArray(component.components) && component.components.length || Array.isArray(component.rows) && component.rows.length || Array.isArray(component.columns) && component.columns.length);\n      if (this.options.alwaysConfirmComponentRemoval || removingComponentsGroup) {\n        var message = removingComponentsGroup ? 'Removing this component will also remove all of its children. Are you sure you want to do this?' : 'Are you sure you want to remove this component?';\n        remove = window.confirm(this.t(message));\n      }\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n      var index = parent.formioContainer ? parent.formioContainer.indexOf(original) : 0;\n      if (remove && index !== -1) {\n        var path = this.getComponentsPath(component, parent.formioComponent.component);\n        if (parent.formioContainer) {\n          parent.formioContainer.splice(index, 1);\n        } else if (parent.formioComponent && parent.formioComponent.removeChildComponent) {\n          parent.formioComponent.removeChildComponent(component);\n        }\n        var rebuild = parent.formioComponent.rebuild() || _nativePromiseOnly.default.resolve();\n        rebuild.then(function () {\n          _this10.emit('removeComponent', component, parent.formioComponent.schema, path, index);\n          _this10.emit('change', _this10.form);\n        });\n      }\n      return remove;\n    }\n  }, {\n    key: \"replaceDoubleQuotes\",\n    value: function replaceDoubleQuotes(data) {\n      var fieldsToRemoveDoubleQuotes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      if (data) {\n        fieldsToRemoveDoubleQuotes.forEach(function (key) {\n          if (data[key]) {\n            data[key] = data[key].replace(/\"/g, \"'\");\n          }\n        });\n        return data;\n      }\n    }\n  }, {\n    key: \"updateComponent\",\n    value: function updateComponent(component, changed) {\n      var _this11 = this;\n\n      // Update the preview.\n      if (this.preview) {\n        this.preview.form = {\n          components: [_lodash.default.omit(_objectSpread({}, component), ['hidden', 'conditional', 'calculateValue', 'logic', 'autofocus', 'customConditional'])],\n          config: this.options.formConfig || {}\n        };\n        var fieldsToRemoveDoubleQuotes = ['label', 'tooltip', 'placeholder'];\n        this.preview.form.components.forEach(function (component) {\n          return _this11.replaceDoubleQuotes(component, fieldsToRemoveDoubleQuotes);\n        });\n        var previewElement = this.componentEdit.querySelector('[ref=\"preview\"]');\n        if (previewElement) {\n          this.setContent(previewElement, this.preview.render());\n          this.preview.attach(previewElement);\n        }\n      } // Change the \"default value\" field to be reflective of this component.\n\n      var defaultValueComponent = (0, _formUtils.getComponent)(this.editForm.components, 'defaultValue', true);\n      if (defaultValueComponent && component.type !== 'hidden') {\n        var defaultChanged = changed && (changed.component && changed.component.key === 'defaultValue' || changed.instance && defaultValueComponent.hasComponent && defaultValueComponent.hasComponent(changed.instance));\n        if (!defaultChanged) {\n          _lodash.default.assign(defaultValueComponent.component, _lodash.default.omit(_objectSpread({}, component), ['key', 'label', 'placeholder', 'tooltip', 'hidden', 'autofocus', 'validate', 'disabled', 'defaultValue', 'customDefaultValue', 'calculateValue', 'conditional', 'customConditional', 'id']));\n          var parentComponent = defaultValueComponent.parent;\n          var tabIndex = -1;\n          var index = -1;\n          parentComponent.tabs.some(function (tab, tIndex) {\n            tab.some(function (comp, compIndex) {\n              if (comp.id === defaultValueComponent.id) {\n                tabIndex = tIndex;\n                index = compIndex;\n                return true;\n              }\n              return false;\n            });\n          });\n          if (tabIndex !== -1 && index !== -1 && changed && changed.value) {\n            var sibling = parentComponent.tabs[tabIndex][index + 1];\n            parentComponent.removeComponent(defaultValueComponent);\n            var newComp = parentComponent.addComponent(defaultValueComponent.component, defaultValueComponent.data, sibling);\n            _lodash.default.pull(newComp.validators, 'required');\n            parentComponent.tabs[tabIndex].splice(index, 1, newComp);\n            newComp.checkValidity = function () {\n              return true;\n            };\n            newComp.build(defaultValueComponent.element);\n          }\n        } else {\n          var dataPath = changed.instance._data.key;\n          var path = (0, _utils.getArrayFromComponentPath)(changed.instance.path);\n          path.shift();\n          if (path.length) {\n            path.unshift(component.key);\n            dataPath = (0, _utils.getStringFromComponentPath)(path);\n          }\n          _lodash.default.set(this.preview._data, dataPath, changed.value);\n          _lodash.default.set(this.webform._data, dataPath, changed.value);\n        }\n      } // Called when we update a component.\n\n      this.emit('updateComponent', component);\n    }\n  }, {\n    key: \"findRepeatablePaths\",\n    value: function findRepeatablePaths() {\n      var repeatablePaths = [];\n      var keys = new Map();\n      (0, _formUtils.eachComponent)(this.form.components, function (comp, path) {\n        if (!comp.key) {\n          return;\n        }\n        if (keys.has(comp.key)) {\n          if (keys.get(comp.key).includes(path)) {\n            repeatablePaths.push(path);\n          } else {\n            keys.set(comp.key, [].concat(_toConsumableArray(keys.get(comp.key)), [path]));\n          }\n        } else {\n          keys.set(comp.key, [path]);\n        }\n      }, true);\n      return repeatablePaths;\n    }\n  }, {\n    key: \"highlightInvalidComponents\",\n    value: function highlightInvalidComponents() {\n      var repeatablePaths = this.findRepeatablePaths();\n      var hasInvalidComponents = false;\n      this.webform.everyComponent(function (comp) {\n        var _comp$error, _comp$error$message;\n        var path = comp.path;\n        if (repeatablePaths.includes(path)) {\n          comp.setCustomValidity(\"API Key is not unique: \".concat(comp.key));\n          hasInvalidComponents = true;\n        } else if ((_comp$error = comp.error) !== null && _comp$error !== void 0 && (_comp$error$message = _comp$error.message) !== null && _comp$error$message !== void 0 && _comp$error$message.startsWith('API Key is not unique')) {\n          comp.setCustomValidity('');\n        }\n      });\n      this.emit('builderFormValidityChange', hasInvalidComponents);\n    }\n    /**\n     * Called when a new component is saved.\n     *\n     * @param parent\n     * @param component\n     * @return {boolean}\n     */\n  }, {\n    key: \"saveComponent\",\n    value: function saveComponent(component, parent, isNew, original) {\n      var _this12 = this;\n      this.editForm.detach();\n      var parentContainer = parent ? parent.formioContainer : this.container;\n      var parentComponent = parent ? parent.formioComponent : this;\n      this.dialog.close();\n      var path = parentContainer ? this.getComponentsPath(component, parentComponent.component) : '';\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n      var index = parentContainer ? parentContainer.indexOf(original) : 0;\n      if (index !== -1) {\n        var submissionData = this.editForm.submission.data;\n        submissionData = submissionData.componentJson || submissionData;\n        var fieldsToRemoveDoubleQuotes = ['label', 'tooltip', 'placeholder'];\n        this.replaceDoubleQuotes(submissionData, fieldsToRemoveDoubleQuotes);\n        this.hook('beforeSaveComponentSettings', submissionData);\n        var comp = null;\n        parentComponent.getComponents().forEach(function (component) {\n          if (component.component.key === original.key) {\n            comp = component;\n          }\n        });\n        var originalComp = comp.component;\n        var originalComponentSchema = comp.schema;\n        var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n        if (parentContainer && !isParentSaveChildMethod) {\n          parentContainer[index] = submissionData;\n          if (comp) {\n            comp.component = submissionData;\n          }\n        } else if (isParentSaveChildMethod) {\n          parent.formioComponent.saveChildComponent(submissionData);\n        }\n        var rebuild = parentComponent.rebuild() || _nativePromiseOnly.default.resolve();\n        return rebuild.then(function () {\n          var schema = parentContainer ? parentContainer[index] : comp ? comp.schema : [];\n          _this12.emitSaveComponentEvent(schema, originalComp, parentComponent.schema, path, index, isNew, originalComponentSchema);\n          _this12.emit('change', _this12.form);\n          _this12.highlightInvalidComponents();\n        });\n      }\n      this.highlightInvalidComponents();\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"emitSaveComponentEvent\",\n    value: function emitSaveComponentEvent(schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema) {\n      this.emit('saveComponent', schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema);\n    }\n  }, {\n    key: \"editComponent\",\n    value: function editComponent(component, parent, isNew, isJsonEdit, original) {\n      var _this13 = this;\n      var flags = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n      if (!component.key) {\n        return;\n      }\n      var saved = false;\n      var componentCopy = (0, _utils.fastCloneDeep)(component);\n      var ComponentClass = _Components.default.components[componentCopy.type];\n      var isCustom = ComponentClass === undefined;\n      isJsonEdit = isJsonEdit || isCustom;\n      ComponentClass = isCustom ? _Components.default.components.unknown : ComponentClass; // Make sure we only have one dialog open at a time.\n\n      if (this.dialog) {\n        this.dialog.close();\n        this.highlightInvalidComponents();\n      } // This is the render step.\n\n      var editFormOptions = _lodash.default.clone(_lodash.default.get(this, 'options.editForm', {}));\n      if (this.editForm) {\n        this.editForm.destroy();\n      } // Allow editForm overrides per component.\n\n      var overrides = _lodash.default.get(this.options, \"editForm.\".concat(componentCopy.type), {}); // Pass along the form being edited.\n\n      editFormOptions.editForm = this.form;\n      editFormOptions.editComponent = component;\n      editFormOptions.flags = flags;\n      this.hook('editComponentParentInstance', editFormOptions, parent);\n      this.editForm = new _Webform.default(_objectSpread(_objectSpread({}, _lodash.default.omit(this.options, ['hooks', 'builder', 'events', 'attachMode', 'skipInit'])), {}, {\n        language: this.options.language\n      }, editFormOptions));\n      this.hook('editFormProperties', parent);\n      this.editForm.form = isJsonEdit && !isCustom ? {\n        components: [{\n          type: 'textarea',\n          as: 'json',\n          editor: 'ace',\n          weight: 10,\n          input: true,\n          key: 'componentJson',\n          label: 'Component JSON',\n          tooltip: 'Edit the JSON for this component.'\n        }, {\n          type: 'checkbox',\n          key: 'showFullSchema',\n          label: 'Full Schema'\n        }]\n      } : ComponentClass.editForm(_lodash.default.cloneDeep(overrides));\n      var instanceOptions = {};\n      this.hook('instanceOptionsPreview', instanceOptions);\n      var instance = new ComponentClass(componentCopy, instanceOptions);\n      var schema = this.hook('builderComponentSchema', component, instance);\n      this.editForm.submission = isJsonEdit ? {\n        data: {\n          componentJson: schema,\n          showFullSchema: this.options.showFullJsonSchema\n        }\n      } : {\n        data: instance.component\n      };\n      if (this.preview) {\n        this.preview.destroy();\n      }\n      if (!ComponentClass.builderInfo.hasOwnProperty('preview') || ComponentClass.builderInfo.preview) {\n        this.preview = new _Webform.default(_lodash.default.omit(_objectSpread(_objectSpread({}, this.options), {}, {\n          preview: true\n        }), ['hooks', 'builder', 'events', 'attachMode', 'calculateValue']));\n        this.hook('previewFormSettitngs', schema, isJsonEdit);\n      }\n      this.componentEdit = this.ce('div', {\n        'class': 'component-edit-container'\n      });\n      this.setContent(this.componentEdit, this.renderTemplate('builderEditForm', {\n        componentInfo: ComponentClass.builderInfo,\n        editForm: this.editForm.render(),\n        preview: this.preview ? this.preview.render() : false,\n        helplinks: this.helplinks\n      }));\n      this.dialog = this.createModal(this.componentEdit, _lodash.default.get(this.options, 'dialogAttr', {})); // This is the attach step.\n\n      this.editForm.attach(this.componentEdit.querySelector('[ref=\"editForm\"]'));\n      this.hook('editFormWrapper');\n      this.updateComponent(componentCopy);\n      this.editForm.on('change', function (event) {\n        if (event.changed) {\n          if (event.changed.component && event.changed.component.key === 'showFullSchema') {\n            var value = event.changed.value;\n            _this13.editForm.submission = {\n              data: {\n                componentJson: value ? instance.component : component,\n                showFullSchema: value\n              }\n            };\n            return;\n          } // See if this is a manually modified key. Treat custom component keys as manually modified\n\n          if (event.changed.component && event.changed.component.key === 'key' || isJsonEdit) {\n            componentCopy.keyModified = true;\n          }\n          var isComponentLabelChanged = false;\n          if (event.changed.instance) {\n            isComponentLabelChanged = ['label', 'title'].includes(event.changed.instance.path);\n          } else if (event.changed.component) {\n            isComponentLabelChanged = ['label', 'title'].includes(event.changed.component.key);\n          }\n          if (isComponentLabelChanged) {\n            // Ensure this component has a key.\n            if (isNew) {\n              if (!event.data.keyModified) {\n                _this13.editForm.everyComponent(function (component) {\n                  if (component.key === 'key' && component.parent.component.key === 'tabs') {\n                    component.setValue(_this13.updateComponentKey(event.data));\n                    return false;\n                  }\n                });\n              }\n              if (_this13.form) {\n                var formComponents = _this13.findNamespaceRoot(parent.formioComponent); // excluding component which key uniqueness is to be checked to prevent the comparing of the same keys\n\n                formComponents = formComponents.filter(function (comp) {\n                  return editFormOptions.editComponent.id !== comp.id;\n                }); // Set a unique key for this component.\n\n                _builder.default.uniquify(formComponents, event.data);\n              }\n            }\n          } // Update the component.\n\n          _this13.updateComponent(event.data.componentJson || event.data, event.changed);\n        }\n      });\n      var cancelButtons = this.componentEdit.querySelectorAll('[ref=\"cancelButton\"]');\n      cancelButtons.forEach(function (cancelButton) {\n        _this13.addEventListener(cancelButton, 'click', function (event) {\n          event.preventDefault();\n          _this13.editForm.detach();\n          _this13.emit('cancelComponent', component);\n          _this13.dialog.close();\n          _this13.highlightInvalidComponents();\n        });\n      });\n      var removeButtons = this.componentEdit.querySelectorAll('[ref=\"removeButton\"]');\n      removeButtons.forEach(function (removeButton) {\n        _this13.addEventListener(removeButton, 'click', function (event) {\n          event.preventDefault(); // Since we are already removing the component, don't trigger another remove.\n\n          saved = true;\n          _this13.editForm.detach();\n          _this13.removeComponent(component, parent, original);\n          _this13.dialog.close();\n          _this13.highlightInvalidComponents();\n        });\n      });\n      var saveButtons = this.componentEdit.querySelectorAll('[ref=\"saveButton\"]');\n      saveButtons.forEach(function (saveButton) {\n        _this13.addEventListener(saveButton, 'click', function (event) {\n          event.preventDefault();\n          if (!_this13.editForm.checkValidity(_this13.editForm.data, true, _this13.editForm.data)) {\n            _this13.editForm.setPristine(false);\n            _this13.editForm.showErrors();\n            return false;\n          }\n          saved = true;\n          _this13.saveComponent(component, parent, isNew, original);\n        });\n      });\n      var dialogClose = function dialogClose() {\n        _this13.editForm.destroy(true);\n        if (_this13.preview) {\n          _this13.preview.destroy(true);\n          _this13.preview = null;\n        }\n        if (isNew && !saved) {\n          _this13.removeComponent(component, parent, original);\n          _this13.highlightInvalidComponents();\n        } // Clean up.\n\n        _this13.removeEventListener(_this13.dialog, 'close', dialogClose);\n        _this13.dialog = null;\n      };\n      this.addEventListener(this.dialog, 'close', dialogClose); // Called when we edit a component.\n\n      this.emit('editComponent', component);\n    }\n  }, {\n    key: \"updateComponentKey\",\n    value: function updateComponentKey(data) {\n      return _lodash.default.camelCase(data.title || data.label || data.placeholder || data.type).replace(/^[0-9]*/, '');\n    }\n    /**\n     * Creates copy of component schema and stores it under sessionStorage.\n     * @param {Component} component\n     * @return {*}\n     */\n  }, {\n    key: \"copyComponent\",\n    value: function copyComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n      this.addClass(this.refs.form, 'builder-paste-mode');\n      window.sessionStorage.setItem('formio.clipboard', JSON.stringify(component.schema));\n    }\n    /**\n     * Paste copied component after the current component.\n     * @param {Component} component\n     * @return {*}\n     */\n  }, {\n    key: \"pasteComponent\",\n    value: function pasteComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n      this.removeClass(this.refs.form, 'builder-paste-mode');\n      if (window.sessionStorage) {\n        var data = window.sessionStorage.getItem('formio.clipboard');\n        if (data) {\n          var schema = JSON.parse(data);\n          var parent = this.getParentElement(component.element);\n          if (parent) {\n            _builder.default.uniquify(this.findNamespaceRoot(parent.formioComponent), schema);\n            var path = '';\n            var index = 0;\n            var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n            if (parent.formioContainer && !isParentSaveChildMethod) {\n              index = parent.formioContainer.indexOf(component.component);\n              path = this.getComponentsPath(schema, parent.formioComponent.component);\n              parent.formioContainer.splice(index + 1, 0, schema);\n            } else if (isParentSaveChildMethod) {\n              parent.formioComponent.saveChildComponent(schema, false);\n            }\n            parent.formioComponent.rebuild();\n            this.emitSaveComponentEvent(schema, schema, parent.formioComponent.component, path, index + 1, true, schema);\n          }\n          this.emit('change', this.form);\n        }\n      }\n    }\n  }, {\n    key: \"isParentSaveChildMethod\",\n    value: function isParentSaveChildMethod(parentComp) {\n      return !!(parentComp && parentComp.saveChildComponent);\n    }\n  }, {\n    key: \"getParentElement\",\n    value: function getParentElement(element) {\n      var container = element;\n      do {\n        container = container.parentNode;\n      } while (container && !container.formioComponent);\n      return container;\n    }\n  }, {\n    key: \"addBuilderComponentInfo\",\n    value: function addBuilderComponentInfo(component) {\n      if (!component || !component.group || !this.groups[component.group]) {\n        return;\n      }\n      component = _lodash.default.clone(component);\n      var groupInfo = this.groups[component.group];\n      if (!groupInfo.components.hasOwnProperty(component.key)) {\n        groupInfo.components[component.key] = component;\n      }\n      return component;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      if (this.webform) {\n        this.webform.init();\n      }\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"init\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      if (this.webform.initialized) {\n        this.webform.clear();\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(deleteFromGlobal) {\n      if (this.webform.initialized) {\n        this.webform.destroy(deleteFromGlobal);\n      }\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"destroy\", this).call(this, deleteFromGlobal);\n    }\n  }, {\n    key: \"addBuilderGroup\",\n    value: function addBuilderGroup(name, group) {\n      if (!this.groups[name]) {\n        this.groups[name] = group;\n        this.groupOrder.push(name);\n        this.triggerRedraw();\n      } else {\n        this.updateBuilderGroup(name, group);\n      }\n    }\n  }, {\n    key: \"updateBuilderGroup\",\n    value: function updateBuilderGroup(name, group) {\n      if (this.groups[name]) {\n        this.groups[name] = group;\n        this.triggerRedraw();\n      }\n    }\n  }, {\n    key: \"generateKey\",\n    value: function generateKey(info) {\n      return _lodash.default.camelCase(info.key || info.title || info.label || info.placeholder || info.type);\n    }\n  }]);\n  return WebformBuilder;\n}(_Component2.default);\nexports.default = WebformBuilder;","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_Webform","_interopRequireDefault","_Component2","_tippy","_nativePromiseOnly","_Components","_Formio","_utils","_formUtils","_builder","_lodash","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","Array","from","test","iter","isArray","len","length","i","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_get","Reflect","get","bind","property","receiver","base","_superPropBase","desc","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","Templates","GlobalFormio","dragula","window","WebformBuilder","_Component","_super","_this","element","options","HTMLElement","skipInit","display","builderHeight","schemas","repeatablePaths","sideBarScroll","sideBarScrollOffset","dragDropEnabled","builder","defaultsDeep","defaultGroups","each","config","groups","groupOrder","_loop","group","components","componentOrder","subgroups","map","groupKey","ignore","sort","a","b","weight","type","component","builderInfo","schema","addBuilderComponentInfo","_group","info","compKey","concat","comp","orderComponents","hooks","renderComponent","html","_ref","_self$component","template","hook","replace","disabled","includes","parent","noDragDrop","renderTemplate","disableBuilderActions","childComponent","renderComponents","_ref2","nodrop","position","renderInput","_ref3","renderLoading","_ref4","attachComponents","container","containerElement","querySelector","formioContainer","formioComponent","allowDrop","containers","children","attachDatagrid","loadRefs","dataGridContainer","refs","parentNode","attachComponent","query","params","limit","select","resourceTag","tags","formio","projectUrl","isResourcesDisabled","resource","loadProject","then","project","formConfig","pathToFormConfig","webformConfig","webform","set","catch","err","console","warn","message","noProject","resourceOptions","loadForms","resources","title","addExistingResourceFields","attachMode","createForm","pathComponentsMapping","arrayDataComponentPaths","nestedDataComponents","arrayDataComponents","_this2","index","resourceKey","subgroup","eachComponent","resourceFilter","indexOf","componentName","label","upperFirst","merge","fastCloneDeep","lockKey","noSource","_id","undefined","isNew","triggerRedraw","attachTooltip","allowHTML","trigger","placement","delay","zIndex","content","_this3","removeComponent","editComponent","moveComponent","copyComponent","pasteComponent","editJson","t","addEventListener","pasteToolTip","hide","getParentElement","inDataGrid","isInDataGrid","form","ready","basic","advanced","layout","data","premium","redraw","setForm","findNamespaceRoot","path","getArrayFromComponentPath","getComponent","namespaceKey","recurseNamespace","componentSchema","namespaceComponent","tree","arrayTree","render","_this4","sidebar","scrollEnabled","groupId","id","attach","_this5","on","populateRecaptchaSettings","current","handleBuilderSidebarScroll","sessionStorage","getItem","addClass","bootstrapVersion","style","getAttribute","anchor","clickedParentId","clickedId","groupIndex","openByDefault","groupParent","debounce","searchString","searchFields","initDragula","_this6","searchValue","toLowerCase","sidebarGroups","filterGroupBy","toPlainObject","_result$subgroups","filteredComponents","isMatchedToTitle","match","isMatchedToKey","filterGroupOrder","cloneDeep","filterSubgroups","clone","isNull","toTemplate","innerHTML","join","updateDragAndDrop","groupInfo","foundComponents","isResource","ignoreForForm","_this7","destroy","containersArray","item","moves","el","list","classList","contains","copy","accepts","sibling","onDrop","detach","clearBuilderSidebarScroll","getComponentInfo","groupComponents","resourceGroups","resourceGroup","find","_resourceGroups","ix","_resourceGroup","generateKey","getComponentsPath","columnIndex","tableRowIndex","tableColumnIndex","tabIndex","findIndex","rows","row","some","column","columns","tab","_this$groups$group","_this8","splice","draggableComponent","disableSiblings","isCompAlreadyExists","setAlert","uniquify","addChildComponent","componentInDataGrid","noNewEdit","rebuild","resolve","emit","_this9","isShowSubmitButton","noDefaultSubmitButton","size","block","action","disableOnInvalid","theme","shouldRebuild","keepAsReference","offsetHeight","isRecaptchaEnabled","original","_this10","remove","removingComponentsGroup","skipRemoveConfirm","alwaysConfirmComponentRemoval","confirm","removeChildComponent","replaceDoubleQuotes","fieldsToRemoveDoubleQuotes","updateComponent","changed","_this11","preview","omit","previewElement","componentEdit","setContent","defaultValueComponent","editForm","defaultChanged","hasComponent","assign","parentComponent","tabs","tIndex","compIndex","newComp","addComponent","pull","validators","checkValidity","build","dataPath","_data","shift","unshift","getStringFromComponentPath","findRepeatablePaths","Map","has","highlightInvalidComponents","hasInvalidComponents","everyComponent","_comp$error","_comp$error$message","setCustomValidity","error","startsWith","saveComponent","_this12","parentContainer","dialog","close","submissionData","submission","componentJson","getComponents","originalComp","originalComponentSchema","isParentSaveChildMethod","saveChildComponent","emitSaveComponentEvent","parentComponentSchema","isJsonEdit","_this13","flags","saved","componentCopy","ComponentClass","isCustom","unknown","editFormOptions","overrides","language","as","editor","input","tooltip","instanceOptions","showFullSchema","showFullJsonSchema","ce","componentInfo","helplinks","createModal","event","keyModified","isComponentLabelChanged","setValue","updateComponentKey","formComponents","cancelButtons","querySelectorAll","cancelButton","preventDefault","removeButtons","removeButton","saveButtons","saveButton","setPristine","showErrors","dialogClose","removeEventListener","camelCase","placeholder","setItem","JSON","stringify","removeClass","parse","parentComp","init","clear","initialized","deleteFromGlobal","addBuilderGroup","updateBuilderGroup"],"sources":["D:/task/node_modules/formiojs/WebformBuilder.js"],"sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.array.sort.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nrequire(\"core-js/modules/es.string.match.js\");\n\nrequire(\"core-js/modules/es.array.join.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.map.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.string.starts-with.js\");\n\nrequire(\"core-js/modules/es.regexp.flags.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _Webform = _interopRequireDefault(require(\"./Webform\"));\n\nvar _Component2 = _interopRequireDefault(require(\"./components/_classes/component/Component\"));\n\nvar _tippy = _interopRequireDefault(require(\"tippy.js\"));\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _Components = _interopRequireDefault(require(\"./components/Components\"));\n\nvar _Formio = require(\"./Formio\");\n\nvar _utils = require(\"./utils/utils\");\n\nvar _formUtils = require(\"./utils/formUtils\");\n\nvar _builder = _interopRequireDefault(require(\"./utils/builder\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get.bind(); } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nrequire('./components/builder');\n\nvar Templates = _Formio.GlobalFormio.Templates;\n\nif (!Templates) {\n  Templates = require('./templates/Templates').default;\n}\n\nvar dragula;\n\nif (typeof window !== 'undefined') {\n  // Import from \"dist\" because it would require and \"global\" would not be defined in Angular apps.\n  dragula = require('dragula/dist/dragula');\n}\n\nvar WebformBuilder = /*#__PURE__*/function (_Component) {\n  _inherits(WebformBuilder, _Component);\n\n  var _super = _createSuper(WebformBuilder);\n\n  // eslint-disable-next-line max-statements\n  function WebformBuilder() {\n    var _this;\n\n    _classCallCheck(this, WebformBuilder);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    } // Reset skipInit in case PDFBuilder has set it.\n\n\n    options.skipInit = false;\n    options.display = options.display || 'form';\n    _this = _super.call(this, null, options);\n    _this.element = element;\n    _this.builderHeight = 0;\n    _this.schemas = {};\n    _this.repeatablePaths = [];\n    _this.sideBarScroll = _lodash.default.get(_this.options, 'sideBarScroll', true);\n    _this.sideBarScrollOffset = _lodash.default.get(_this.options, 'sideBarScrollOffset', 0);\n    _this.dragDropEnabled = true; // Setup the builder options.\n\n    _this.builder = _lodash.default.defaultsDeep({}, _this.options.builder, _this.defaultGroups); // Turn off if explicitely said to do so...\n\n    _lodash.default.each(_this.defaultGroups, function (config, key) {\n      if (config === false) {\n        _this.builder[key] = false;\n      }\n    }); // Add the groups.\n\n\n    _this.groups = {};\n    _this.groupOrder = [];\n\n    var _loop = function _loop(group) {\n      if (_this.builder[group]) {\n        _this.builder[group].key = group;\n        _this.groups[group] = _this.builder[group];\n        _this.groups[group].components = _this.groups[group].components || {};\n        _this.groups[group].componentOrder = _this.groups[group].componentOrder || [];\n        _this.groups[group].subgroups = Object.keys(_this.groups[group].groups || {}).map(function (groupKey) {\n          _this.groups[group].groups[groupKey].componentOrder = Object.keys(_this.groups[group].groups[groupKey].components).map(function (key) {\n            return key;\n          });\n          return _this.groups[group].groups[groupKey];\n        });\n\n        _this.groupOrder.push(_this.groups[group]);\n      }\n    };\n\n    for (var group in _this.builder) {\n      _loop(group);\n    }\n\n    _this.groupOrder = _this.groupOrder.filter(function (group) {\n      return group && !group.ignore;\n    }).sort(function (a, b) {\n      return a.weight - b.weight;\n    }).map(function (group) {\n      return group.key;\n    });\n\n    for (var type in _Components.default.components) {\n      var component = _Components.default.components[type];\n\n      if (component.builderInfo && component.builderInfo.schema) {\n        _this.schemas[type] = component.builderInfo.schema;\n        component.type = type;\n        var builderInfo = component.builderInfo;\n        builderInfo.key = component.type;\n\n        _this.addBuilderComponentInfo(builderInfo);\n      }\n    } // Filter out any extra components.\n    // Add the components in each group.\n\n\n    for (var _group in _this.groups) {\n      var info = _this.groups[_group];\n\n      for (var key in info.components) {\n        var compKey = _group === 'resource' ? \"component-\".concat(key) : key;\n        var comp = info.components[compKey];\n\n        if (comp === true && _Components.default.components[key] && _Components.default.components[key].builderInfo) {\n          comp = _Components.default.components[key].builderInfo;\n        }\n\n        if (comp && comp.schema) {\n          _this.schemas[key] = comp.schema;\n          info.components[compKey] = comp;\n          info.components[compKey].key = key;\n        } else {\n          // Do not include this component in the components array.\n          delete info.components[compKey];\n        }\n      } // Order the components.\n\n\n      _this.orderComponents(info);\n    }\n\n    _this.options.hooks = _this.options.hooks || {};\n\n    _this.options.hooks.renderComponent = function (html, _ref) {\n      var _self$component;\n\n      var component = _ref.component,\n          self = _ref.self;\n\n      if (self.type === 'form' && !self.key) {\n        var template = _this.hook('renderComponentFormTemplate', html.replace('formio-component-form', '')); // The main webform shouldn't have this class as it adds extra styles.\n\n\n        return template;\n      }\n\n      if (_this.options.disabled && _this.options.disabled.includes(self.key) || self.parent.noDragDrop) {\n        return html;\n      }\n\n      return _this.renderTemplate('builderComponent', {\n        html: html,\n        disableBuilderActions: self === null || self === void 0 ? void 0 : (_self$component = self.component) === null || _self$component === void 0 ? void 0 : _self$component.disableBuilderActions,\n        childComponent: component\n      });\n    };\n\n    _this.options.hooks.renderComponents = function (html, _ref2) {\n      var components = _ref2.components,\n          self = _ref2.self;\n\n      // if Datagrid and already has a component, don't make it droppable.\n      if (self.type === 'datagrid' && components.length > 0 || self.noDragDrop) {\n        return html;\n      }\n\n      if (!components || !components.length && !components.nodrop || self.type === 'form' && components.length <= 1 && (components.length === 0 || components[0].type === 'button')) {\n        html = _this.renderTemplate('builderPlaceholder', {\n          position: 0\n        }) + html;\n      }\n\n      return _this.renderTemplate('builderComponents', {\n        key: self.key,\n        type: self.type,\n        html: html\n      });\n    };\n\n    _this.options.hooks.renderInput = function (html, _ref3) {\n      var self = _ref3.self;\n\n      if (self.type === 'hidden') {\n        return html + self.name;\n      }\n\n      return html;\n    };\n\n    _this.options.hooks.renderLoading = function (html, _ref4) {\n      var self = _ref4.self;\n\n      if (self.type === 'form' && self.key) {\n        return self.name;\n      }\n\n      return html;\n    };\n\n    _this.options.hooks.attachComponents = function (element, components, container, component) {\n      // Don't attach if no element was found or component doesn't participate in drag'n'drop.\n      if (!element) {\n        return;\n      }\n\n      if (component.noDragDrop) {\n        return element;\n      } // Attach container and component to element for later reference.\n\n\n      var containerElement = element.querySelector(\"[ref=\\\"\".concat(component.component.key, \"-container\\\"]\")) || element;\n      containerElement.formioContainer = container;\n      containerElement.formioComponent = component; // Add container to draggable list.\n\n      if (_this.dragula && _this.allowDrop(element)) {\n        _this.dragula.containers.push(containerElement);\n      } // If this is an existing datagrid element, don't make it draggable.\n\n\n      if ((component.type === 'datagrid' || component.type === 'datamap') && components.length > 0) {\n        return element;\n      } // Since we added a wrapper, need to return the original element so that we can find the components inside it.\n\n\n      return element.children[0];\n    };\n\n    _this.options.hooks.attachDatagrid = function (element, component) {\n      component.loadRefs(element, _defineProperty({}, \"\".concat(component.key, \"-container\"), 'single'));\n      var dataGridContainer = component.refs[\"\".concat(component.key, \"-container\")];\n\n      if (dataGridContainer) {\n        component.attachComponents(dataGridContainer.parentNode, [], component.component.components);\n      } // Need to set up horizontal rearrangement of fields.\n\n    };\n\n    _this.options.hooks.attachComponent = _this.attachComponent.bind(_assertThisInitialized(_this)); // Load resources tagged as 'builder'\n\n    var query = {\n      params: {\n        type: 'resource',\n        limit: 1000000,\n        select: '_id,title,name,components'\n      }\n    };\n\n    if (_this.options && _this.options.resourceTag) {\n      query.params.tags = [_this.options.resourceTag];\n    } else if (!_this.options || !_this.options.hasOwnProperty('resourceTag')) {\n      query.params.tags = ['builder'];\n    }\n\n    var formio = new _Formio.GlobalFormio(_Formio.GlobalFormio.projectUrl);\n    var isResourcesDisabled = _this.options.builder && _this.options.builder.resource === false;\n    formio.loadProject().then(function (project) {\n      if (project && (_lodash.default.get(project, 'settings.addConfigToForms', false) || _lodash.default.get(project, 'addConfigToForms', false))) {\n        var config = project.config || {};\n        _this.options.formConfig = config;\n        var pathToFormConfig = 'webform._form.config';\n\n        var webformConfig = _lodash.default.get(_assertThisInitialized(_this), pathToFormConfig);\n\n        if (_this.webform && !webformConfig) {\n          _lodash.default.set(_assertThisInitialized(_this), pathToFormConfig, config);\n        }\n      }\n    }).catch(function (err) {\n      console.warn(\"Could not load project settings: \".concat(err.message || err));\n    });\n\n    if (!formio.noProject && !isResourcesDisabled) {\n      var resourceOptions = _this.options.builder && _this.options.builder.resource;\n      formio.loadForms(query).then(function (resources) {\n        if (resources.length) {\n          _this.builder.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n          _this.groups.resource = {\n            title: resourceOptions ? resourceOptions.title : 'Existing Resource Fields',\n            key: 'resource',\n            weight: resourceOptions ? resourceOptions.weight : 50,\n            subgroups: [],\n            components: [],\n            componentOrder: []\n          };\n\n          if (!_this.groupOrder.includes('resource')) {\n            _this.groupOrder.push('resource');\n          }\n\n          _this.addExistingResourceFields(resources);\n        }\n      });\n    } // Notify components if they need to modify their render.\n\n\n    _this.options.attachMode = 'builder';\n    _this.webform = _this.webform || _this.createForm(_this.options);\n    _this.pathComponentsMapping = {};\n    _this.arrayDataComponentPaths = [];\n    _this.nestedDataComponents = [];\n    _this.arrayDataComponents = [];\n    return _this;\n  }\n\n  _createClass(WebformBuilder, [{\n    key: \"allowDrop\",\n    value: function allowDrop() {\n      return true;\n    }\n  }, {\n    key: \"addExistingResourceFields\",\n    value: function addExistingResourceFields(resources) {\n      var _this2 = this;\n\n      _lodash.default.each(resources, function (resource, index) {\n        var resourceKey = \"resource-\".concat(resource.name);\n        var subgroup = {\n          key: resourceKey,\n          title: resource.title,\n          components: [],\n          componentOrder: [],\n          default: index === 0\n        };\n        (0, _formUtils.eachComponent)(resource.components, function (component) {\n          if (component.type === 'button') return;\n          if (_this2.options && _this2.options.resourceFilter && (!component.tags || component.tags.indexOf(_this2.options.resourceFilter) === -1)) return;\n          var componentName = component.label;\n\n          if (!componentName && component.key) {\n            componentName = _lodash.default.upperFirst(component.key);\n          }\n\n          subgroup.componentOrder.push(\"component-\".concat(component.key));\n          subgroup.components[\"component-\".concat(component.key)] = _lodash.default.merge((0, _utils.fastCloneDeep)(_Components.default.components[component.type] ? _Components.default.components[component.type].builderInfo : _Components.default.components['unknown'].builderInfo), {\n            key: component.key,\n            title: componentName,\n            group: 'resource',\n            subgroup: resourceKey\n          }, {\n            schema: _objectSpread(_objectSpread({}, component), {}, {\n              label: component.label,\n              key: component.key,\n              lockKey: true,\n              source: !_this2.options.noSource ? resource._id : undefined,\n              isNew: true\n            })\n          });\n        }, true);\n\n        _this2.groups.resource.subgroups.push(subgroup);\n      });\n\n      this.triggerRedraw();\n    }\n  }, {\n    key: \"attachTooltip\",\n    value: function attachTooltip(component, title) {\n      return (0, _tippy.default)(component, {\n        allowHTML: true,\n        trigger: 'mouseenter focus',\n        placement: 'top',\n        delay: [200, 0],\n        zIndex: 10000,\n        content: title\n      });\n    }\n  }, {\n    key: \"attachComponent\",\n    value: function attachComponent(element, component) {\n      var _this3 = this;\n\n      // Add component to element for later reference.\n      element.formioComponent = component;\n      component.loadRefs(element, {\n        removeComponent: 'single',\n        editComponent: 'single',\n        moveComponent: 'single',\n        copyComponent: 'single',\n        pasteComponent: 'single',\n        editJson: 'single'\n      });\n\n      if (component.refs.copyComponent) {\n        this.attachTooltip(component.refs.copyComponent, this.t('Copy'));\n        component.addEventListener(component.refs.copyComponent, 'click', function () {\n          return _this3.copyComponent(component);\n        });\n      }\n\n      if (component.refs.pasteComponent) {\n        var pasteToolTip = this.attachTooltip(component.refs.pasteComponent, this.t('Paste below'));\n        component.addEventListener(component.refs.pasteComponent, 'click', function () {\n          pasteToolTip.hide();\n\n          _this3.pasteComponent(component);\n        });\n      }\n\n      if (component.refs.moveComponent) {\n        this.attachTooltip(component.refs.moveComponent, this.t('Move'));\n      }\n\n      var parent = this.getParentElement(element);\n\n      if (component.refs.editComponent) {\n        this.attachTooltip(component.refs.editComponent, this.t('Edit'));\n        component.addEventListener(component.refs.editComponent, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, false, component.component, {\n            inDataGrid: component.isInDataGrid\n          });\n        });\n      }\n\n      if (component.refs.editJson) {\n        this.attachTooltip(component.refs.editJson, this.t('Edit JSON'));\n        component.addEventListener(component.refs.editJson, 'click', function () {\n          return _this3.editComponent(component.schema, parent, false, true, component.component);\n        });\n      }\n\n      if (component.refs.removeComponent) {\n        this.attachTooltip(component.refs.removeComponent, this.t('Remove'));\n        component.addEventListener(component.refs.removeComponent, 'click', function () {\n          return _this3.removeComponent(component.schema, parent, component.component);\n        });\n      }\n\n      return element;\n    }\n  }, {\n    key: \"createForm\",\n    value: function createForm(options) {\n      this.webform = new _Webform.default(this.element, options);\n\n      if (this.element) {\n        this.loadRefs(this.element, {\n          form: 'single'\n        });\n\n        if (this.refs.form) {\n          this.webform.element = this.refs.form;\n        }\n      }\n\n      return this.webform;\n    }\n    /**\n     * Called when everything is ready.\n     *\n     * @returns {Promise} - Wait for webform to be ready.\n     */\n\n  }, {\n    key: \"ready\",\n    get: function get() {\n      return this.webform.ready;\n    }\n  }, {\n    key: \"defaultGroups\",\n    get: function get() {\n      return {\n        basic: {\n          title: 'Basic',\n          weight: 0,\n          default: true\n        },\n        advanced: {\n          title: 'Advanced',\n          weight: 10\n        },\n        layout: {\n          title: 'Layout',\n          weight: 20\n        },\n        data: {\n          title: 'Data',\n          weight: 30\n        },\n        premium: {\n          title: 'Premium',\n          weight: 40\n        }\n      };\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      return _Webform.default.prototype.redraw.call(this);\n    }\n  }, {\n    key: \"form\",\n    get: function get() {\n      return this.webform.form;\n    },\n    set: function set(value) {\n      this.setForm(value);\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.webform.schema;\n    }\n  }, {\n    key: \"container\",\n    get: function get() {\n      return this.webform.form.components;\n    }\n    /**\n     * When a component sets its api key, we need to check if it is unique within its namespace. Find the namespace root\n     * so we can calculate this correctly.\n     * @param component\n     */\n\n  }, {\n    key: \"findNamespaceRoot\",\n    value: function findNamespaceRoot(component) {\n      var path = (0, _utils.getArrayFromComponentPath)(component.path); // First get the component with nested parents.\n\n      var comp = this.webform.getComponent(path);\n      comp = Array.isArray(comp) ? comp[0] : comp;\n      var namespaceKey = this.recurseNamespace(comp); // If there is no key, it is the root form.\n\n      if (!namespaceKey || this.form.key === namespaceKey) {\n        return this.form.components;\n      }\n\n      var componentSchema = component.component; // If the current component is the namespace, we don't need to find it again.\n\n      if (namespaceKey === component.key) {\n        return [].concat(_toConsumableArray(componentSchema.components), [componentSchema]);\n      } // Get the namespace component so we have the original object.\n\n\n      var namespaceComponent = (0, _formUtils.getComponent)(this.form.components, namespaceKey, true);\n      return namespaceComponent ? namespaceComponent.components : comp.components;\n    }\n  }, {\n    key: \"recurseNamespace\",\n    value: function recurseNamespace(component) {\n      // If there is no parent, we are at the root level.\n      if (!component) {\n        return null;\n      } // Some components are their own namespace.\n\n\n      if (['address', 'container', 'datagrid', 'editgrid', 'dynamicWizard', 'tree'].includes(component.type) || component.tree || component.arrayTree) {\n        return component.key;\n      } // Anything else, keep going up.\n\n\n      return this.recurseNamespace(component.parent);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return this.renderTemplate('builder', {\n        sidebar: this.renderTemplate('builderSidebar', {\n          scrollEnabled: this.sideBarScroll,\n          groupOrder: this.groupOrder,\n          groupId: \"builder-sidebar-\".concat(this.id),\n          groups: this.groupOrder.map(function (groupKey) {\n            return _this4.renderTemplate('builderSidebarGroup', {\n              group: _this4.groups[groupKey],\n              groupKey: groupKey,\n              groupId: \"builder-sidebar-\".concat(_this4.id),\n              subgroups: _this4.groups[groupKey].subgroups.map(function (group) {\n                return _this4.renderTemplate('builderSidebarGroup', {\n                  group: group,\n                  groupKey: group.key,\n                  groupId: \"group-container-\".concat(groupKey),\n                  subgroups: []\n                });\n              })\n            });\n          })\n        }),\n        form: this.webform.render()\n      });\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this5 = this;\n\n      this.on('change', function (form) {\n        _this5.populateRecaptchaSettings(form);\n      });\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"attach\", this).call(this, element).then(function () {\n        _this5.loadRefs(element, {\n          form: 'single',\n          sidebar: 'single',\n          'sidebar-search': 'single',\n          'sidebar-groups': 'single',\n          'container': 'multiple',\n          'sidebar-anchor': 'multiple',\n          'sidebar-group': 'multiple',\n          'sidebar-container': 'multiple'\n        });\n\n        if (_this5.sideBarScroll && Templates.current.handleBuilderSidebarScroll) {\n          Templates.current.handleBuilderSidebarScroll.call(_this5, _this5);\n        } // Add the paste status in form\n\n\n        if (typeof window !== 'undefined' && window.sessionStorage) {\n          var data = window.sessionStorage.getItem('formio.clipboard');\n\n          if (data) {\n            _this5.addClass(_this5.refs.form, 'builder-paste-mode');\n          }\n        }\n\n        if (!(0, _utils.bootstrapVersion)(_this5.options)) {\n          // Initialize\n          _this5.refs['sidebar-group'].forEach(function (group) {\n            group.style.display = group.getAttribute('data-default') === 'true' ? 'inherit' : 'none';\n          }); // Click event\n\n\n          _this5.refs['sidebar-anchor'].forEach(function (anchor, index) {\n            _this5.addEventListener(anchor, 'click', function () {\n              var clickedParentId = anchor.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n              var clickedId = anchor.getAttribute('data-target').slice('#group-'.length);\n\n              _this5.refs['sidebar-group'].forEach(function (group, groupIndex) {\n                var openByDefault = group.getAttribute('data-default') === 'true';\n                var groupId = group.getAttribute('id').slice('group-'.length);\n                var groupParent = group.getAttribute('data-parent').slice('#builder-sidebar-'.length);\n                group.style.display = openByDefault && groupParent === clickedId || groupId === clickedParentId || groupIndex === index ? 'inherit' : 'none';\n              });\n            }, true);\n          });\n        }\n\n        _this5.addEventListener(_this5.refs['sidebar-search'], 'input', _lodash.default.debounce(function (e) {\n          var searchString = e.target.value;\n\n          _this5.searchFields(searchString);\n        }, 300));\n\n        if (_this5.dragDropEnabled) {\n          _this5.initDragula();\n        }\n\n        if (_this5.refs.form) {\n          return _this5.webform.attach(_this5.refs.form);\n        }\n      });\n    }\n  }, {\n    key: \"searchFields\",\n    value: function searchFields() {\n      var _this6 = this;\n\n      var searchString = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var searchValue = searchString.toLowerCase();\n      var sidebar = this.refs['sidebar'];\n      var sidebarGroups = this.refs['sidebar-groups'];\n\n      if (!sidebar || !sidebarGroups) {\n        return;\n      }\n\n      var filterGroupBy = function filterGroupBy(group) {\n        var searchValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n        var result = _lodash.default.toPlainObject(group);\n\n        var _result$subgroups = result.subgroups,\n            subgroups = _result$subgroups === void 0 ? [] : _result$subgroups,\n            components = result.components;\n        var filteredComponents = [];\n\n        for (var key in components) {\n          var isMatchedToTitle = components[key].title.toLowerCase().match(searchValue);\n          var isMatchedToKey = components[key].key.toLowerCase().match(searchValue);\n\n          if (isMatchedToTitle || isMatchedToKey) {\n            filteredComponents.push(components[key]);\n          }\n        }\n\n        _this6.orderComponents(result, filteredComponents);\n\n        if (searchValue) {\n          result.default = true;\n        }\n\n        if (result.componentOrder.length || subgroups.length) {\n          return result;\n        }\n\n        return null;\n      };\n\n      var filterGroupOrder = function filterGroupOrder(groupOrder, searchValue) {\n        var result = _lodash.default.cloneDeep(groupOrder);\n\n        return result.filter(function (key) {\n          return filterGroupBy(_this6.groups[key], searchValue);\n        });\n      };\n\n      var filterSubgroups = function filterSubgroups(groups, searchValue) {\n        var result = _lodash.default.clone(groups);\n\n        return result.map(function (subgroup) {\n          return filterGroupBy(subgroup, searchValue);\n        }).filter(function (subgroup) {\n          return !_lodash.default.isNull(subgroup);\n        });\n      };\n\n      var toTemplate = function toTemplate(groupKey) {\n        return {\n          group: filterGroupBy(_this6.groups[groupKey], searchValue),\n          groupKey: groupKey,\n          groupId: sidebar.id || sidebarGroups.id,\n          subgroups: filterSubgroups(_this6.groups[groupKey].subgroups, searchValue).map(function (group) {\n            return _this6.renderTemplate('builderSidebarGroup', {\n              group: group,\n              groupKey: group.key,\n              groupId: \"group-container-\".concat(groupKey),\n              subgroups: []\n            });\n          })\n        };\n      };\n\n      sidebarGroups.innerHTML = filterGroupOrder(this.groupOrder, searchValue).map(function (groupKey) {\n        return _this6.renderTemplate('builderSidebarGroup', toTemplate(groupKey));\n      }).join('');\n      this.loadRefs(this.element, {\n        'sidebar-groups': 'single',\n        'sidebar-anchor': 'multiple',\n        'sidebar-group': 'multiple',\n        'sidebar-container': 'multiple'\n      });\n      this.updateDragAndDrop();\n\n      if (searchValue === '') {\n        this.triggerRedraw();\n      }\n    }\n  }, {\n    key: \"orderComponents\",\n    value: function orderComponents(groupInfo, foundComponents) {\n      var components = foundComponents || groupInfo.components;\n      var isResource = groupInfo.key.indexOf('resource-') === 0;\n\n      if (components) {\n        groupInfo.componentOrder = Object.keys(components).map(function (key) {\n          return components[key];\n        }).filter(function (component) {\n          return component && !component.ignore && !component.ignoreForForm;\n        }).sort(function (a, b) {\n          return a.weight - b.weight;\n        }).map(function (component) {\n          return isResource ? \"component-\".concat(component.key) : component.key;\n        });\n      }\n    }\n  }, {\n    key: \"updateDragAndDrop\",\n    value: function updateDragAndDrop() {\n      if (this.dragDropEnabled) {\n        this.initDragula();\n      }\n\n      if (this.refs.form) {\n        return this.webform.attach(this.refs.form);\n      }\n    }\n  }, {\n    key: \"initDragula\",\n    value: function initDragula() {\n      var _this7 = this;\n\n      var options = this.options;\n\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n\n      var containersArray = Array.prototype.slice.call(this.refs['sidebar-container']).filter(function (item) {\n        return item.id !== 'group-container-resource';\n      });\n\n      if (!dragula) {\n        return;\n      }\n\n      this.dragula = dragula(containersArray, {\n        moves: function moves(el) {\n          var moves = true;\n          var list = Array.from(el.classList).filter(function (item) {\n            return item.indexOf('formio-component-') === 0;\n          });\n          list.forEach(function (item) {\n            var key = item.slice('formio-component-'.length);\n\n            if (options.disabled && options.disabled.includes(key)) {\n              moves = false;\n            }\n          });\n\n          if (el.classList.contains('no-drag')) {\n            moves = false;\n          }\n\n          return moves;\n        },\n        copy: function copy(el) {\n          return el.classList.contains('drag-copy');\n        },\n        accepts: function accepts(el, target) {\n          return !el.contains(target) && !target.classList.contains('no-drop');\n        }\n      }).on('drop', function (element, target, source, sibling) {\n        return _this7.onDrop(element, target, source, sibling);\n      });\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      if (this.dragula) {\n        this.dragula.destroy();\n      }\n\n      this.dragula = null;\n\n      if (this.sideBarScroll && Templates.current.clearBuilderSidebarScroll) {\n        Templates.current.clearBuilderSidebarScroll.call(this, this);\n      }\n\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"detach\", this).call(this);\n    }\n  }, {\n    key: \"getComponentInfo\",\n    value: function getComponentInfo(key, group) {\n      var info; // This is a new component\n\n      if (this.schemas.hasOwnProperty(key)) {\n        info = (0, _utils.fastCloneDeep)(this.schemas[key]);\n      } else if (this.groups.hasOwnProperty(group)) {\n        var groupComponents = this.groups[group].components;\n\n        if (groupComponents.hasOwnProperty(key)) {\n          info = (0, _utils.fastCloneDeep)(groupComponents[key].schema);\n        }\n      } else if (group.slice(0, group.indexOf('-')) === 'resource') {\n        // This is an existing resource field.\n        var resourceGroups = this.groups.resource.subgroups;\n\n        var resourceGroup = _lodash.default.find(resourceGroups, {\n          key: group\n        });\n\n        if (resourceGroup && resourceGroup.components.hasOwnProperty(\"component-\".concat(key))) {\n          info = (0, _utils.fastCloneDeep)(resourceGroup.components[\"component-\".concat(key)].schema);\n        }\n      } else if (group === 'searchFields') {\n        //Search components go into this group\n        var _resourceGroups = this.groups.resource.subgroups;\n\n        for (var ix = 0; ix < _resourceGroups.length; ix++) {\n          var _resourceGroup = _resourceGroups[ix];\n\n          if (_resourceGroup.components.hasOwnProperty(\"component-\".concat(key))) {\n            info = (0, _utils.fastCloneDeep)(_resourceGroup.components[\"component-\".concat(key)].schema);\n            break;\n          }\n        }\n      }\n\n      if (info) {\n        info.key = this.generateKey(info);\n      }\n\n      return info;\n    }\n  }, {\n    key: \"getComponentsPath\",\n    value: function getComponentsPath(component, parent) {\n      // Get path to the component in the parent component.\n      var path = 'components';\n      var columnIndex = 0;\n      var tableRowIndex = 0;\n      var tableColumnIndex = 0;\n      var tabIndex = 0;\n\n      switch (parent.type) {\n        case 'table':\n          tableRowIndex = _lodash.default.findIndex(parent.rows, function (row) {\n            return row.some(function (column) {\n              return column.components.some(function (comp) {\n                return comp.key === component.key;\n              });\n            });\n          });\n          tableColumnIndex = _lodash.default.findIndex(parent.rows[tableRowIndex], function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"rows[\".concat(tableRowIndex, \"][\").concat(tableColumnIndex, \"].components\");\n          break;\n\n        case 'columns':\n          columnIndex = _lodash.default.findIndex(parent.columns, function (column) {\n            return column.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"columns[\".concat(columnIndex, \"].components\");\n          break;\n\n        case 'tabs':\n          tabIndex = _lodash.default.findIndex(parent.components, function (tab) {\n            return tab.components.some(function (comp) {\n              return comp.key === component.key;\n            });\n          });\n          path = \"components[\".concat(tabIndex, \"].components\");\n          break;\n      }\n\n      return path;\n    }\n    /* eslint-disable max-statements */\n\n  }, {\n    key: \"onDrop\",\n    value: function onDrop(element, target, source, sibling) {\n      var _this$groups$group,\n          _this8 = this;\n\n      if (!target) {\n        return;\n      } // If you try to drop within itself.\n\n\n      if (element.contains(target)) {\n        return;\n      }\n\n      var key = element.getAttribute('data-key');\n      var type = element.getAttribute('data-type');\n      var group = element.getAttribute('data-group');\n      var info, isNew, path, index;\n\n      if (key && group) {\n        // This is a new component.\n        info = this.getComponentInfo(key, group);\n\n        if (!info && type) {\n          info = this.getComponentInfo(type, group);\n        }\n\n        isNew = true;\n      } else if (source.formioContainer) {\n        index = _lodash.default.findIndex(source.formioContainer, {\n          key: element.formioComponent.component.key\n        });\n\n        if (index !== -1) {\n          // Grab and remove the component from the source container.\n          info = source.formioContainer.splice(_lodash.default.findIndex(source.formioContainer, {\n            key: element.formioComponent.component.key\n          }), 1); // Since splice returns an array of one object, we need to destructure it.\n\n          info = info[0];\n        }\n      } // If we haven't found the component, stop.\n\n\n      if (!info) {\n        return;\n      } // Show an error if siblings are disabled for a component and such a component already exists.\n\n\n      var compKey = group === 'resource' ? \"component-\".concat(key) : key;\n      var draggableComponent = ((_this$groups$group = this.groups[group]) === null || _this$groups$group === void 0 ? void 0 : _this$groups$group.components[compKey]) || {};\n\n      if (draggableComponent.disableSiblings) {\n        var isCompAlreadyExists = false;\n        (0, _formUtils.eachComponent)(this.webform.components, function (component) {\n          if (component.type === draggableComponent.schema.type) {\n            isCompAlreadyExists = true;\n            return;\n          }\n        }, true);\n\n        if (isCompAlreadyExists) {\n          this.webform.redraw();\n          this.webform.setAlert('danger', \"You cannot add more than one \".concat(draggableComponent.key, \" component to one page.\"));\n          return;\n        }\n      }\n\n      if (target !== source) {\n        // Ensure the key remains unique in its new container.\n        _builder.default.uniquify(this.findNamespaceRoot(target.formioComponent), info);\n      }\n\n      var parent = target.formioComponent; // Insert in the new container.\n\n      if (target.formioContainer) {\n        if (sibling) {\n          if (!sibling.getAttribute('data-noattach')) {\n            index = _lodash.default.findIndex(target.formioContainer, {\n              key: _lodash.default.get(sibling, 'formioComponent.component.key')\n            });\n            index = index === -1 ? 0 : index;\n          } else {\n            index = sibling.getAttribute('data-position');\n          }\n\n          if (index !== -1) {\n            target.formioContainer.splice(index, 0, info);\n          }\n        } else {\n          target.formioContainer.push(info);\n        }\n\n        path = this.getComponentsPath(info, parent.component);\n        index = _lodash.default.findIndex(_lodash.default.get(parent.schema, path), {\n          key: info.key\n        });\n\n        if (index === -1) {\n          index = 0;\n        }\n      }\n\n      if (parent && parent.addChildComponent) {\n        parent.addChildComponent(info, element, target, source, sibling);\n      }\n\n      var componentInDataGrid = parent.type === 'datagrid';\n\n      if (isNew && !this.options.noNewEdit && !info.noNewEdit) {\n        this.editComponent(info, target, isNew, null, null, {\n          inDataGrid: componentInDataGrid\n        });\n      } // Only rebuild the parts needing to be rebuilt.\n\n\n      var rebuild;\n\n      if (target !== source) {\n        if (source.formioContainer && source.contains(target)) {\n          rebuild = source.formioComponent.rebuild();\n        } else if (target.contains(source)) {\n          rebuild = target.formioComponent.rebuild();\n        } else {\n          if (source.formioContainer) {\n            rebuild = source.formioComponent.rebuild();\n          }\n\n          rebuild = target.formioComponent.rebuild();\n        }\n      } else {\n        // If they are the same, only rebuild one.\n        rebuild = target.formioComponent.rebuild();\n      }\n\n      if (!rebuild) {\n        rebuild = _nativePromiseOnly.default.resolve();\n      }\n\n      return rebuild.then(function () {\n        _this8.emit('addComponent', info, parent, path, index, isNew && !_this8.options.noNewEdit && !info.noNewEdit);\n\n        if (!isNew || _this8.options.noNewEdit || info.noNewEdit) {\n          _this8.emit('change', _this8.form);\n        }\n      });\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form) {\n      var _this9 = this;\n\n      if (!form.components) {\n        form.components = [];\n      }\n\n      var isShowSubmitButton = !this.options.noDefaultSubmitButton && !form.components.length; // Ensure there is at least a submit button.\n\n      if (isShowSubmitButton) {\n        form.components.push({\n          type: 'button',\n          label: 'Submit',\n          key: 'submit',\n          size: 'md',\n          block: false,\n          action: 'submit',\n          disableOnInvalid: true,\n          theme: 'primary'\n        });\n      }\n\n      if (this.webform) {\n        var shouldRebuild = !this.webform.form.components || form.components.length !== this.webform.form.components.length;\n        return this.webform.setForm(form, {\n          keepAsReference: true\n        }).then(function () {\n          if (_this9.refs.form) {\n            _this9.builderHeight = _this9.refs.form.offsetHeight;\n          }\n\n          if (!shouldRebuild) {\n            return _this9.form;\n          }\n\n          return _this9.rebuild().then(function () {\n            return _this9.form;\n          });\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve(form);\n    }\n  }, {\n    key: \"populateRecaptchaSettings\",\n    value: function populateRecaptchaSettings(form) {\n      //populate isEnabled for recaptcha form settings\n      var isRecaptchaEnabled = false;\n\n      if (this.form.components) {\n        (0, _formUtils.eachComponent)(form.components, function (component) {\n          if (isRecaptchaEnabled) {\n            return;\n          }\n\n          if (component.type === 'recaptcha') {\n            isRecaptchaEnabled = true;\n            return false;\n          }\n        });\n\n        if (isRecaptchaEnabled) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', true);\n        } else if (_lodash.default.get(form, 'settings.recaptcha.isEnabled')) {\n          _lodash.default.set(form, 'settings.recaptcha.isEnabled', false);\n        }\n      }\n    }\n  }, {\n    key: \"removeComponent\",\n    value: function removeComponent(component, parent, original) {\n      var _this10 = this;\n\n      if (!parent) {\n        return;\n      }\n\n      var remove = true;\n      var removingComponentsGroup = !component.skipRemoveConfirm && (Array.isArray(component.components) && component.components.length || Array.isArray(component.rows) && component.rows.length || Array.isArray(component.columns) && component.columns.length);\n\n      if (this.options.alwaysConfirmComponentRemoval || removingComponentsGroup) {\n        var message = removingComponentsGroup ? 'Removing this component will also remove all of its children. Are you sure you want to do this?' : 'Are you sure you want to remove this component?';\n        remove = window.confirm(this.t(message));\n      }\n\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n\n      var index = parent.formioContainer ? parent.formioContainer.indexOf(original) : 0;\n\n      if (remove && index !== -1) {\n        var path = this.getComponentsPath(component, parent.formioComponent.component);\n\n        if (parent.formioContainer) {\n          parent.formioContainer.splice(index, 1);\n        } else if (parent.formioComponent && parent.formioComponent.removeChildComponent) {\n          parent.formioComponent.removeChildComponent(component);\n        }\n\n        var rebuild = parent.formioComponent.rebuild() || _nativePromiseOnly.default.resolve();\n\n        rebuild.then(function () {\n          _this10.emit('removeComponent', component, parent.formioComponent.schema, path, index);\n\n          _this10.emit('change', _this10.form);\n        });\n      }\n\n      return remove;\n    }\n  }, {\n    key: \"replaceDoubleQuotes\",\n    value: function replaceDoubleQuotes(data) {\n      var fieldsToRemoveDoubleQuotes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n      if (data) {\n        fieldsToRemoveDoubleQuotes.forEach(function (key) {\n          if (data[key]) {\n            data[key] = data[key].replace(/\"/g, \"'\");\n          }\n        });\n        return data;\n      }\n    }\n  }, {\n    key: \"updateComponent\",\n    value: function updateComponent(component, changed) {\n      var _this11 = this;\n\n      // Update the preview.\n      if (this.preview) {\n        this.preview.form = {\n          components: [_lodash.default.omit(_objectSpread({}, component), ['hidden', 'conditional', 'calculateValue', 'logic', 'autofocus', 'customConditional'])],\n          config: this.options.formConfig || {}\n        };\n        var fieldsToRemoveDoubleQuotes = ['label', 'tooltip', 'placeholder'];\n        this.preview.form.components.forEach(function (component) {\n          return _this11.replaceDoubleQuotes(component, fieldsToRemoveDoubleQuotes);\n        });\n        var previewElement = this.componentEdit.querySelector('[ref=\"preview\"]');\n\n        if (previewElement) {\n          this.setContent(previewElement, this.preview.render());\n          this.preview.attach(previewElement);\n        }\n      } // Change the \"default value\" field to be reflective of this component.\n\n\n      var defaultValueComponent = (0, _formUtils.getComponent)(this.editForm.components, 'defaultValue', true);\n\n      if (defaultValueComponent && component.type !== 'hidden') {\n        var defaultChanged = changed && (changed.component && changed.component.key === 'defaultValue' || changed.instance && defaultValueComponent.hasComponent && defaultValueComponent.hasComponent(changed.instance));\n\n        if (!defaultChanged) {\n          _lodash.default.assign(defaultValueComponent.component, _lodash.default.omit(_objectSpread({}, component), ['key', 'label', 'placeholder', 'tooltip', 'hidden', 'autofocus', 'validate', 'disabled', 'defaultValue', 'customDefaultValue', 'calculateValue', 'conditional', 'customConditional', 'id']));\n\n          var parentComponent = defaultValueComponent.parent;\n          var tabIndex = -1;\n          var index = -1;\n          parentComponent.tabs.some(function (tab, tIndex) {\n            tab.some(function (comp, compIndex) {\n              if (comp.id === defaultValueComponent.id) {\n                tabIndex = tIndex;\n                index = compIndex;\n                return true;\n              }\n\n              return false;\n            });\n          });\n\n          if (tabIndex !== -1 && index !== -1 && changed && changed.value) {\n            var sibling = parentComponent.tabs[tabIndex][index + 1];\n            parentComponent.removeComponent(defaultValueComponent);\n            var newComp = parentComponent.addComponent(defaultValueComponent.component, defaultValueComponent.data, sibling);\n\n            _lodash.default.pull(newComp.validators, 'required');\n\n            parentComponent.tabs[tabIndex].splice(index, 1, newComp);\n\n            newComp.checkValidity = function () {\n              return true;\n            };\n\n            newComp.build(defaultValueComponent.element);\n          }\n        } else {\n          var dataPath = changed.instance._data.key;\n          var path = (0, _utils.getArrayFromComponentPath)(changed.instance.path);\n          path.shift();\n\n          if (path.length) {\n            path.unshift(component.key);\n            dataPath = (0, _utils.getStringFromComponentPath)(path);\n          }\n\n          _lodash.default.set(this.preview._data, dataPath, changed.value);\n\n          _lodash.default.set(this.webform._data, dataPath, changed.value);\n        }\n      } // Called when we update a component.\n\n\n      this.emit('updateComponent', component);\n    }\n  }, {\n    key: \"findRepeatablePaths\",\n    value: function findRepeatablePaths() {\n      var repeatablePaths = [];\n      var keys = new Map();\n      (0, _formUtils.eachComponent)(this.form.components, function (comp, path) {\n        if (!comp.key) {\n          return;\n        }\n\n        if (keys.has(comp.key)) {\n          if (keys.get(comp.key).includes(path)) {\n            repeatablePaths.push(path);\n          } else {\n            keys.set(comp.key, [].concat(_toConsumableArray(keys.get(comp.key)), [path]));\n          }\n        } else {\n          keys.set(comp.key, [path]);\n        }\n      }, true);\n      return repeatablePaths;\n    }\n  }, {\n    key: \"highlightInvalidComponents\",\n    value: function highlightInvalidComponents() {\n      var repeatablePaths = this.findRepeatablePaths();\n      var hasInvalidComponents = false;\n      this.webform.everyComponent(function (comp) {\n        var _comp$error, _comp$error$message;\n\n        var path = comp.path;\n\n        if (repeatablePaths.includes(path)) {\n          comp.setCustomValidity(\"API Key is not unique: \".concat(comp.key));\n          hasInvalidComponents = true;\n        } else if ((_comp$error = comp.error) !== null && _comp$error !== void 0 && (_comp$error$message = _comp$error.message) !== null && _comp$error$message !== void 0 && _comp$error$message.startsWith('API Key is not unique')) {\n          comp.setCustomValidity('');\n        }\n      });\n      this.emit('builderFormValidityChange', hasInvalidComponents);\n    }\n    /**\n     * Called when a new component is saved.\n     *\n     * @param parent\n     * @param component\n     * @return {boolean}\n     */\n\n  }, {\n    key: \"saveComponent\",\n    value: function saveComponent(component, parent, isNew, original) {\n      var _this12 = this;\n\n      this.editForm.detach();\n      var parentContainer = parent ? parent.formioContainer : this.container;\n      var parentComponent = parent ? parent.formioComponent : this;\n      this.dialog.close();\n      var path = parentContainer ? this.getComponentsPath(component, parentComponent.component) : '';\n\n      if (!original) {\n        original = parent.formioContainer.find(function (comp) {\n          return comp.id === component.id;\n        });\n      }\n\n      var index = parentContainer ? parentContainer.indexOf(original) : 0;\n\n      if (index !== -1) {\n        var submissionData = this.editForm.submission.data;\n        submissionData = submissionData.componentJson || submissionData;\n        var fieldsToRemoveDoubleQuotes = ['label', 'tooltip', 'placeholder'];\n        this.replaceDoubleQuotes(submissionData, fieldsToRemoveDoubleQuotes);\n        this.hook('beforeSaveComponentSettings', submissionData);\n        var comp = null;\n        parentComponent.getComponents().forEach(function (component) {\n          if (component.component.key === original.key) {\n            comp = component;\n          }\n        });\n        var originalComp = comp.component;\n        var originalComponentSchema = comp.schema;\n        var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n\n        if (parentContainer && !isParentSaveChildMethod) {\n          parentContainer[index] = submissionData;\n\n          if (comp) {\n            comp.component = submissionData;\n          }\n        } else if (isParentSaveChildMethod) {\n          parent.formioComponent.saveChildComponent(submissionData);\n        }\n\n        var rebuild = parentComponent.rebuild() || _nativePromiseOnly.default.resolve();\n\n        return rebuild.then(function () {\n          var schema = parentContainer ? parentContainer[index] : comp ? comp.schema : [];\n\n          _this12.emitSaveComponentEvent(schema, originalComp, parentComponent.schema, path, index, isNew, originalComponentSchema);\n\n          _this12.emit('change', _this12.form);\n\n          _this12.highlightInvalidComponents();\n        });\n      }\n\n      this.highlightInvalidComponents();\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"emitSaveComponentEvent\",\n    value: function emitSaveComponentEvent(schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema) {\n      this.emit('saveComponent', schema, originalComp, parentComponentSchema, path, index, isNew, originalComponentSchema);\n    }\n  }, {\n    key: \"editComponent\",\n    value: function editComponent(component, parent, isNew, isJsonEdit, original) {\n      var _this13 = this;\n\n      var flags = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n\n      if (!component.key) {\n        return;\n      }\n\n      var saved = false;\n      var componentCopy = (0, _utils.fastCloneDeep)(component);\n      var ComponentClass = _Components.default.components[componentCopy.type];\n      var isCustom = ComponentClass === undefined;\n      isJsonEdit = isJsonEdit || isCustom;\n      ComponentClass = isCustom ? _Components.default.components.unknown : ComponentClass; // Make sure we only have one dialog open at a time.\n\n      if (this.dialog) {\n        this.dialog.close();\n        this.highlightInvalidComponents();\n      } // This is the render step.\n\n\n      var editFormOptions = _lodash.default.clone(_lodash.default.get(this, 'options.editForm', {}));\n\n      if (this.editForm) {\n        this.editForm.destroy();\n      } // Allow editForm overrides per component.\n\n\n      var overrides = _lodash.default.get(this.options, \"editForm.\".concat(componentCopy.type), {}); // Pass along the form being edited.\n\n\n      editFormOptions.editForm = this.form;\n      editFormOptions.editComponent = component;\n      editFormOptions.flags = flags;\n      this.hook('editComponentParentInstance', editFormOptions, parent);\n      this.editForm = new _Webform.default(_objectSpread(_objectSpread({}, _lodash.default.omit(this.options, ['hooks', 'builder', 'events', 'attachMode', 'skipInit'])), {}, {\n        language: this.options.language\n      }, editFormOptions));\n      this.hook('editFormProperties', parent);\n      this.editForm.form = isJsonEdit && !isCustom ? {\n        components: [{\n          type: 'textarea',\n          as: 'json',\n          editor: 'ace',\n          weight: 10,\n          input: true,\n          key: 'componentJson',\n          label: 'Component JSON',\n          tooltip: 'Edit the JSON for this component.'\n        }, {\n          type: 'checkbox',\n          key: 'showFullSchema',\n          label: 'Full Schema'\n        }]\n      } : ComponentClass.editForm(_lodash.default.cloneDeep(overrides));\n      var instanceOptions = {};\n      this.hook('instanceOptionsPreview', instanceOptions);\n      var instance = new ComponentClass(componentCopy, instanceOptions);\n      var schema = this.hook('builderComponentSchema', component, instance);\n      this.editForm.submission = isJsonEdit ? {\n        data: {\n          componentJson: schema,\n          showFullSchema: this.options.showFullJsonSchema\n        }\n      } : {\n        data: instance.component\n      };\n\n      if (this.preview) {\n        this.preview.destroy();\n      }\n\n      if (!ComponentClass.builderInfo.hasOwnProperty('preview') || ComponentClass.builderInfo.preview) {\n        this.preview = new _Webform.default(_lodash.default.omit(_objectSpread(_objectSpread({}, this.options), {}, {\n          preview: true\n        }), ['hooks', 'builder', 'events', 'attachMode', 'calculateValue']));\n        this.hook('previewFormSettitngs', schema, isJsonEdit);\n      }\n\n      this.componentEdit = this.ce('div', {\n        'class': 'component-edit-container'\n      });\n      this.setContent(this.componentEdit, this.renderTemplate('builderEditForm', {\n        componentInfo: ComponentClass.builderInfo,\n        editForm: this.editForm.render(),\n        preview: this.preview ? this.preview.render() : false,\n        helplinks: this.helplinks\n      }));\n      this.dialog = this.createModal(this.componentEdit, _lodash.default.get(this.options, 'dialogAttr', {})); // This is the attach step.\n\n      this.editForm.attach(this.componentEdit.querySelector('[ref=\"editForm\"]'));\n      this.hook('editFormWrapper');\n      this.updateComponent(componentCopy);\n      this.editForm.on('change', function (event) {\n        if (event.changed) {\n          if (event.changed.component && event.changed.component.key === 'showFullSchema') {\n            var value = event.changed.value;\n            _this13.editForm.submission = {\n              data: {\n                componentJson: value ? instance.component : component,\n                showFullSchema: value\n              }\n            };\n            return;\n          } // See if this is a manually modified key. Treat custom component keys as manually modified\n\n\n          if (event.changed.component && event.changed.component.key === 'key' || isJsonEdit) {\n            componentCopy.keyModified = true;\n          }\n\n          var isComponentLabelChanged = false;\n\n          if (event.changed.instance) {\n            isComponentLabelChanged = ['label', 'title'].includes(event.changed.instance.path);\n          } else if (event.changed.component) {\n            isComponentLabelChanged = ['label', 'title'].includes(event.changed.component.key);\n          }\n\n          if (isComponentLabelChanged) {\n            // Ensure this component has a key.\n            if (isNew) {\n              if (!event.data.keyModified) {\n                _this13.editForm.everyComponent(function (component) {\n                  if (component.key === 'key' && component.parent.component.key === 'tabs') {\n                    component.setValue(_this13.updateComponentKey(event.data));\n                    return false;\n                  }\n                });\n              }\n\n              if (_this13.form) {\n                var formComponents = _this13.findNamespaceRoot(parent.formioComponent); // excluding component which key uniqueness is to be checked to prevent the comparing of the same keys\n\n\n                formComponents = formComponents.filter(function (comp) {\n                  return editFormOptions.editComponent.id !== comp.id;\n                }); // Set a unique key for this component.\n\n                _builder.default.uniquify(formComponents, event.data);\n              }\n            }\n          } // Update the component.\n\n\n          _this13.updateComponent(event.data.componentJson || event.data, event.changed);\n        }\n      });\n      var cancelButtons = this.componentEdit.querySelectorAll('[ref=\"cancelButton\"]');\n      cancelButtons.forEach(function (cancelButton) {\n        _this13.addEventListener(cancelButton, 'click', function (event) {\n          event.preventDefault();\n\n          _this13.editForm.detach();\n\n          _this13.emit('cancelComponent', component);\n\n          _this13.dialog.close();\n\n          _this13.highlightInvalidComponents();\n        });\n      });\n      var removeButtons = this.componentEdit.querySelectorAll('[ref=\"removeButton\"]');\n      removeButtons.forEach(function (removeButton) {\n        _this13.addEventListener(removeButton, 'click', function (event) {\n          event.preventDefault(); // Since we are already removing the component, don't trigger another remove.\n\n          saved = true;\n\n          _this13.editForm.detach();\n\n          _this13.removeComponent(component, parent, original);\n\n          _this13.dialog.close();\n\n          _this13.highlightInvalidComponents();\n        });\n      });\n      var saveButtons = this.componentEdit.querySelectorAll('[ref=\"saveButton\"]');\n      saveButtons.forEach(function (saveButton) {\n        _this13.addEventListener(saveButton, 'click', function (event) {\n          event.preventDefault();\n\n          if (!_this13.editForm.checkValidity(_this13.editForm.data, true, _this13.editForm.data)) {\n            _this13.editForm.setPristine(false);\n\n            _this13.editForm.showErrors();\n\n            return false;\n          }\n\n          saved = true;\n\n          _this13.saveComponent(component, parent, isNew, original);\n        });\n      });\n\n      var dialogClose = function dialogClose() {\n        _this13.editForm.destroy(true);\n\n        if (_this13.preview) {\n          _this13.preview.destroy(true);\n\n          _this13.preview = null;\n        }\n\n        if (isNew && !saved) {\n          _this13.removeComponent(component, parent, original);\n\n          _this13.highlightInvalidComponents();\n        } // Clean up.\n\n\n        _this13.removeEventListener(_this13.dialog, 'close', dialogClose);\n\n        _this13.dialog = null;\n      };\n\n      this.addEventListener(this.dialog, 'close', dialogClose); // Called when we edit a component.\n\n      this.emit('editComponent', component);\n    }\n  }, {\n    key: \"updateComponentKey\",\n    value: function updateComponentKey(data) {\n      return _lodash.default.camelCase(data.title || data.label || data.placeholder || data.type).replace(/^[0-9]*/, '');\n    }\n    /**\n     * Creates copy of component schema and stores it under sessionStorage.\n     * @param {Component} component\n     * @return {*}\n     */\n\n  }, {\n    key: \"copyComponent\",\n    value: function copyComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n\n      this.addClass(this.refs.form, 'builder-paste-mode');\n      window.sessionStorage.setItem('formio.clipboard', JSON.stringify(component.schema));\n    }\n    /**\n     * Paste copied component after the current component.\n     * @param {Component} component\n     * @return {*}\n     */\n\n  }, {\n    key: \"pasteComponent\",\n    value: function pasteComponent(component) {\n      if (!window.sessionStorage) {\n        return console.warn('Session storage is not supported in this browser.');\n      }\n\n      this.removeClass(this.refs.form, 'builder-paste-mode');\n\n      if (window.sessionStorage) {\n        var data = window.sessionStorage.getItem('formio.clipboard');\n\n        if (data) {\n          var schema = JSON.parse(data);\n          var parent = this.getParentElement(component.element);\n\n          if (parent) {\n            _builder.default.uniquify(this.findNamespaceRoot(parent.formioComponent), schema);\n\n            var path = '';\n            var index = 0;\n            var isParentSaveChildMethod = this.isParentSaveChildMethod(parent.formioComponent);\n\n            if (parent.formioContainer && !isParentSaveChildMethod) {\n              index = parent.formioContainer.indexOf(component.component);\n              path = this.getComponentsPath(schema, parent.formioComponent.component);\n              parent.formioContainer.splice(index + 1, 0, schema);\n            } else if (isParentSaveChildMethod) {\n              parent.formioComponent.saveChildComponent(schema, false);\n            }\n\n            parent.formioComponent.rebuild();\n            this.emitSaveComponentEvent(schema, schema, parent.formioComponent.component, path, index + 1, true, schema);\n          }\n\n          this.emit('change', this.form);\n        }\n      }\n    }\n  }, {\n    key: \"isParentSaveChildMethod\",\n    value: function isParentSaveChildMethod(parentComp) {\n      return !!(parentComp && parentComp.saveChildComponent);\n    }\n  }, {\n    key: \"getParentElement\",\n    value: function getParentElement(element) {\n      var container = element;\n\n      do {\n        container = container.parentNode;\n      } while (container && !container.formioComponent);\n\n      return container;\n    }\n  }, {\n    key: \"addBuilderComponentInfo\",\n    value: function addBuilderComponentInfo(component) {\n      if (!component || !component.group || !this.groups[component.group]) {\n        return;\n      }\n\n      component = _lodash.default.clone(component);\n      var groupInfo = this.groups[component.group];\n\n      if (!groupInfo.components.hasOwnProperty(component.key)) {\n        groupInfo.components[component.key] = component;\n      }\n\n      return component;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      if (this.webform) {\n        this.webform.init();\n      }\n\n      return _get(_getPrototypeOf(WebformBuilder.prototype), \"init\", this).call(this);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      if (this.webform.initialized) {\n        this.webform.clear();\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(deleteFromGlobal) {\n      if (this.webform.initialized) {\n        this.webform.destroy(deleteFromGlobal);\n      }\n\n      _get(_getPrototypeOf(WebformBuilder.prototype), \"destroy\", this).call(this, deleteFromGlobal);\n    }\n  }, {\n    key: \"addBuilderGroup\",\n    value: function addBuilderGroup(name, group) {\n      if (!this.groups[name]) {\n        this.groups[name] = group;\n        this.groupOrder.push(name);\n        this.triggerRedraw();\n      } else {\n        this.updateBuilderGroup(name, group);\n      }\n    }\n  }, {\n    key: \"updateBuilderGroup\",\n    value: function updateBuilderGroup(name, group) {\n      if (this.groups[name]) {\n        this.groups[name] = group;\n        this.triggerRedraw();\n      }\n    }\n  }, {\n    key: \"generateKey\",\n    value: function generateKey(info) {\n      return _lodash.default.camelCase(info.key || info.title || info.label || info.placeholder || info.type);\n    }\n  }]);\n\n  return WebformBuilder;\n}(_Component2.default);\n\nexports.default = WebformBuilder;"],"mappings":"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"},"metadata":{},"sourceType":"script"}