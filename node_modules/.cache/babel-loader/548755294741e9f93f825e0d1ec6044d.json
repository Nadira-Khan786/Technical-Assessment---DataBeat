{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.auth = undefined;\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n  return target;\n};\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\nvar _constants = require('./constants');\nvar type = _interopRequireWildcard(_constants);\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n    newObj.default = obj;\n    return newObj;\n  }\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nvar initialState = {\n  init: false,\n  isActive: false,\n  user: null,\n  authenticated: false,\n  submissionAccess: {},\n  formAccess: {},\n  projectAccess: {},\n  roles: {},\n  is: {},\n  error: ''\n};\nfunction mapProjectRolesToUserRoles(projectRoles, userRoles) {\n  return Object.entries(projectRoles).reduce(function (result, _ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      name = _ref2[0],\n      role = _ref2[1];\n    return _extends({}, result, _defineProperty({}, name, userRoles.includes(role._id)));\n  }, {});\n}\nfunction getUserRoles(projectRoles) {\n  return Object.keys(projectRoles).reduce(function (result, name) {\n    return _extends({}, result, _defineProperty({}, name, name === 'anonymous'));\n  }, {});\n}\nvar auth = exports.auth = function auth(config) {\n  return function () {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n    var action = arguments[1];\n    switch (action.type) {\n      case type.USER_REQUEST:\n        return _extends({}, state, {\n          init: true,\n          submissionAccess: false,\n          isActive: true\n        });\n      case type.USER_REQUEST_SUCCESS:\n        return _extends({}, state, {\n          isActive: false,\n          user: action.user,\n          authenticated: true,\n          is: mapProjectRolesToUserRoles(state.roles, action.user.roles),\n          error: ''\n        });\n      case type.USER_REQUEST_FAILURE:\n        return _extends({}, state, {\n          isActive: false,\n          is: getUserRoles(state.roles),\n          error: action.error\n        });\n      case type.USER_LOGOUT:\n        return _extends({}, state, {\n          user: null,\n          isActive: false,\n          authenticated: false,\n          is: getUserRoles(state.roles),\n          error: ''\n        });\n      case type.USER_SUBMISSION_ACCESS:\n        return _extends({}, state, {\n          submissionAccess: action.submissionAccess\n        });\n      case type.USER_FORM_ACCESS:\n        return _extends({}, state, {\n          formAccess: action.formAccess\n        });\n      case type.USER_PROJECT_ACCESS:\n        return _extends({}, state, {\n          projectAccess: action.projectAccess\n        });\n      case type.USER_ROLES:\n        return _extends({}, state, {\n          roles: action.roles\n        });\n      default:\n        return state;\n    }\n  };\n};","map":{"version":3,"names":["Object","defineProperty","exports","value","auth","undefined","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_i","Symbol","iterator","_s","next","done","push","err","Array","isArray","TypeError","_constants","require","type","_interopRequireWildcard","obj","__esModule","newObj","default","_defineProperty","enumerable","configurable","writable","initialState","init","isActive","user","authenticated","submissionAccess","formAccess","projectAccess","roles","is","error","mapProjectRolesToUserRoles","projectRoles","userRoles","entries","reduce","result","_ref","_ref2","name","role","includes","_id","getUserRoles","keys","config","state","action","USER_REQUEST","USER_REQUEST_SUCCESS","USER_REQUEST_FAILURE","USER_LOGOUT","USER_SUBMISSION_ACCESS","USER_FORM_ACCESS","USER_PROJECT_ACCESS","USER_ROLES"],"sources":["D:/task/node_modules/react-formio/lib/modules/auth/reducers.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.auth = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _constants = require('./constants');\n\nvar type = _interopRequireWildcard(_constants);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar initialState = {\n  init: false,\n  isActive: false,\n  user: null,\n  authenticated: false,\n  submissionAccess: {},\n  formAccess: {},\n  projectAccess: {},\n  roles: {},\n  is: {},\n  error: ''\n};\n\nfunction mapProjectRolesToUserRoles(projectRoles, userRoles) {\n  return Object.entries(projectRoles).reduce(function (result, _ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        name = _ref2[0],\n        role = _ref2[1];\n\n    return _extends({}, result, _defineProperty({}, name, userRoles.includes(role._id)));\n  }, {});\n}\n\nfunction getUserRoles(projectRoles) {\n  return Object.keys(projectRoles).reduce(function (result, name) {\n    return _extends({}, result, _defineProperty({}, name, name === 'anonymous'));\n  }, {});\n}\n\nvar auth = exports.auth = function auth(config) {\n  return function () {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n    var action = arguments[1];\n\n    switch (action.type) {\n      case type.USER_REQUEST:\n        return _extends({}, state, {\n          init: true,\n          submissionAccess: false,\n          isActive: true\n        });\n      case type.USER_REQUEST_SUCCESS:\n        return _extends({}, state, {\n          isActive: false,\n          user: action.user,\n          authenticated: true,\n          is: mapProjectRolesToUserRoles(state.roles, action.user.roles),\n          error: ''\n        });\n      case type.USER_REQUEST_FAILURE:\n        return _extends({}, state, {\n          isActive: false,\n          is: getUserRoles(state.roles),\n          error: action.error\n        });\n      case type.USER_LOGOUT:\n        return _extends({}, state, {\n          user: null,\n          isActive: false,\n          authenticated: false,\n          is: getUserRoles(state.roles),\n          error: ''\n        });\n      case type.USER_SUBMISSION_ACCESS:\n        return _extends({}, state, {\n          submissionAccess: action.submissionAccess\n        });\n      case type.USER_FORM_ACCESS:\n        return _extends({}, state, {\n          formAccess: action.formAccess\n        });\n      case type.USER_PROJECT_ACCESS:\n        return _extends({}, state, {\n          projectAccess: action.projectAccess\n        });\n      case type.USER_ROLES:\n        return _extends({}, state, {\n          roles: action.roles\n        });\n      default:\n        return state;\n    }\n  };\n};"],"mappings":"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"},"metadata":{},"sourceType":"script"}