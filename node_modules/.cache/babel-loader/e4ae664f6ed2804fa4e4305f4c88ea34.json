{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\nrequire(\"core-js/modules/es.reflect.construct.js\");\nrequire(\"core-js/modules/es.reflect.get.js\");\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\nrequire(\"core-js/modules/es.object.keys.js\");\nrequire(\"core-js/modules/es.symbol.js\");\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\nrequire(\"core-js/modules/es.symbol.description.js\");\nrequire(\"core-js/modules/es.symbol.iterator.js\");\nrequire(\"core-js/modules/es.array.iterator.js\");\nrequire(\"core-js/modules/es.string.iterator.js\");\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.regexp.exec.js\");\nrequire(\"core-js/modules/es.string.split.js\");\nrequire(\"core-js/modules/es.object.assign.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\nrequire(\"core-js/modules/es.array.concat.js\");\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.array.includes.js\");\nrequire(\"core-js/modules/es.string.includes.js\");\nrequire(\"core-js/modules/es.array.map.js\");\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _compareVersions = _interopRequireDefault(require(\"compare-versions\"));\nvar _EventEmitter = _interopRequireDefault(require(\"./EventEmitter\"));\nvar _i18next = _interopRequireDefault(require(\"i18next\"));\nvar _i18n = _interopRequireDefault(require(\"./i18n\"));\nvar _Formio = require(\"./Formio\");\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\nvar _Components = _interopRequireDefault(require(\"./components/Components\"));\nvar _NestedDataComponent2 = _interopRequireDefault(require(\"./components/_classes/nesteddata/NestedDataComponent\"));\nvar _utils = require(\"./utils/utils\");\nvar _formUtils = require(\"./utils/formUtils\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get.bind();\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get.apply(this, arguments);\n}\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\n// Initialize the available forms.\n_Formio.GlobalFormio.forms = {}; // Allow people to register components.\n\n_Formio.GlobalFormio.registerComponent = _Components.default.setComponent;\nfunction getIconSet(icons) {\n  if (icons === 'fontawesome') {\n    return 'fa';\n  }\n  return icons || '';\n}\nfunction getOptions(options) {\n  options = _lodash.default.defaults(options, {\n    submitOnEnter: false,\n    iconset: getIconSet(options && options.icons ? options.icons : _Formio.GlobalFormio.icons),\n    i18next: _i18next.default,\n    saveDraft: false,\n    alwaysDirty: false,\n    saveDraftThrottle: 5000,\n    display: 'form',\n    cdnUrl: _Formio.GlobalFormio.cdn.baseUrl\n  });\n  if (!options.events) {\n    options.events = new _EventEmitter.default();\n  }\n  return options;\n}\n/**\n * Renders a Form.io form within the webpage.\n */\n\nvar Webform = /*#__PURE__*/function (_NestedDataComponent) {\n  _inherits(Webform, _NestedDataComponent);\n  var _super = _createSuper(Webform);\n\n  /**\n   * Creates a new Form instance.\n   *\n   * @param {Object} options - The options to create a new form instance.\n   * @param {boolean} options.saveDraft - Set this if you would like to enable the save draft feature.\n   * @param {boolean} options.saveDraftThrottle - The throttle for the save draft feature.\n   * @param {boolean} options.readOnly - Set this form to readOnly\n   * @param {boolean} options.noAlerts - Set to true to disable the alerts dialog.\n   * @param {boolean} options.i18n - The translation file for this rendering. @see https://github.com/formio/formio.js/blob/master/i18n.js\n   * @param {boolean} options.template - Provides a way to inject custom logic into the creation of every element rendered within the form.\n   */\n\n  /* eslint-disable max-statements */\n  function Webform() {\n    var _this2;\n    _classCallCheck(this, Webform);\n    var element, options;\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    }\n    _this2 = _super.call(this, null, getOptions(options));\n    _defineProperty(_assertThisInitialized(_this2), \"executeShortcuts\", function (event) {\n      var target = event.target;\n      if (!_this2.keyboardCatchableElement(target)) {\n        return;\n      }\n      var ctrl = event.ctrlKey || event.metaKey;\n      var keyCode = event.keyCode;\n      var char = '';\n      if (65 <= keyCode && keyCode <= 90) {\n        char = String.fromCharCode(keyCode);\n      } else if (keyCode === 13) {\n        char = 'Enter';\n      } else if (keyCode === 27) {\n        char = 'Esc';\n      }\n      _lodash.default.each(_this2.shortcuts, function (shortcut) {\n        if (shortcut.ctrl && !ctrl) {\n          return;\n        }\n        if (shortcut.shortcut === char) {\n          shortcut.element.click();\n          event.preventDefault();\n        }\n      });\n    });\n    _this2.element = element; // Keep track of all available forms globally.\n\n    _Formio.GlobalFormio.forms[_this2.id] = _assertThisInitialized(_this2); // Set the base url.\n\n    if (_this2.options.baseUrl) {\n      _Formio.GlobalFormio.setBaseUrl(_this2.options.baseUrl);\n    }\n    /**\n     * The i18n configuration for this component.\n     */\n\n    var i18n = _i18n.default;\n    if (options && options.i18n && !options.i18nReady) {\n      // Support legacy way of doing translations.\n      if (options.i18n.resources) {\n        i18n = options.i18n;\n      } else {\n        _lodash.default.each(options.i18n, function (lang, code) {\n          if (code === 'options') {\n            _lodash.default.merge(i18n, lang);\n          } else if (!i18n.resources[code]) {\n            // extend the default translations (validations, buttons etc.) in case they are not in the options.\n            i18n.resources[code] = {\n              translation: _lodash.default.assign((0, _utils.fastCloneDeep)(_i18n.default.resources.en.translation), lang)\n            };\n          } else {\n            _lodash.default.assign(i18n.resources[code].translation, lang);\n          }\n        });\n      }\n      options.i18n = i18n;\n      options.i18nReady = true;\n    }\n    if (options && options.i18n) {\n      _this2.options.i18n = options.i18n;\n    } else {\n      _this2.options.i18n = i18n;\n    } // Set the language.\n\n    if (_this2.options.language) {\n      _this2.options.i18n.lng = _this2.options.language;\n    }\n    /**\n     * The type of this element.\n     * @type {string}\n     */\n\n    _this2.type = 'form';\n    _this2._src = '';\n    _this2._loading = false;\n    _this2._form = {};\n    _this2.draftEnabled = false;\n    _this2.savingDraft = true;\n    if (_this2.options.saveDraftThrottle) {\n      _this2.triggerSaveDraft = _lodash.default.throttle(_this2.saveDraft.bind(_assertThisInitialized(_this2)), _this2.options.saveDraftThrottle);\n    } else {\n      _this2.triggerSaveDraft = _this2.saveDraft.bind(_assertThisInitialized(_this2));\n    }\n    _this2.customErrors = [];\n    /**\n     * Determines if this form should submit the API on submit.\n     * @type {boolean}\n     */\n\n    _this2.nosubmit = false;\n    /**\n     * Determines if the form has tried to be submitted, error or not.\n     *\n     * @type {boolean}\n     */\n\n    _this2.submitted = false;\n    /**\n     * Determines if the form is being submitted at the moment.\n     *\n     * @type {boolean}\n     */\n\n    _this2.submitting = false;\n    /**\n     * The Formio instance for this form.\n     * @type {Formio}\n     */\n\n    _this2.formio = null;\n    /**\n     * The loader HTML element.\n     * @type {HTMLElement}\n     */\n\n    _this2.loader = null;\n    /**\n     * The alert HTML element\n     * @type {HTMLElement}\n     */\n\n    _this2.alert = null;\n    /**\n     * Promise that is triggered when the submission is done loading.\n     * @type {Promise}\n     */\n\n    _this2.onSubmission = null;\n    /**\n     * Determines if this submission is explicitly set.\n     * @type {boolean}\n     */\n\n    _this2.submissionSet = false;\n    /**\n     * Promise that executes when the form is ready and rendered.\n     * @type {Promise}\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.formReady.then(() => {\n     *   console.log('The form is ready!');\n     * });\n     * form.src = 'https://examples.form.io/example';\n     */\n\n    _this2.formReady = new _nativePromiseOnly.default(function (resolve, reject) {\n      /**\n       * Called when the formReady state of this form has been resolved.\n       *\n       * @type {function}\n       */\n      _this2.formReadyResolve = resolve;\n      /**\n       * Called when this form could not load and is rejected.\n       *\n       * @type {function}\n       */\n\n      _this2.formReadyReject = reject;\n    });\n    /**\n     * Promise that executes when the submission is ready and rendered.\n     * @type {Promise}\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.submissionReady.then(() => {\n     *   console.log('The submission is ready!');\n     * });\n     * form.src = 'https://examples.form.io/example/submission/234234234234234243';\n     */\n\n    _this2.submissionReady = new _nativePromiseOnly.default(function (resolve, reject) {\n      /**\n       * Called when the formReady state of this form has been resolved.\n       *\n       * @type {function}\n       */\n      _this2.submissionReadyResolve = resolve;\n      /**\n       * Called when this form could not load and is rejected.\n       *\n       * @type {function}\n       */\n\n      _this2.submissionReadyReject = reject;\n    });\n    _this2.shortcuts = []; // Set language after everything is established.\n\n    _this2.localize().then(function () {\n      _this2.language = _this2.options.language;\n    }); // See if we need to restore the draft from a user.\n\n    if (_this2.options.saveDraft && !_this2.options.skipDraftRestore) {\n      var user = _Formio.GlobalFormio.getUser(); // Only restore a draft if the submission isn't explicitly set.\n\n      if (user && !_this2.submissionSet) {\n        _this2.restoreDraft(user._id);\n      }\n    }\n    _this2.component.clearOnHide = false; // Ensure the root is set to this component.\n\n    _this2.root = _assertThisInitialized(_this2);\n    _this2.localRoot = _assertThisInitialized(_this2);\n    return _this2;\n  }\n  /* eslint-enable max-statements */\n\n  _createClass(Webform, [{\n    key: \"language\",\n    get: function get() {\n      return this.options.language;\n    },\n    set:\n    /**\n     * Sets the language for this form.\n     *\n     * @param lang\n     * @return {Promise}\n     */\n    function set(lang) {\n      var _this3 = this;\n      this.options.language = lang;\n      if (this.i18next.language === lang) {\n        return;\n      }\n      try {\n        this.i18next.changeLanguage(lang, function (err) {\n          if (err) {\n            return;\n          }\n          _this3.redraw();\n          _this3.emit('languageChanged');\n        });\n      } catch (err) {\n        return;\n      }\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"componentContext\",\n    value: function componentContext() {\n      return this._data;\n    }\n  }, {\n    key: \"componentComponents\",\n    get: function get() {\n      return this.form.components;\n    }\n  }, {\n    key: \"shadowRoot\",\n    get: function get() {\n      return this.options.shadowRoot;\n    }\n    /**\n     * Add a language for translations\n     *\n     * @param code\n     * @param lang\n     * @param active\n     * @return {*}\n     */\n  }, {\n    key: \"addLanguage\",\n    value: function addLanguage(code, lang) {\n      var active = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var translations = _lodash.default.assign((0, _utils.fastCloneDeep)(_i18n.default.resources.en.translation), lang);\n      this.i18next.addResourceBundle(code, 'translation', translations, true, true);\n      if (active) {\n        this.language = code;\n      }\n    }\n    /**\n     * Perform the localization initialization.\n     * @returns {*}\n     */\n  }, {\n    key: \"localize\",\n    value: function localize() {\n      var _this4 = this;\n      if (this.i18next.initialized) {\n        return _nativePromiseOnly.default.resolve(this.i18next);\n      }\n      this.i18next.initialized = true;\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        try {\n          _this4.i18next.init(_objectSpread(_objectSpread({}, _this4.options.i18n), {\n            compatibilityJSON: 'v3'\n          }), function (err) {\n            // Get language but remove any ;q=1 that might exist on it.\n            _this4.options.language = _this4.i18next.language.split(';')[0];\n            if (err) {\n              return reject(err);\n            }\n            resolve(_this4.i18next);\n          });\n        } catch (err) {\n          return reject(err);\n        }\n      });\n    }\n  }, {\n    key: \"keyboardCatchableElement\",\n    value: function keyboardCatchableElement(element) {\n      if (element.nodeName === 'TEXTAREA') {\n        return false;\n      }\n      if (element.nodeName === 'INPUT') {\n        return ['text', 'email', 'password'].indexOf(element.type) === -1;\n      }\n      return true;\n    }\n  }, {\n    key: \"addShortcut\",\n    value: function addShortcut(element, shortcut) {\n      if (!shortcut || !/^([A-Z]|Enter|Esc)$/i.test(shortcut)) {\n        return;\n      }\n      shortcut = _lodash.default.capitalize(shortcut);\n      if (shortcut === 'Enter' || shortcut === 'Esc') {\n        // Restrict Enter and Esc only for buttons\n        if (element.tagName !== 'BUTTON') {\n          return;\n        }\n        this.shortcuts.push({\n          shortcut: shortcut,\n          element: element\n        });\n      } else {\n        this.shortcuts.push({\n          ctrl: true,\n          shortcut: shortcut,\n          element: element\n        });\n      }\n    }\n  }, {\n    key: \"removeShortcut\",\n    value: function removeShortcut(element, shortcut) {\n      if (!shortcut || !/^([A-Z]|Enter|Esc)$/i.test(shortcut)) {\n        return;\n      }\n      _lodash.default.remove(this.shortcuts, {\n        shortcut: shortcut,\n        element: element\n      });\n    }\n    /**\n     * Get the embed source of the form.\n     *\n     * @returns {string}\n     */\n  }, {\n    key: \"src\",\n    get: function get() {\n      return this._src;\n    }\n    /**\n     * Loads the submission if applicable.\n     */,\n\n    set:\n    /**\n     * Set the Form source, which is typically the Form.io embed URL.\n     *\n     * @param {string} value - The value of the form embed url.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.formReady.then(() => {\n     *   console.log('The form is formReady!');\n     * });\n     * form.src = 'https://examples.form.io/example';\n     */\n    function set(value) {\n      this.setSrc(value);\n    }\n    /**\n     * Get the embed source of the form.\n     *\n     * @returns {string}\n     */\n  }, {\n    key: \"loadSubmission\",\n    value: function loadSubmission() {\n      var _this5 = this;\n      this.loadingSubmission = true;\n      if (this.formio.submissionId) {\n        this.onSubmission = this.formio.loadSubmission().then(function (submission) {\n          return _this5.setSubmission(submission);\n        }, function (err) {\n          return _this5.submissionReadyReject(err);\n        }).catch(function (err) {\n          return _this5.submissionReadyReject(err);\n        });\n      } else {\n        this.submissionReadyResolve();\n      }\n      return this.submissionReady;\n    }\n    /**\n     * Set the src of the form renderer.\n     *\n     * @param value\n     * @param options\n     */\n  }, {\n    key: \"setSrc\",\n    value: function setSrc(value, options) {\n      var _this6 = this;\n      if (this.setUrl(value, options)) {\n        this.nosubmit = false;\n        return this.formio.loadForm({\n          params: {\n            live: 1\n          }\n        }).then(function (form) {\n          var setForm = _this6.setForm(form);\n          _this6.loadSubmission();\n          return setForm;\n        }).catch(function (err) {\n          console.warn(err);\n          _this6.formReadyReject(err);\n        });\n      }\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this._src;\n    }\n    /**\n     * Sets the url of the form renderer.\n     *\n     * @param value\n     * @param options\n     */,\n\n    set:\n    /**\n     * Set the form source but don't initialize the form and submission from the url.\n     *\n     * @param {string} value - The value of the form embed url.\n     */\n    function set(value) {\n      this.setUrl(value);\n    }\n    /**\n     * Called when both the form and submission have been loaded.\n     *\n     * @returns {Promise} - The promise to trigger when both form and submission have loaded.\n     */\n  }, {\n    key: \"setUrl\",\n    value: function setUrl(value, options) {\n      if (!value || typeof value !== 'string' || value === this._src) {\n        return false;\n      }\n      this._src = value;\n      this.nosubmit = true;\n      this.formio = this.options.formio = new _Formio.GlobalFormio(value, options);\n      if (this.type === 'form') {\n        // Set the options source so this can be passed to other components.\n        this.options.src = value;\n      }\n      return true;\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      var _this7 = this;\n      return this.formReady.then(function () {\n        return _get(_getPrototypeOf(Webform.prototype), \"ready\", _this7).then(function () {\n          return _this7.loadingSubmission ? _this7.submissionReady : true;\n        });\n      });\n    }\n    /**\n     * Returns if this form is loading.\n     *\n     * @returns {boolean} - TRUE means the form is loading, FALSE otherwise.\n     */\n  }, {\n    key: \"loading\",\n    get: function get() {\n      return this._loading;\n    }\n    /**\n     * Set the loading state for this form, and also show the loader spinner.\n     *\n     * @param {boolean} loading - If this form should be \"loading\" or not.\n     */,\n\n    set: function set(loading) {\n      if (this._loading !== loading) {\n        this._loading = loading;\n        if (!this.loader && loading) {\n          this.loader = this.ce('div', {\n            class: 'loader-wrapper'\n          });\n          var spinner = this.ce('div', {\n            class: 'loader text-center'\n          });\n          this.loader.appendChild(spinner);\n        }\n        /* eslint-disable max-depth */\n\n        if (this.loader) {\n          try {\n            if (loading) {\n              this.prependTo(this.loader, this.wrapper);\n            } else {\n              this.removeChildFrom(this.loader, this.wrapper);\n            }\n          } catch (err) {// ingore\n          }\n        }\n        /* eslint-enable max-depth */\n      }\n    }\n    /**\n     * Sets the JSON schema for the form to be rendered.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.setForm({\n     *   components: [\n     *     {\n     *       type: 'textfield',\n     *       key: 'firstName',\n     *       label: 'First Name',\n     *       placeholder: 'Enter your first name.',\n     *       input: true\n     *     },\n     *     {\n     *       type: 'textfield',\n     *       key: 'lastName',\n     *       label: 'Last Name',\n     *       placeholder: 'Enter your last name',\n     *       input: true\n     *     },\n     *     {\n     *       type: 'button',\n     *       action: 'submit',\n     *       label: 'Submit',\n     *       theme: 'primary'\n     *     }\n     *   ]\n     * });\n     *\n     * @param {Object} form - The JSON schema of the form @see https://examples.form.io/example for an example JSON schema.\n     * @param flags\n     * @returns {*}\n     */\n  }, {\n    key: \"setForm\",\n    value: function setForm(form, flags) {\n      var _this$_form$component,\n        _this8 = this;\n      var isFormAlreadySet = this._form && ((_this$_form$component = this._form.components) === null || _this$_form$component === void 0 ? void 0 : _this$_form$component.length);\n      try {\n        var _this$parent, _this$parent$componen;\n\n        // Do not set the form again if it has been already set\n        if (isFormAlreadySet && JSON.stringify(this._form) === JSON.stringify(form)) {\n          return _nativePromiseOnly.default.resolve();\n        } // Create the form.\n\n        this._form = flags !== null && flags !== void 0 && flags.keepAsReference ? form : _lodash.default.cloneDeep(form);\n        if (this.onSetForm) {\n          this.onSetForm(_lodash.default.cloneDeep(this._form), form);\n        }\n        if ((_this$parent = this.parent) !== null && _this$parent !== void 0 && (_this$parent$componen = _this$parent.component) !== null && _this$parent$componen !== void 0 && _this$parent$componen.modalEdit) {\n          return _nativePromiseOnly.default.resolve();\n        }\n      } catch (err) {\n        console.warn(err); // If provided form is not a valid JSON object, do not set it too\n\n        return _nativePromiseOnly.default.resolve();\n      } // Allow the form to provide component overrides.\n\n      if (form && form.settings && form.settings.components) {\n        this.options.components = form.settings.components;\n      }\n      if (form && form.properties) {\n        this.options.properties = form.properties;\n      }\n      if ('schema' in form && (0, _compareVersions.default)(form.schema, '1.x') > 0) {\n        this.ready.then(function () {\n          _this8.setAlert('alert alert-danger', 'Form schema is for a newer version, please upgrade your renderer. Some functionality may not work.');\n        });\n      } // See if they pass a module, and evaluate it if so.\n\n      if (form && form.module) {\n        var formModule = null;\n        if (typeof form.module === 'string') {\n          try {\n            formModule = this.evaluate(\"return \".concat(form.module));\n          } catch (err) {\n            console.warn(err);\n          }\n        } else {\n          formModule = form.module;\n        }\n        if (formModule) {\n          _Formio.GlobalFormio.use(formModule); // Since we got here after instantiation, we need to manually apply form options.\n\n          if (formModule.options && formModule.options.form) {\n            this.options = Object.assign(this.options, formModule.options.form);\n          }\n        }\n      }\n      this.initialized = false;\n      var rebuild = this.rebuild() || _nativePromiseOnly.default.resolve();\n      return rebuild.then(function () {\n        _this8.emit('formLoad', form);\n        _this8.triggerRecaptcha(); // Make sure to trigger onChange after a render event occurs to speed up form rendering.\n\n        setTimeout(function () {\n          _this8.onChange(flags);\n          _this8.formReadyResolve();\n        }, 0);\n        return _this8.formReady;\n      });\n    }\n    /**\n     * Gets the form object.\n     *\n     * @returns {Object} - The form JSON schema.\n     */\n  }, {\n    key: \"form\",\n    get: function get() {\n      if (!this._form) {\n        this._form = {\n          components: []\n        };\n      }\n      return this._form;\n    }\n    /**\n     * Sets the form value.\n     *\n     * @alias setForm\n     * @param {Object} form - The form schema object.\n     */,\n\n    set: function set(form) {\n      this.setForm(form);\n    }\n    /**\n     * Returns the submission object that was set within this form.\n     *\n     * @returns {Object}\n     */\n  }, {\n    key: \"submission\",\n    get: function get() {\n      return this.getValue();\n    }\n    /**\n     * Sets the submission of a form.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.src = 'https://examples.form.io/example';\n     * form.submission = {data: {\n     *   firstName: 'Joe',\n     *   lastName: 'Smith',\n     *   email: 'joe@example.com'\n     * }};\n     *\n     * @param {Object} submission - The Form.io submission object.\n     */,\n\n    set: function set(submission) {\n      this.setSubmission(submission);\n    }\n    /**\n     * Sets a submission and returns the promise when it is ready.\n     * @param submission\n     * @param flags\n     * @return {Promise.<TResult>}\n     */\n  }, {\n    key: \"setSubmission\",\n    value: function setSubmission(submission) {\n      var _this9 = this;\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      flags = _objectSpread(_objectSpread({}, flags), {}, {\n        fromSubmission: _lodash.default.has(flags, 'fromSubmission') ? flags.fromSubmission : true\n      });\n      return this.onSubmission = this.formReady.then(function (resolveFlags) {\n        if (resolveFlags) {\n          flags = _objectSpread(_objectSpread({}, flags), resolveFlags);\n        }\n        _this9.submissionSet = true;\n        _this9.triggerChange(flags);\n        _this9.setValue(submission, flags);\n        return _this9.submissionReadyResolve(submission);\n      }, function (err) {\n        return _this9.submissionReadyReject(err);\n      }).catch(function (err) {\n        return _this9.submissionReadyReject(err);\n      });\n    }\n    /**\n     * Saves a submission draft.\n     */\n  }, {\n    key: \"saveDraft\",\n    value: function saveDraft() {\n      var _this10 = this;\n      if (!this.draftEnabled) {\n        return;\n      }\n      if (!this.formio) {\n        console.warn(this.t('saveDraftInstanceError'));\n        return;\n      }\n      if (!_Formio.GlobalFormio.getUser()) {\n        console.warn(this.t('saveDraftAuthError'));\n        return;\n      }\n      var draft = (0, _utils.fastCloneDeep)(this.submission);\n      draft.state = 'draft';\n      if (!this.savingDraft) {\n        this.emit('saveDraftBegin');\n        this.savingDraft = true;\n        this.formio.saveSubmission(draft).then(function (sub) {\n          // Set id to submission to avoid creating new draft submission\n          _this10.submission._id = sub._id;\n          _this10.savingDraft = false;\n          _this10.emit('saveDraft', sub);\n        });\n      }\n    }\n    /**\n     * Restores a draft submission based on the user who is authenticated.\n     *\n     * @param {userId} - The user id where we need to restore the draft from.\n     */\n  }, {\n    key: \"restoreDraft\",\n    value: function restoreDraft(userId) {\n      var _this11 = this;\n      if (!this.formio) {\n        console.warn(this.t('restoreDraftInstanceError'));\n        return;\n      }\n      this.savingDraft = true;\n      this.formio.loadSubmissions({\n        params: {\n          state: 'draft',\n          owner: userId\n        }\n      }).then(function (submissions) {\n        if (submissions.length > 0 && !_this11.options.skipDraftRestore) {\n          var draft = (0, _utils.fastCloneDeep)(submissions[0]);\n          return _this11.setSubmission(draft).then(function () {\n            _this11.draftEnabled = true;\n            _this11.savingDraft = false;\n            _this11.emit('restoreDraft', draft);\n          });\n        } // Enable drafts so that we can keep track of changes.\n\n        _this11.draftEnabled = true;\n        _this11.savingDraft = false;\n        _this11.emit('restoreDraft', null);\n      });\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      var schema = (0, _utils.fastCloneDeep)(_lodash.default.omit(this._form, ['components']));\n      schema.components = [];\n      this.eachComponent(function (component) {\n        return schema.components.push(component.schema);\n      });\n      return schema;\n    }\n  }, {\n    key: \"mergeData\",\n    value: function mergeData(_this, _that) {\n      _lodash.default.mergeWith(_this, _that, function (thisValue, thatValue) {\n        if (Array.isArray(thisValue) && Array.isArray(thatValue) && thisValue.length !== thatValue.length) {\n          return thatValue;\n        }\n      });\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      if (!submission || !submission.data) {\n        submission = {\n          data: {}\n        };\n      } // Metadata needs to be available before setValue\n\n      this._submission.metadata = submission.metadata || {};\n      this.editing = !!submission._id; // Set the timezone in the options if available.\n\n      if (!this.options.submissionTimezone && submission.metadata && submission.metadata.timezone) {\n        this.options.submissionTimezone = submission.metadata.timezone;\n      }\n      var changed = _get(_getPrototypeOf(Webform.prototype), \"setValue\", this).call(this, submission.data, flags);\n      if (!flags.sanitize) {\n        this.mergeData(this.data, submission.data);\n      }\n      submission.data = this.data;\n      this._submission = submission;\n      return changed;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (!this._submission.data) {\n        this._submission.data = {};\n      }\n      if (this.viewOnly) {\n        return this._submission;\n      }\n      var submission = this._submission;\n      submission.data = this.data;\n      return this._submission;\n    }\n    /**\n     * Build the form.\n     */\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this12 = this;\n      this._submission = this._submission || {\n        data: {}\n      }; // Remove any existing components.\n\n      if (this.components && this.components.length) {\n        this.destroyComponents();\n        this.components = [];\n      }\n      if (this.component) {\n        this.component.components = this.form ? this.form.components : [];\n      } else {\n        this.component = this.form;\n      }\n      this.component.type = 'form';\n      this.component.input = false;\n      this.addComponents();\n      this.on('submitButton', function (options) {\n        _this12.submit(false, options).catch(function (e) {\n          return e !== false && console.log(e);\n        });\n      }, true);\n      this.on('checkValidity', function (data) {\n        return _this12.checkValidity(data, true, data);\n      }, true);\n      this.on('requestUrl', function (args) {\n        return _this12.submitUrl(args.url, args.headers);\n      }, true);\n      this.on('resetForm', function () {\n        return _this12.resetValue();\n      }, true);\n      this.on('deleteSubmission', function () {\n        return _this12.deleteSubmission();\n      }, true);\n      this.on('refreshData', function () {\n        return _this12.updateValue();\n      }, true);\n      this.executeFormController();\n      return this.formReady;\n    }\n  }, {\n    key: \"executeFormController\",\n    value: function executeFormController() {\n      var _this13 = this;\n\n      // If no controller value or\n      // hidden and set to clearOnHide (Don't calculate a value for a hidden field set to clear when hidden)\n      if (!this.form || !this.form.controller || (!this.visible || this.component.hidden) && this.component.clearOnHide && !this.rootPristine) {\n        return false;\n      }\n      this.formReady.then(function () {\n        _this13.evaluate(_this13.form.controller, {\n          components: _this13.components,\n          instance: _this13\n        });\n      });\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var deleteFromGlobal = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      this.off('submitButton');\n      this.off('checkValidity');\n      this.off('requestUrl');\n      this.off('resetForm');\n      this.off('deleteSubmission');\n      this.off('refreshData');\n      if (deleteFromGlobal) {\n        this.emit('formDelete', this.id);\n        delete _Formio.GlobalFormio.forms[this.id];\n      }\n      return _get(_getPrototypeOf(Webform.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"build\",\n    value: function build(element) {\n      var _this14 = this;\n      if (element || this.element) {\n        return this.ready.then(function () {\n          element = element || _this14.element;\n          _get(_getPrototypeOf(Webform.prototype), \"build\", _this14).call(_this14, element);\n        });\n      }\n      return this.ready;\n    }\n  }, {\n    key: \"getClassName\",\n    value: function getClassName() {\n      var classes = 'formio-form';\n      if (this.options.readOnly) {\n        classes += ' formio-read-only';\n      }\n      return classes;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _get(_getPrototypeOf(Webform.prototype), \"render\", this).call(this, this.renderTemplate('webform', {\n        classes: this.getClassName(),\n        children: this.renderComponents()\n      }), this.builderMode ? 'builder' : 'form', true);\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      // Don't bother if we have not built yet.\n      if (!this.element) {\n        return _nativePromiseOnly.default.resolve();\n      }\n      this.clear();\n      this.setContent(this.element, this.render());\n      return this.attach(this.element);\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this15 = this;\n      this.element = element;\n      this.loadRefs(element, {\n        webform: 'single'\n      });\n      var childPromise = this.attachComponents(this.refs.webform);\n      this.addEventListener(document, 'keydown', this.executeShortcuts);\n      this.currentForm = this;\n      this.hook('attachWebform', element, this);\n      return childPromise.then(function () {\n        _this15.emit('render', _this15.element);\n        return _this15.setValue(_this15._submission, {\n          noUpdateEvent: true\n        });\n      });\n    }\n  }, {\n    key: \"hasRequiredFields\",\n    value: function hasRequiredFields() {\n      var result = false;\n      (0, _formUtils.eachComponent)(this.form.components, function (component) {\n        if (component.validate.required) {\n          result = true;\n          return true;\n        }\n      }, true);\n      return result;\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _lodash.default.each(this.getComponents(), function (comp) {\n        return comp.resetValue();\n      });\n      this.setPristine(true);\n      this.onChange();\n    }\n    /**\n     * Sets a new alert to display in the error dialog of the form.\n     *\n     * @param {string} type - The type of alert to display. \"danger\", \"success\", \"warning\", etc.\n     * @param {string} message - The message to show in the alert.\n     * @param {Object} options\n     */\n  }, {\n    key: \"setAlert\",\n    value: function setAlert(type, message, options) {\n      var _this16 = this;\n      if (!type && this.submitted) {\n        if (this.alert) {\n          if (this.refs.errorRef && this.refs.errorRef.length) {\n            this.refs.errorRef.forEach(function (el) {\n              _this16.removeEventListener(el, 'click');\n              _this16.removeEventListener(el, 'keypress');\n            });\n          }\n          this.removeChild(this.alert);\n          this.alert = null;\n        }\n        return;\n      }\n      if (this.options.noAlerts) {\n        if (!message) {\n          this.emit('error', false);\n        }\n        return;\n      }\n      if (this.alert) {\n        try {\n          if (this.refs.errorRef && this.refs.errorRef.length) {\n            this.refs.errorRef.forEach(function (el) {\n              _this16.removeEventListener(el, 'click');\n              _this16.removeEventListener(el, 'keypress');\n            });\n          }\n          this.removeChild(this.alert);\n          this.alert = null;\n        } catch (err) {// ignore\n        }\n      }\n      if (message) {\n        var attrs = {\n          class: options && options.classes || \"alert alert-\".concat(type),\n          id: \"error-list-\".concat(this.id)\n        };\n        var templateOptions = {\n          message: message instanceof HTMLElement ? message.outerHTML : message,\n          attrs: attrs,\n          type: type\n        };\n        this.alert = (0, _utils.convertStringToHTMLElement)(this.renderTemplate('alert', templateOptions), \"#\".concat(attrs.id));\n      }\n      if (!this.alert) {\n        return;\n      }\n      this.loadRefs(this.alert, {\n        errorRef: 'multiple'\n      });\n      if (this.refs.errorRef && this.refs.errorRef.length) {\n        this.refs.errorRef.forEach(function (el) {\n          _this16.addEventListener(el, 'click', function (e) {\n            var key = e.currentTarget.dataset.componentKey;\n            _this16.focusOnComponent(key);\n          });\n          _this16.addEventListener(el, 'keydown', function (e) {\n            if (e.keyCode === 13) {\n              e.preventDefault();\n              var key = e.currentTarget.dataset.componentKey;\n              _this16.focusOnComponent(key);\n            }\n          });\n        });\n      }\n      this.prepend(this.alert);\n    }\n    /**\n     * Focus on selected component.\n     *\n     * @param {string} key - The key of selected component.\n     * @returns {*}\n     */\n  }, {\n    key: \"focusOnComponent\",\n    value: function focusOnComponent(key) {\n      if (key) {\n        var component = this.getComponent(key);\n        if (component) {\n          component.focus();\n        }\n      }\n    }\n    /**\n     * Show the errors of this form within the alert dialog.\n     *\n     * @param {Object} error - An optional additional error to display along with the component errors.\n     * @returns {*}\n     */\n\n    /* eslint-disable no-unused-vars */\n  }, {\n    key: \"showErrors\",\n    value: function showErrors(error, triggerEvent, onChange) {\n      var _this17 = this;\n      this.loading = false;\n      var errors = this.errors;\n      if (error) {\n        if (Array.isArray(error)) {\n          errors = errors.concat(error);\n        } else {\n          errors.push(error);\n        }\n      } else {\n        errors = _get(_getPrototypeOf(Webform.prototype), \"errors\", this);\n      }\n      errors = errors.concat(this.customErrors);\n      if (!errors.length) {\n        this.setAlert(false);\n        return;\n      } // Mark any components as invalid if in a custom message.\n\n      errors.forEach(function (err) {\n        var _err$components = err.components,\n          components = _err$components === void 0 ? [] : _err$components;\n        if (err.component) {\n          components.push(err.component);\n        }\n        if (err.path) {\n          components.push(err.path);\n        }\n        components.forEach(function (path) {\n          var originalPath = _this17._parentPath + (0, _utils.getStringFromComponentPath)(path);\n          var component = _this17.getComponent(path, _lodash.default.identity, originalPath);\n          if (err.fromServer) {\n            if (component.serverErrors) {\n              component.serverErrors.push(err);\n            } else {\n              component.serverErrors = [err];\n            }\n          }\n          var components = _lodash.default.compact(Array.isArray(component) ? component : [component]);\n          components.forEach(function (component) {\n            return component.setCustomValidity(err.message, true);\n          });\n        });\n      });\n      var displayedErrors = [];\n      errors.forEach(function (err) {\n        if (err) {\n          var createListItem = function createListItem(message, index) {\n            var messageFromIndex = !_lodash.default.isUndefined(index) && err.messages && err.messages[index];\n            var keyOrPath = messageFromIndex && messageFromIndex.formattedKeyOrPath || messageFromIndex.path || err.component && err.component.key || err.fromServer && err.path;\n            var formattedKeyOrPath = keyOrPath ? (0, _utils.getStringFromComponentPath)(keyOrPath) : '';\n            formattedKeyOrPath = _this17._parentPath + formattedKeyOrPath;\n            if (typeof err !== 'string' && !err.formattedKeyOrPath) {\n              err.formattedKeyOrPath = formattedKeyOrPath;\n            }\n            return {\n              message: (0, _utils.unescapeHTML)(message),\n              keyOrPath: formattedKeyOrPath\n            };\n          };\n          err.messages = _lodash.default.uniqBy(err.messages, function (message) {\n            return message.message;\n          });\n          if (err.messages && err.messages.length) {\n            var component = err.component;\n            err.messages.forEach(function (_ref, index) {\n              var message = _ref.message,\n                context = _ref.context,\n                fromServer = _ref.fromServer;\n              var text = context !== null && context !== void 0 && context.hasLabel || fromServer ? _this17.t('alertMessage', {\n                message: _this17.t(message)\n              }) : _this17.t('alertMessageWithLabel', {\n                label: _this17.t(component.label),\n                message: _this17.t(message)\n              });\n              displayedErrors.push(createListItem(text, index));\n            });\n          } else if (err) {\n            var message = _lodash.default.isObject(err) ? _this17.t('alertMessage', {\n              message: _this17.t(err.message || '')\n            }) : _this17.t('alertMessage', {\n              message: _this17.t(err)\n            });\n            displayedErrors.push(createListItem(message));\n          }\n        }\n      });\n      var errorsList = this.renderTemplate('errorsList', {\n        errors: displayedErrors\n      });\n      this.root.setAlert('danger', errorsList);\n      if (triggerEvent) {\n        this.emit('error', errors);\n      }\n      return errors;\n    }\n    /* eslint-enable no-unused-vars */\n\n    /**\n     * Called when the submission has completed, or if the submission needs to be sent to an external library.\n     *\n     * @param {Object} submission - The submission object.\n     * @param {boolean} saved - Whether or not this submission was saved to the server.\n     * @returns {object} - The submission object.\n     */\n  }, {\n    key: \"onSubmit\",\n    value: function onSubmit(submission, saved) {\n      var _this$triggerSaveDraf;\n      this.loading = false;\n      this.submitting = false;\n      this.setPristine(true); // We want to return the submitted submission and setValue will mutate the submission so cloneDeep it here.\n\n      this.setValue((0, _utils.fastCloneDeep)(submission), {\n        noValidate: true,\n        noCheck: true\n      });\n      this.setAlert('success', \"<p>\".concat(this.t('complete'), \"</p>\")); // Cancel triggered saveDraft to prevent overriding the submitted state\n\n      if (this.draftEnabled && (_this$triggerSaveDraf = this.triggerSaveDraft) !== null && _this$triggerSaveDraf !== void 0 && _this$triggerSaveDraf.cancel) {\n        this.triggerSaveDraft.cancel();\n      }\n      this.emit('submit', submission, saved);\n      if (saved) {\n        this.emit('submitDone', submission);\n      }\n      return submission;\n    }\n  }, {\n    key: \"normalizeError\",\n    value: function normalizeError(error) {\n      if (error) {\n        if (_typeof(error) === 'object' && 'details' in error) {\n          error = error.details;\n        }\n        if (typeof error === 'string') {\n          error = {\n            message: error\n          };\n        }\n      }\n      return error;\n    }\n    /**\n     * Called when an error occurs during the submission.\n     *\n     * @param {Object} error - The error that occured.\n     */\n  }, {\n    key: \"onSubmissionError\",\n    value: function onSubmissionError(error) {\n      error = this.normalizeError(error);\n      this.submitting = false;\n      this.setPristine(false);\n      this.emit('submitError', error); // Allow for silent cancellations (no error message, no submit button error state)\n\n      if (error && error.silent) {\n        this.emit('change', {\n          isValid: true\n        }, {\n          silent: true\n        });\n        return false;\n      }\n      var errors = this.showErrors(error, true);\n      if (this.root && this.root.alert) {\n        this.scrollIntoView(this.root.alert);\n      }\n      return errors;\n    }\n    /**\n     * Trigger the change event for this form.\n     *\n     * @param changed\n     * @param flags\n     */\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, changed, modified, changes) {\n      flags = flags || {};\n      var isChangeEventEmitted = false; // For any change events, clear any custom errors for that component.\n\n      if (changed && changed.component) {\n        this.customErrors = this.customErrors.filter(function (err) {\n          return err.component && err.component !== changed.component.key;\n        });\n      }\n      _get(_getPrototypeOf(Webform.prototype), \"onChange\", this).call(this, flags, true);\n      var value = _lodash.default.clone(this.submission);\n      flags.changed = value.changed = changed;\n      flags.changes = changes;\n      if (modified && this.pristine) {\n        this.pristine = false;\n      }\n      value.isValid = this.checkData(value.data, flags);\n      this.loading = false;\n      if (this.submitted) {\n        this.showErrors();\n      } // See if we need to save the draft of the form.\n\n      if (modified && this.options.saveDraft) {\n        this.triggerSaveDraft();\n      }\n      if (!flags || !flags.noEmit) {\n        this.emit('change', value, flags, modified);\n        isChangeEventEmitted = true;\n      } // The form is initialized after the first change event occurs.\n\n      if (isChangeEventEmitted && !this.initialized) {\n        this.emit('initialized');\n        this.initialized = true;\n      }\n    }\n  }, {\n    key: \"checkData\",\n    value: function checkData(data) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var valid = _get(_getPrototypeOf(Webform.prototype), \"checkData\", this).call(this, data, flags);\n      if ((_lodash.default.isEmpty(flags) || flags.noValidate) && this.submitted) {\n        this.showErrors();\n      }\n      return valid;\n    }\n    /**\n     * Send a delete request to the server.\n     */\n  }, {\n    key: \"deleteSubmission\",\n    value: function deleteSubmission() {\n      var _this18 = this;\n      return this.formio.deleteSubmission().then(function () {\n        _this18.emit('submissionDeleted', _this18.submission);\n        _this18.resetValue();\n      });\n    }\n    /**\n     * Cancels the submission.\n     *\n     * @alias reset\n     */\n  }, {\n    key: \"cancel\",\n    value: function cancel(noconfirm) {\n      var shouldReset = this.hook('beforeCancel', true);\n      if (shouldReset && (noconfirm || confirm(this.t('confirmCancel')))) {\n        this.resetValue();\n        return true;\n      } else {\n        this.emit('cancelSubmit');\n        return false;\n      }\n    }\n  }, {\n    key: \"setMetadata\",\n    value: function setMetadata(submission) {\n      // Add in metadata about client submitting the form\n      submission.metadata = submission.metadata || {};\n      _lodash.default.defaults(submission.metadata, {\n        timezone: _lodash.default.get(this, '_submission.metadata.timezone', (0, _utils.currentTimezone)()),\n        offset: parseInt(_lodash.default.get(this, '_submission.metadata.offset', (0, _moment.default)().utcOffset()), 10),\n        origin: document.location.origin,\n        referrer: document.referrer,\n        browserName: navigator.appName,\n        userAgent: navigator.userAgent,\n        pathName: window.location.pathname,\n        onLine: navigator.onLine\n      });\n    }\n  }, {\n    key: \"submitForm\",\n    value: function submitForm() {\n      var _this19 = this;\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.clearServerErrors();\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        // Read-only forms should never submit.\n        if (_this19.options.readOnly) {\n          return resolve({\n            submission: _this19.submission,\n            saved: false\n          });\n        }\n        var submission = (0, _utils.fastCloneDeep)(_this19.submission || {});\n        _this19.setMetadata(submission);\n        submission.state = options.state || 'submitted';\n        var isDraft = submission.state === 'draft';\n        _this19.hook('beforeSubmit', _objectSpread(_objectSpread({}, submission), {}, {\n          component: options.component\n        }), function (err, data) {\n          if (err) {\n            return reject(err);\n          }\n          submission._vnote = data && data._vnote ? data._vnote : '';\n          if (!isDraft && !submission.data) {\n            return reject('Invalid Submission');\n          }\n          if (!isDraft && !_this19.checkValidity(submission.data, true)) {\n            return reject();\n          }\n          _this19.everyComponent(function (comp) {\n            var persistent = comp.component.persistent;\n            if (persistent === 'client-only') {\n              _lodash.default.unset(submission.data, comp.path);\n            }\n          });\n          _this19.hook('customValidation', _objectSpread(_objectSpread({}, submission), {}, {\n            component: options.component\n          }), function (err) {\n            if (err) {\n              // If string is returned, cast to object.\n              if (typeof err === 'string') {\n                err = {\n                  message: err\n                };\n              } // Ensure err is an array.\n\n              err = Array.isArray(err) ? err : [err]; // Set as custom errors.\n\n              _this19.customErrors = err;\n              return reject();\n            }\n            _this19.loading = true; // Use the form action to submit the form if available.\n\n            if (_this19._form && _this19._form.action) {\n              var method = submission.data._id && _this19._form.action.includes(submission.data._id) ? 'PUT' : 'POST';\n              return _Formio.GlobalFormio.makeStaticRequest(_this19._form.action, method, submission, _this19.formio ? _this19.formio.options : {}).then(function (result) {\n                return resolve({\n                  submission: result,\n                  saved: true\n                });\n              }).catch(function (error) {\n                _this19.setServerErrors(error);\n                return reject(error);\n              });\n            }\n            var submitFormio = _this19.formio;\n            if (_this19.nosubmit || !submitFormio) {\n              return resolve({\n                submission: submission,\n                saved: false\n              });\n            } // If this is an actionUrl, then make sure to save the action and not the submission.\n\n            var submitMethod = submitFormio.actionUrl ? 'saveAction' : 'saveSubmission';\n            submitFormio[submitMethod](submission).then(function (result) {\n              return resolve({\n                submission: result,\n                saved: true\n              });\n            }).catch(function (error) {\n              _this19.setServerErrors(error);\n              return reject(error);\n            });\n          });\n        });\n      });\n    }\n  }, {\n    key: \"setServerErrors\",\n    value: function setServerErrors(error) {\n      if (error.details) {\n        this.serverErrors = error.details.filter(function (err) {\n          return err.level ? err.level === 'error' : err;\n        }).map(function (err) {\n          err.fromServer = true;\n          return err;\n        });\n      }\n    }\n  }, {\n    key: \"executeSubmit\",\n    value: function executeSubmit(options) {\n      var _this20 = this;\n      this.submitted = true;\n      this.submitting = true;\n      return this.submitForm(options).then(function (_ref2) {\n        var submission = _ref2.submission,\n          saved = _ref2.saved;\n        return _this20.onSubmit(submission, saved);\n      }).then(function (results) {\n        _this20.submissionInProcess = false;\n        return results;\n      }).catch(function (err) {\n        _this20.submissionInProcess = false;\n        return _nativePromiseOnly.default.reject(_this20.onSubmissionError(err));\n      });\n    }\n  }, {\n    key: \"clearServerErrors\",\n    value: function clearServerErrors() {\n      var _this$serverErrors,\n        _this21 = this;\n      (_this$serverErrors = this.serverErrors) === null || _this$serverErrors === void 0 ? void 0 : _this$serverErrors.forEach(function (error) {\n        if (error.path) {\n          var pathArray = (0, _utils.getArrayFromComponentPath)(error.path);\n          var component = _this21.getComponent(pathArray, _lodash.default.identity, error.formattedKeyOrPath);\n          if (component) {\n            component.serverErrors = [];\n          }\n        }\n      });\n      this.serverErrors = [];\n    }\n    /**\n     * Submits the form.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.src = 'https://examples.form.io/example';\n     * form.submission = {data: {\n     *   firstName: 'Joe',\n     *   lastName: 'Smith',\n     *   email: 'joe@example.com'\n     * }};\n     * form.submit().then((submission) => {\n     *   console.log(submission);\n     * });\n     *\n     * @param {boolean} before - If this submission occured from the before handlers.\n     *\n     * @returns {Promise} - A promise when the form is done submitting.\n     */\n  }, {\n    key: \"submit\",\n    value: function submit(before, options) {\n      var _this22 = this;\n      this.submissionInProcess = true;\n      if (!before) {\n        return this.beforeSubmit(options).then(function () {\n          return _this22.executeSubmit(options);\n        });\n      } else {\n        return this.executeSubmit(options);\n      }\n    }\n  }, {\n    key: \"submitUrl\",\n    value: function submitUrl(URL, headers) {\n      var _this23 = this;\n      if (!URL) {\n        return console.warn('Missing URL argument');\n      }\n      var submission = this.submission || {};\n      var API_URL = URL;\n      var settings = {\n        method: 'POST',\n        headers: {}\n      };\n      if (headers && headers.length > 0) {\n        headers.map(function (e) {\n          if (e.header !== '' && e.value !== '') {\n            settings.headers[e.header] = _this23.interpolate(e.value, submission);\n          }\n        });\n      }\n      if (API_URL && settings) {\n        _Formio.GlobalFormio.makeStaticRequest(API_URL, settings.method, submission, {\n          headers: settings.headers\n        }).then(function () {\n          _this23.emit('requestDone');\n          _this23.setAlert('success', '<p> Success </p>');\n        }).catch(function (e) {\n          _this23.showErrors(\"\".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e));\n          _this23.emit('error', \"\".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e));\n          console.error(\"\".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e));\n          _this23.setAlert('danger', \"<p> \".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e, \" </p>\"));\n        });\n      } else {\n        this.emit('error', 'You should add a URL to this button.');\n        this.setAlert('warning', 'You should add a URL to this button.');\n        return console.warn('You should add a URL to this button.');\n      }\n    }\n  }, {\n    key: \"triggerRecaptcha\",\n    value: function triggerRecaptcha() {\n      if (!this || !this.components) {\n        return;\n      }\n      var recaptchaComponent = (0, _utils.searchComponents)(this.components, {\n        'component.type': 'recaptcha',\n        'component.eventType': 'formLoad'\n      });\n      if (recaptchaComponent.length > 0) {\n        recaptchaComponent[0].verify(\"\".concat(this.form.name ? this.form.name : 'form', \"Load\"));\n      }\n    }\n  }, {\n    key: \"nosubmit\",\n    get: function get() {\n      return this._nosubmit || false;\n    },\n    set: function set(value) {\n      this._nosubmit = !!value;\n      this.emit('nosubmit', this._nosubmit);\n    }\n  }, {\n    key: \"conditions\",\n    get: function get() {\n      var _this$schema$settings, _this$schema$settings2;\n      return (_this$schema$settings = (_this$schema$settings2 = this.schema.settings) === null || _this$schema$settings2 === void 0 ? void 0 : _this$schema$settings2.conditions) !== null && _this$schema$settings !== void 0 ? _this$schema$settings : [];\n    }\n  }, {\n    key: \"variables\",\n    get: function get() {\n      var _this$schema$settings3, _this$schema$settings4;\n      return (_this$schema$settings3 = (_this$schema$settings4 = this.schema.settings) === null || _this$schema$settings4 === void 0 ? void 0 : _this$schema$settings4.variables) !== null && _this$schema$settings3 !== void 0 ? _this$schema$settings3 : [];\n    }\n  }]);\n  return Webform;\n}(_NestedDataComponent2.default);\nexports.default = Webform;\nWebform.setBaseUrl = _Formio.GlobalFormio.setBaseUrl;\nWebform.setApiUrl = _Formio.GlobalFormio.setApiUrl;\nWebform.setAppUrl = _Formio.GlobalFormio.setAppUrl;","map":{"version":3,"names":["require","Object","defineProperty","exports","value","default","_lodash","_interopRequireDefault","_moment","_compareVersions","_EventEmitter","_i18next","_i18n","_Formio","_nativePromiseOnly","_Components","_NestedDataComponent2","_utils","_formUtils","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_get","Reflect","get","bind","property","receiver","base","_superPropBase","desc","call","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","GlobalFormio","forms","registerComponent","setComponent","getIconSet","icons","getOptions","options","defaults","submitOnEnter","iconset","i18next","saveDraft","alwaysDirty","saveDraftThrottle","display","cdnUrl","cdn","baseUrl","events","Webform","_NestedDataComponent","_super","_this2","element","HTMLElement","event","keyboardCatchableElement","ctrl","ctrlKey","metaKey","keyCode","char","String","fromCharCode","each","shortcuts","shortcut","click","preventDefault","id","setBaseUrl","i18n","i18nReady","resources","lang","code","merge","translation","assign","fastCloneDeep","en","language","lng","type","_src","_loading","_form","draftEnabled","savingDraft","triggerSaveDraft","throttle","customErrors","nosubmit","submitted","submitting","formio","loader","alert","onSubmission","submissionSet","formReady","resolve","reject","formReadyResolve","formReadyReject","submissionReady","submissionReadyResolve","submissionReadyReject","localize","then","skipDraftRestore","user","getUser","restoreDraft","_id","component","clearOnHide","root","localRoot","set","_this3","changeLanguage","err","redraw","emit","componentContext","_data","form","components","shadowRoot","addLanguage","active","undefined","translations","addResourceBundle","_this4","initialized","init","compatibilityJSON","split","nodeName","indexOf","addShortcut","test","capitalize","tagName","removeShortcut","remove","setSrc","loadSubmission","_this5","loadingSubmission","submissionId","submission","setSubmission","catch","_this6","setUrl","loadForm","params","live","setForm","console","warn","src","_this7","loading","ce","class","spinner","appendChild","prependTo","wrapper","removeChildFrom","flags","_this$_form$component","_this8","isFormAlreadySet","_this$parent","_this$parent$componen","JSON","stringify","keepAsReference","cloneDeep","onSetForm","parent","modalEdit","settings","properties","schema","ready","setAlert","module","formModule","evaluate","concat","use","rebuild","triggerRecaptcha","setTimeout","onChange","getValue","_this9","fromSubmission","has","resolveFlags","triggerChange","setValue","_this10","t","draft","state","saveSubmission","sub","userId","_this11","loadSubmissions","owner","submissions","omit","eachComponent","mergeData","_this","_that","mergeWith","thisValue","thatValue","Array","isArray","data","_submission","metadata","editing","submissionTimezone","timezone","changed","sanitize","viewOnly","_this12","destroyComponents","input","addComponents","on","submit","log","checkValidity","args","submitUrl","url","headers","resetValue","deleteSubmission","updateValue","executeFormController","_this13","controller","visible","hidden","rootPristine","destroy","deleteFromGlobal","off","build","_this14","getClassName","classes","readOnly","render","renderTemplate","children","renderComponents","builderMode","clear","setContent","attach","_this15","loadRefs","webform","childPromise","attachComponents","refs","addEventListener","document","executeShortcuts","currentForm","hook","noUpdateEvent","hasRequiredFields","validate","required","getComponents","comp","setPristine","message","_this16","errorRef","el","removeEventListener","removeChild","noAlerts","attrs","templateOptions","outerHTML","convertStringToHTMLElement","currentTarget","dataset","componentKey","focusOnComponent","prepend","getComponent","focus","showErrors","error","triggerEvent","_this17","errors","_err$components","path","originalPath","_parentPath","getStringFromComponentPath","identity","fromServer","serverErrors","compact","setCustomValidity","displayedErrors","createListItem","index","messageFromIndex","isUndefined","messages","keyOrPath","formattedKeyOrPath","unescapeHTML","uniqBy","_ref","context","text","hasLabel","label","isObject","errorsList","onSubmit","saved","_this$triggerSaveDraf","noValidate","noCheck","cancel","normalizeError","details","onSubmissionError","silent","isValid","scrollIntoView","modified","changes","isChangeEventEmitted","clone","pristine","checkData","noEmit","valid","isEmpty","_this18","noconfirm","shouldReset","confirm","setMetadata","currentTimezone","offset","parseInt","utcOffset","origin","location","referrer","browserName","navigator","appName","userAgent","pathName","window","pathname","onLine","submitForm","_this19","clearServerErrors","isDraft","_vnote","everyComponent","persistent","unset","action","method","includes","makeStaticRequest","setServerErrors","submitFormio","submitMethod","actionUrl","level","map","executeSubmit","_this20","_ref2","results","submissionInProcess","_this$serverErrors","_this21","pathArray","getArrayFromComponentPath","before","_this22","beforeSubmit","URL","_this23","API_URL","header","interpolate","statusText","status","recaptchaComponent","searchComponents","verify","name","_nosubmit","_this$schema$settings","_this$schema$settings2","conditions","_this$schema$settings3","_this$schema$settings4","variables","setApiUrl","setAppUrl"],"sources":["D:/task/node_modules/formiojs/Webform.js"],"sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.object.assign.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _compareVersions = _interopRequireDefault(require(\"compare-versions\"));\n\nvar _EventEmitter = _interopRequireDefault(require(\"./EventEmitter\"));\n\nvar _i18next = _interopRequireDefault(require(\"i18next\"));\n\nvar _i18n = _interopRequireDefault(require(\"./i18n\"));\n\nvar _Formio = require(\"./Formio\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _Components = _interopRequireDefault(require(\"./components/Components\"));\n\nvar _NestedDataComponent2 = _interopRequireDefault(require(\"./components/_classes/nesteddata/NestedDataComponent\"));\n\nvar _utils = require(\"./utils/utils\");\n\nvar _formUtils = require(\"./utils/formUtils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get.bind(); } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// Initialize the available forms.\n_Formio.GlobalFormio.forms = {}; // Allow people to register components.\n\n_Formio.GlobalFormio.registerComponent = _Components.default.setComponent;\n\nfunction getIconSet(icons) {\n  if (icons === 'fontawesome') {\n    return 'fa';\n  }\n\n  return icons || '';\n}\n\nfunction getOptions(options) {\n  options = _lodash.default.defaults(options, {\n    submitOnEnter: false,\n    iconset: getIconSet(options && options.icons ? options.icons : _Formio.GlobalFormio.icons),\n    i18next: _i18next.default,\n    saveDraft: false,\n    alwaysDirty: false,\n    saveDraftThrottle: 5000,\n    display: 'form',\n    cdnUrl: _Formio.GlobalFormio.cdn.baseUrl\n  });\n\n  if (!options.events) {\n    options.events = new _EventEmitter.default();\n  }\n\n  return options;\n}\n/**\n * Renders a Form.io form within the webpage.\n */\n\n\nvar Webform = /*#__PURE__*/function (_NestedDataComponent) {\n  _inherits(Webform, _NestedDataComponent);\n\n  var _super = _createSuper(Webform);\n\n  /**\n   * Creates a new Form instance.\n   *\n   * @param {Object} options - The options to create a new form instance.\n   * @param {boolean} options.saveDraft - Set this if you would like to enable the save draft feature.\n   * @param {boolean} options.saveDraftThrottle - The throttle for the save draft feature.\n   * @param {boolean} options.readOnly - Set this form to readOnly\n   * @param {boolean} options.noAlerts - Set to true to disable the alerts dialog.\n   * @param {boolean} options.i18n - The translation file for this rendering. @see https://github.com/formio/formio.js/blob/master/i18n.js\n   * @param {boolean} options.template - Provides a way to inject custom logic into the creation of every element rendered within the form.\n   */\n\n  /* eslint-disable max-statements */\n  function Webform() {\n    var _this2;\n\n    _classCallCheck(this, Webform);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1];\n    } else {\n      options = arguments[0];\n    }\n\n    _this2 = _super.call(this, null, getOptions(options));\n\n    _defineProperty(_assertThisInitialized(_this2), \"executeShortcuts\", function (event) {\n      var target = event.target;\n\n      if (!_this2.keyboardCatchableElement(target)) {\n        return;\n      }\n\n      var ctrl = event.ctrlKey || event.metaKey;\n      var keyCode = event.keyCode;\n      var char = '';\n\n      if (65 <= keyCode && keyCode <= 90) {\n        char = String.fromCharCode(keyCode);\n      } else if (keyCode === 13) {\n        char = 'Enter';\n      } else if (keyCode === 27) {\n        char = 'Esc';\n      }\n\n      _lodash.default.each(_this2.shortcuts, function (shortcut) {\n        if (shortcut.ctrl && !ctrl) {\n          return;\n        }\n\n        if (shortcut.shortcut === char) {\n          shortcut.element.click();\n          event.preventDefault();\n        }\n      });\n    });\n\n    _this2.element = element; // Keep track of all available forms globally.\n\n    _Formio.GlobalFormio.forms[_this2.id] = _assertThisInitialized(_this2); // Set the base url.\n\n    if (_this2.options.baseUrl) {\n      _Formio.GlobalFormio.setBaseUrl(_this2.options.baseUrl);\n    }\n    /**\n     * The i18n configuration for this component.\n     */\n\n\n    var i18n = _i18n.default;\n\n    if (options && options.i18n && !options.i18nReady) {\n      // Support legacy way of doing translations.\n      if (options.i18n.resources) {\n        i18n = options.i18n;\n      } else {\n        _lodash.default.each(options.i18n, function (lang, code) {\n          if (code === 'options') {\n            _lodash.default.merge(i18n, lang);\n          } else if (!i18n.resources[code]) {\n            // extend the default translations (validations, buttons etc.) in case they are not in the options.\n            i18n.resources[code] = {\n              translation: _lodash.default.assign((0, _utils.fastCloneDeep)(_i18n.default.resources.en.translation), lang)\n            };\n          } else {\n            _lodash.default.assign(i18n.resources[code].translation, lang);\n          }\n        });\n      }\n\n      options.i18n = i18n;\n      options.i18nReady = true;\n    }\n\n    if (options && options.i18n) {\n      _this2.options.i18n = options.i18n;\n    } else {\n      _this2.options.i18n = i18n;\n    } // Set the language.\n\n\n    if (_this2.options.language) {\n      _this2.options.i18n.lng = _this2.options.language;\n    }\n    /**\n     * The type of this element.\n     * @type {string}\n     */\n\n\n    _this2.type = 'form';\n    _this2._src = '';\n    _this2._loading = false;\n    _this2._form = {};\n    _this2.draftEnabled = false;\n    _this2.savingDraft = true;\n\n    if (_this2.options.saveDraftThrottle) {\n      _this2.triggerSaveDraft = _lodash.default.throttle(_this2.saveDraft.bind(_assertThisInitialized(_this2)), _this2.options.saveDraftThrottle);\n    } else {\n      _this2.triggerSaveDraft = _this2.saveDraft.bind(_assertThisInitialized(_this2));\n    }\n\n    _this2.customErrors = [];\n    /**\n     * Determines if this form should submit the API on submit.\n     * @type {boolean}\n     */\n\n    _this2.nosubmit = false;\n    /**\n     * Determines if the form has tried to be submitted, error or not.\n     *\n     * @type {boolean}\n     */\n\n    _this2.submitted = false;\n    /**\n     * Determines if the form is being submitted at the moment.\n     *\n     * @type {boolean}\n     */\n\n    _this2.submitting = false;\n    /**\n     * The Formio instance for this form.\n     * @type {Formio}\n     */\n\n    _this2.formio = null;\n    /**\n     * The loader HTML element.\n     * @type {HTMLElement}\n     */\n\n    _this2.loader = null;\n    /**\n     * The alert HTML element\n     * @type {HTMLElement}\n     */\n\n    _this2.alert = null;\n    /**\n     * Promise that is triggered when the submission is done loading.\n     * @type {Promise}\n     */\n\n    _this2.onSubmission = null;\n    /**\n     * Determines if this submission is explicitly set.\n     * @type {boolean}\n     */\n\n    _this2.submissionSet = false;\n    /**\n     * Promise that executes when the form is ready and rendered.\n     * @type {Promise}\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.formReady.then(() => {\n     *   console.log('The form is ready!');\n     * });\n     * form.src = 'https://examples.form.io/example';\n     */\n\n    _this2.formReady = new _nativePromiseOnly.default(function (resolve, reject) {\n      /**\n       * Called when the formReady state of this form has been resolved.\n       *\n       * @type {function}\n       */\n      _this2.formReadyResolve = resolve;\n      /**\n       * Called when this form could not load and is rejected.\n       *\n       * @type {function}\n       */\n\n      _this2.formReadyReject = reject;\n    });\n    /**\n     * Promise that executes when the submission is ready and rendered.\n     * @type {Promise}\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.submissionReady.then(() => {\n     *   console.log('The submission is ready!');\n     * });\n     * form.src = 'https://examples.form.io/example/submission/234234234234234243';\n     */\n\n    _this2.submissionReady = new _nativePromiseOnly.default(function (resolve, reject) {\n      /**\n       * Called when the formReady state of this form has been resolved.\n       *\n       * @type {function}\n       */\n      _this2.submissionReadyResolve = resolve;\n      /**\n       * Called when this form could not load and is rejected.\n       *\n       * @type {function}\n       */\n\n      _this2.submissionReadyReject = reject;\n    });\n    _this2.shortcuts = []; // Set language after everything is established.\n\n    _this2.localize().then(function () {\n      _this2.language = _this2.options.language;\n    }); // See if we need to restore the draft from a user.\n\n\n    if (_this2.options.saveDraft && !_this2.options.skipDraftRestore) {\n      var user = _Formio.GlobalFormio.getUser(); // Only restore a draft if the submission isn't explicitly set.\n\n\n      if (user && !_this2.submissionSet) {\n        _this2.restoreDraft(user._id);\n      }\n    }\n\n    _this2.component.clearOnHide = false; // Ensure the root is set to this component.\n\n    _this2.root = _assertThisInitialized(_this2);\n    _this2.localRoot = _assertThisInitialized(_this2);\n    return _this2;\n  }\n  /* eslint-enable max-statements */\n\n\n  _createClass(Webform, [{\n    key: \"language\",\n    get: function get() {\n      return this.options.language;\n    },\n    set:\n    /**\n     * Sets the language for this form.\n     *\n     * @param lang\n     * @return {Promise}\n     */\n    function set(lang) {\n      var _this3 = this;\n\n      this.options.language = lang;\n\n      if (this.i18next.language === lang) {\n        return;\n      }\n\n      try {\n        this.i18next.changeLanguage(lang, function (err) {\n          if (err) {\n            return;\n          }\n\n          _this3.redraw();\n\n          _this3.emit('languageChanged');\n        });\n      } catch (err) {\n        return;\n      }\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"componentContext\",\n    value: function componentContext() {\n      return this._data;\n    }\n  }, {\n    key: \"componentComponents\",\n    get: function get() {\n      return this.form.components;\n    }\n  }, {\n    key: \"shadowRoot\",\n    get: function get() {\n      return this.options.shadowRoot;\n    }\n    /**\n     * Add a language for translations\n     *\n     * @param code\n     * @param lang\n     * @param active\n     * @return {*}\n     */\n\n  }, {\n    key: \"addLanguage\",\n    value: function addLanguage(code, lang) {\n      var active = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      var translations = _lodash.default.assign((0, _utils.fastCloneDeep)(_i18n.default.resources.en.translation), lang);\n\n      this.i18next.addResourceBundle(code, 'translation', translations, true, true);\n\n      if (active) {\n        this.language = code;\n      }\n    }\n    /**\n     * Perform the localization initialization.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"localize\",\n    value: function localize() {\n      var _this4 = this;\n\n      if (this.i18next.initialized) {\n        return _nativePromiseOnly.default.resolve(this.i18next);\n      }\n\n      this.i18next.initialized = true;\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        try {\n          _this4.i18next.init(_objectSpread(_objectSpread({}, _this4.options.i18n), {\n            compatibilityJSON: 'v3'\n          }), function (err) {\n            // Get language but remove any ;q=1 that might exist on it.\n            _this4.options.language = _this4.i18next.language.split(';')[0];\n\n            if (err) {\n              return reject(err);\n            }\n\n            resolve(_this4.i18next);\n          });\n        } catch (err) {\n          return reject(err);\n        }\n      });\n    }\n  }, {\n    key: \"keyboardCatchableElement\",\n    value: function keyboardCatchableElement(element) {\n      if (element.nodeName === 'TEXTAREA') {\n        return false;\n      }\n\n      if (element.nodeName === 'INPUT') {\n        return ['text', 'email', 'password'].indexOf(element.type) === -1;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"addShortcut\",\n    value: function addShortcut(element, shortcut) {\n      if (!shortcut || !/^([A-Z]|Enter|Esc)$/i.test(shortcut)) {\n        return;\n      }\n\n      shortcut = _lodash.default.capitalize(shortcut);\n\n      if (shortcut === 'Enter' || shortcut === 'Esc') {\n        // Restrict Enter and Esc only for buttons\n        if (element.tagName !== 'BUTTON') {\n          return;\n        }\n\n        this.shortcuts.push({\n          shortcut: shortcut,\n          element: element\n        });\n      } else {\n        this.shortcuts.push({\n          ctrl: true,\n          shortcut: shortcut,\n          element: element\n        });\n      }\n    }\n  }, {\n    key: \"removeShortcut\",\n    value: function removeShortcut(element, shortcut) {\n      if (!shortcut || !/^([A-Z]|Enter|Esc)$/i.test(shortcut)) {\n        return;\n      }\n\n      _lodash.default.remove(this.shortcuts, {\n        shortcut: shortcut,\n        element: element\n      });\n    }\n    /**\n     * Get the embed source of the form.\n     *\n     * @returns {string}\n     */\n\n  }, {\n    key: \"src\",\n    get: function get() {\n      return this._src;\n    }\n    /**\n     * Loads the submission if applicable.\n     */\n    ,\n    set:\n    /**\n     * Set the Form source, which is typically the Form.io embed URL.\n     *\n     * @param {string} value - The value of the form embed url.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.formReady.then(() => {\n     *   console.log('The form is formReady!');\n     * });\n     * form.src = 'https://examples.form.io/example';\n     */\n    function set(value) {\n      this.setSrc(value);\n    }\n    /**\n     * Get the embed source of the form.\n     *\n     * @returns {string}\n     */\n\n  }, {\n    key: \"loadSubmission\",\n    value: function loadSubmission() {\n      var _this5 = this;\n\n      this.loadingSubmission = true;\n\n      if (this.formio.submissionId) {\n        this.onSubmission = this.formio.loadSubmission().then(function (submission) {\n          return _this5.setSubmission(submission);\n        }, function (err) {\n          return _this5.submissionReadyReject(err);\n        }).catch(function (err) {\n          return _this5.submissionReadyReject(err);\n        });\n      } else {\n        this.submissionReadyResolve();\n      }\n\n      return this.submissionReady;\n    }\n    /**\n     * Set the src of the form renderer.\n     *\n     * @param value\n     * @param options\n     */\n\n  }, {\n    key: \"setSrc\",\n    value: function setSrc(value, options) {\n      var _this6 = this;\n\n      if (this.setUrl(value, options)) {\n        this.nosubmit = false;\n        return this.formio.loadForm({\n          params: {\n            live: 1\n          }\n        }).then(function (form) {\n          var setForm = _this6.setForm(form);\n\n          _this6.loadSubmission();\n\n          return setForm;\n        }).catch(function (err) {\n          console.warn(err);\n\n          _this6.formReadyReject(err);\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"url\",\n    get: function get() {\n      return this._src;\n    }\n    /**\n     * Sets the url of the form renderer.\n     *\n     * @param value\n     * @param options\n     */\n    ,\n    set:\n    /**\n     * Set the form source but don't initialize the form and submission from the url.\n     *\n     * @param {string} value - The value of the form embed url.\n     */\n    function set(value) {\n      this.setUrl(value);\n    }\n    /**\n     * Called when both the form and submission have been loaded.\n     *\n     * @returns {Promise} - The promise to trigger when both form and submission have loaded.\n     */\n\n  }, {\n    key: \"setUrl\",\n    value: function setUrl(value, options) {\n      if (!value || typeof value !== 'string' || value === this._src) {\n        return false;\n      }\n\n      this._src = value;\n      this.nosubmit = true;\n      this.formio = this.options.formio = new _Formio.GlobalFormio(value, options);\n\n      if (this.type === 'form') {\n        // Set the options source so this can be passed to other components.\n        this.options.src = value;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"ready\",\n    get: function get() {\n      var _this7 = this;\n\n      return this.formReady.then(function () {\n        return _get(_getPrototypeOf(Webform.prototype), \"ready\", _this7).then(function () {\n          return _this7.loadingSubmission ? _this7.submissionReady : true;\n        });\n      });\n    }\n    /**\n     * Returns if this form is loading.\n     *\n     * @returns {boolean} - TRUE means the form is loading, FALSE otherwise.\n     */\n\n  }, {\n    key: \"loading\",\n    get: function get() {\n      return this._loading;\n    }\n    /**\n     * Set the loading state for this form, and also show the loader spinner.\n     *\n     * @param {boolean} loading - If this form should be \"loading\" or not.\n     */\n    ,\n    set: function set(loading) {\n      if (this._loading !== loading) {\n        this._loading = loading;\n\n        if (!this.loader && loading) {\n          this.loader = this.ce('div', {\n            class: 'loader-wrapper'\n          });\n          var spinner = this.ce('div', {\n            class: 'loader text-center'\n          });\n          this.loader.appendChild(spinner);\n        }\n        /* eslint-disable max-depth */\n\n\n        if (this.loader) {\n          try {\n            if (loading) {\n              this.prependTo(this.loader, this.wrapper);\n            } else {\n              this.removeChildFrom(this.loader, this.wrapper);\n            }\n          } catch (err) {// ingore\n          }\n        }\n        /* eslint-enable max-depth */\n\n      }\n    }\n    /**\n     * Sets the JSON schema for the form to be rendered.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.setForm({\n     *   components: [\n     *     {\n     *       type: 'textfield',\n     *       key: 'firstName',\n     *       label: 'First Name',\n     *       placeholder: 'Enter your first name.',\n     *       input: true\n     *     },\n     *     {\n     *       type: 'textfield',\n     *       key: 'lastName',\n     *       label: 'Last Name',\n     *       placeholder: 'Enter your last name',\n     *       input: true\n     *     },\n     *     {\n     *       type: 'button',\n     *       action: 'submit',\n     *       label: 'Submit',\n     *       theme: 'primary'\n     *     }\n     *   ]\n     * });\n     *\n     * @param {Object} form - The JSON schema of the form @see https://examples.form.io/example for an example JSON schema.\n     * @param flags\n     * @returns {*}\n     */\n\n  }, {\n    key: \"setForm\",\n    value: function setForm(form, flags) {\n      var _this$_form$component,\n          _this8 = this;\n\n      var isFormAlreadySet = this._form && ((_this$_form$component = this._form.components) === null || _this$_form$component === void 0 ? void 0 : _this$_form$component.length);\n\n      try {\n        var _this$parent, _this$parent$componen;\n\n        // Do not set the form again if it has been already set\n        if (isFormAlreadySet && JSON.stringify(this._form) === JSON.stringify(form)) {\n          return _nativePromiseOnly.default.resolve();\n        } // Create the form.\n\n\n        this._form = flags !== null && flags !== void 0 && flags.keepAsReference ? form : _lodash.default.cloneDeep(form);\n\n        if (this.onSetForm) {\n          this.onSetForm(_lodash.default.cloneDeep(this._form), form);\n        }\n\n        if ((_this$parent = this.parent) !== null && _this$parent !== void 0 && (_this$parent$componen = _this$parent.component) !== null && _this$parent$componen !== void 0 && _this$parent$componen.modalEdit) {\n          return _nativePromiseOnly.default.resolve();\n        }\n      } catch (err) {\n        console.warn(err); // If provided form is not a valid JSON object, do not set it too\n\n        return _nativePromiseOnly.default.resolve();\n      } // Allow the form to provide component overrides.\n\n\n      if (form && form.settings && form.settings.components) {\n        this.options.components = form.settings.components;\n      }\n\n      if (form && form.properties) {\n        this.options.properties = form.properties;\n      }\n\n      if ('schema' in form && (0, _compareVersions.default)(form.schema, '1.x') > 0) {\n        this.ready.then(function () {\n          _this8.setAlert('alert alert-danger', 'Form schema is for a newer version, please upgrade your renderer. Some functionality may not work.');\n        });\n      } // See if they pass a module, and evaluate it if so.\n\n\n      if (form && form.module) {\n        var formModule = null;\n\n        if (typeof form.module === 'string') {\n          try {\n            formModule = this.evaluate(\"return \".concat(form.module));\n          } catch (err) {\n            console.warn(err);\n          }\n        } else {\n          formModule = form.module;\n        }\n\n        if (formModule) {\n          _Formio.GlobalFormio.use(formModule); // Since we got here after instantiation, we need to manually apply form options.\n\n\n          if (formModule.options && formModule.options.form) {\n            this.options = Object.assign(this.options, formModule.options.form);\n          }\n        }\n      }\n\n      this.initialized = false;\n\n      var rebuild = this.rebuild() || _nativePromiseOnly.default.resolve();\n\n      return rebuild.then(function () {\n        _this8.emit('formLoad', form);\n\n        _this8.triggerRecaptcha(); // Make sure to trigger onChange after a render event occurs to speed up form rendering.\n\n\n        setTimeout(function () {\n          _this8.onChange(flags);\n\n          _this8.formReadyResolve();\n        }, 0);\n        return _this8.formReady;\n      });\n    }\n    /**\n     * Gets the form object.\n     *\n     * @returns {Object} - The form JSON schema.\n     */\n\n  }, {\n    key: \"form\",\n    get: function get() {\n      if (!this._form) {\n        this._form = {\n          components: []\n        };\n      }\n\n      return this._form;\n    }\n    /**\n     * Sets the form value.\n     *\n     * @alias setForm\n     * @param {Object} form - The form schema object.\n     */\n    ,\n    set: function set(form) {\n      this.setForm(form);\n    }\n    /**\n     * Returns the submission object that was set within this form.\n     *\n     * @returns {Object}\n     */\n\n  }, {\n    key: \"submission\",\n    get: function get() {\n      return this.getValue();\n    }\n    /**\n     * Sets the submission of a form.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.src = 'https://examples.form.io/example';\n     * form.submission = {data: {\n     *   firstName: 'Joe',\n     *   lastName: 'Smith',\n     *   email: 'joe@example.com'\n     * }};\n     *\n     * @param {Object} submission - The Form.io submission object.\n     */\n    ,\n    set: function set(submission) {\n      this.setSubmission(submission);\n    }\n    /**\n     * Sets a submission and returns the promise when it is ready.\n     * @param submission\n     * @param flags\n     * @return {Promise.<TResult>}\n     */\n\n  }, {\n    key: \"setSubmission\",\n    value: function setSubmission(submission) {\n      var _this9 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      flags = _objectSpread(_objectSpread({}, flags), {}, {\n        fromSubmission: _lodash.default.has(flags, 'fromSubmission') ? flags.fromSubmission : true\n      });\n      return this.onSubmission = this.formReady.then(function (resolveFlags) {\n        if (resolveFlags) {\n          flags = _objectSpread(_objectSpread({}, flags), resolveFlags);\n        }\n\n        _this9.submissionSet = true;\n\n        _this9.triggerChange(flags);\n\n        _this9.setValue(submission, flags);\n\n        return _this9.submissionReadyResolve(submission);\n      }, function (err) {\n        return _this9.submissionReadyReject(err);\n      }).catch(function (err) {\n        return _this9.submissionReadyReject(err);\n      });\n    }\n    /**\n     * Saves a submission draft.\n     */\n\n  }, {\n    key: \"saveDraft\",\n    value: function saveDraft() {\n      var _this10 = this;\n\n      if (!this.draftEnabled) {\n        return;\n      }\n\n      if (!this.formio) {\n        console.warn(this.t('saveDraftInstanceError'));\n        return;\n      }\n\n      if (!_Formio.GlobalFormio.getUser()) {\n        console.warn(this.t('saveDraftAuthError'));\n        return;\n      }\n\n      var draft = (0, _utils.fastCloneDeep)(this.submission);\n      draft.state = 'draft';\n\n      if (!this.savingDraft) {\n        this.emit('saveDraftBegin');\n        this.savingDraft = true;\n        this.formio.saveSubmission(draft).then(function (sub) {\n          // Set id to submission to avoid creating new draft submission\n          _this10.submission._id = sub._id;\n          _this10.savingDraft = false;\n\n          _this10.emit('saveDraft', sub);\n        });\n      }\n    }\n    /**\n     * Restores a draft submission based on the user who is authenticated.\n     *\n     * @param {userId} - The user id where we need to restore the draft from.\n     */\n\n  }, {\n    key: \"restoreDraft\",\n    value: function restoreDraft(userId) {\n      var _this11 = this;\n\n      if (!this.formio) {\n        console.warn(this.t('restoreDraftInstanceError'));\n        return;\n      }\n\n      this.savingDraft = true;\n      this.formio.loadSubmissions({\n        params: {\n          state: 'draft',\n          owner: userId\n        }\n      }).then(function (submissions) {\n        if (submissions.length > 0 && !_this11.options.skipDraftRestore) {\n          var draft = (0, _utils.fastCloneDeep)(submissions[0]);\n          return _this11.setSubmission(draft).then(function () {\n            _this11.draftEnabled = true;\n            _this11.savingDraft = false;\n\n            _this11.emit('restoreDraft', draft);\n          });\n        } // Enable drafts so that we can keep track of changes.\n\n\n        _this11.draftEnabled = true;\n        _this11.savingDraft = false;\n\n        _this11.emit('restoreDraft', null);\n      });\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      var schema = (0, _utils.fastCloneDeep)(_lodash.default.omit(this._form, ['components']));\n      schema.components = [];\n      this.eachComponent(function (component) {\n        return schema.components.push(component.schema);\n      });\n      return schema;\n    }\n  }, {\n    key: \"mergeData\",\n    value: function mergeData(_this, _that) {\n      _lodash.default.mergeWith(_this, _that, function (thisValue, thatValue) {\n        if (Array.isArray(thisValue) && Array.isArray(thatValue) && thisValue.length !== thatValue.length) {\n          return thatValue;\n        }\n      });\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!submission || !submission.data) {\n        submission = {\n          data: {}\n        };\n      } // Metadata needs to be available before setValue\n\n\n      this._submission.metadata = submission.metadata || {};\n      this.editing = !!submission._id; // Set the timezone in the options if available.\n\n      if (!this.options.submissionTimezone && submission.metadata && submission.metadata.timezone) {\n        this.options.submissionTimezone = submission.metadata.timezone;\n      }\n\n      var changed = _get(_getPrototypeOf(Webform.prototype), \"setValue\", this).call(this, submission.data, flags);\n\n      if (!flags.sanitize) {\n        this.mergeData(this.data, submission.data);\n      }\n\n      submission.data = this.data;\n      this._submission = submission;\n      return changed;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      if (!this._submission.data) {\n        this._submission.data = {};\n      }\n\n      if (this.viewOnly) {\n        return this._submission;\n      }\n\n      var submission = this._submission;\n      submission.data = this.data;\n      return this._submission;\n    }\n    /**\n     * Build the form.\n     */\n\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this12 = this;\n\n      this._submission = this._submission || {\n        data: {}\n      }; // Remove any existing components.\n\n      if (this.components && this.components.length) {\n        this.destroyComponents();\n        this.components = [];\n      }\n\n      if (this.component) {\n        this.component.components = this.form ? this.form.components : [];\n      } else {\n        this.component = this.form;\n      }\n\n      this.component.type = 'form';\n      this.component.input = false;\n      this.addComponents();\n      this.on('submitButton', function (options) {\n        _this12.submit(false, options).catch(function (e) {\n          return e !== false && console.log(e);\n        });\n      }, true);\n      this.on('checkValidity', function (data) {\n        return _this12.checkValidity(data, true, data);\n      }, true);\n      this.on('requestUrl', function (args) {\n        return _this12.submitUrl(args.url, args.headers);\n      }, true);\n      this.on('resetForm', function () {\n        return _this12.resetValue();\n      }, true);\n      this.on('deleteSubmission', function () {\n        return _this12.deleteSubmission();\n      }, true);\n      this.on('refreshData', function () {\n        return _this12.updateValue();\n      }, true);\n      this.executeFormController();\n      return this.formReady;\n    }\n  }, {\n    key: \"executeFormController\",\n    value: function executeFormController() {\n      var _this13 = this;\n\n      // If no controller value or\n      // hidden and set to clearOnHide (Don't calculate a value for a hidden field set to clear when hidden)\n      if (!this.form || !this.form.controller || (!this.visible || this.component.hidden) && this.component.clearOnHide && !this.rootPristine) {\n        return false;\n      }\n\n      this.formReady.then(function () {\n        _this13.evaluate(_this13.form.controller, {\n          components: _this13.components,\n          instance: _this13\n        });\n      });\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var deleteFromGlobal = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      this.off('submitButton');\n      this.off('checkValidity');\n      this.off('requestUrl');\n      this.off('resetForm');\n      this.off('deleteSubmission');\n      this.off('refreshData');\n\n      if (deleteFromGlobal) {\n        this.emit('formDelete', this.id);\n        delete _Formio.GlobalFormio.forms[this.id];\n      }\n\n      return _get(_getPrototypeOf(Webform.prototype), \"destroy\", this).call(this);\n    }\n  }, {\n    key: \"build\",\n    value: function build(element) {\n      var _this14 = this;\n\n      if (element || this.element) {\n        return this.ready.then(function () {\n          element = element || _this14.element;\n\n          _get(_getPrototypeOf(Webform.prototype), \"build\", _this14).call(_this14, element);\n        });\n      }\n\n      return this.ready;\n    }\n  }, {\n    key: \"getClassName\",\n    value: function getClassName() {\n      var classes = 'formio-form';\n\n      if (this.options.readOnly) {\n        classes += ' formio-read-only';\n      }\n\n      return classes;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _get(_getPrototypeOf(Webform.prototype), \"render\", this).call(this, this.renderTemplate('webform', {\n        classes: this.getClassName(),\n        children: this.renderComponents()\n      }), this.builderMode ? 'builder' : 'form', true);\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      // Don't bother if we have not built yet.\n      if (!this.element) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      this.clear();\n      this.setContent(this.element, this.render());\n      return this.attach(this.element);\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this15 = this;\n\n      this.element = element;\n      this.loadRefs(element, {\n        webform: 'single'\n      });\n      var childPromise = this.attachComponents(this.refs.webform);\n      this.addEventListener(document, 'keydown', this.executeShortcuts);\n      this.currentForm = this;\n      this.hook('attachWebform', element, this);\n      return childPromise.then(function () {\n        _this15.emit('render', _this15.element);\n\n        return _this15.setValue(_this15._submission, {\n          noUpdateEvent: true\n        });\n      });\n    }\n  }, {\n    key: \"hasRequiredFields\",\n    value: function hasRequiredFields() {\n      var result = false;\n      (0, _formUtils.eachComponent)(this.form.components, function (component) {\n        if (component.validate.required) {\n          result = true;\n          return true;\n        }\n      }, true);\n      return result;\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      _lodash.default.each(this.getComponents(), function (comp) {\n        return comp.resetValue();\n      });\n\n      this.setPristine(true);\n      this.onChange();\n    }\n    /**\n     * Sets a new alert to display in the error dialog of the form.\n     *\n     * @param {string} type - The type of alert to display. \"danger\", \"success\", \"warning\", etc.\n     * @param {string} message - The message to show in the alert.\n     * @param {Object} options\n     */\n\n  }, {\n    key: \"setAlert\",\n    value: function setAlert(type, message, options) {\n      var _this16 = this;\n\n      if (!type && this.submitted) {\n        if (this.alert) {\n          if (this.refs.errorRef && this.refs.errorRef.length) {\n            this.refs.errorRef.forEach(function (el) {\n              _this16.removeEventListener(el, 'click');\n\n              _this16.removeEventListener(el, 'keypress');\n            });\n          }\n\n          this.removeChild(this.alert);\n          this.alert = null;\n        }\n\n        return;\n      }\n\n      if (this.options.noAlerts) {\n        if (!message) {\n          this.emit('error', false);\n        }\n\n        return;\n      }\n\n      if (this.alert) {\n        try {\n          if (this.refs.errorRef && this.refs.errorRef.length) {\n            this.refs.errorRef.forEach(function (el) {\n              _this16.removeEventListener(el, 'click');\n\n              _this16.removeEventListener(el, 'keypress');\n            });\n          }\n\n          this.removeChild(this.alert);\n          this.alert = null;\n        } catch (err) {// ignore\n        }\n      }\n\n      if (message) {\n        var attrs = {\n          class: options && options.classes || \"alert alert-\".concat(type),\n          id: \"error-list-\".concat(this.id)\n        };\n        var templateOptions = {\n          message: message instanceof HTMLElement ? message.outerHTML : message,\n          attrs: attrs,\n          type: type\n        };\n        this.alert = (0, _utils.convertStringToHTMLElement)(this.renderTemplate('alert', templateOptions), \"#\".concat(attrs.id));\n      }\n\n      if (!this.alert) {\n        return;\n      }\n\n      this.loadRefs(this.alert, {\n        errorRef: 'multiple'\n      });\n\n      if (this.refs.errorRef && this.refs.errorRef.length) {\n        this.refs.errorRef.forEach(function (el) {\n          _this16.addEventListener(el, 'click', function (e) {\n            var key = e.currentTarget.dataset.componentKey;\n\n            _this16.focusOnComponent(key);\n          });\n\n          _this16.addEventListener(el, 'keydown', function (e) {\n            if (e.keyCode === 13) {\n              e.preventDefault();\n              var key = e.currentTarget.dataset.componentKey;\n\n              _this16.focusOnComponent(key);\n            }\n          });\n        });\n      }\n\n      this.prepend(this.alert);\n    }\n    /**\n     * Focus on selected component.\n     *\n     * @param {string} key - The key of selected component.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"focusOnComponent\",\n    value: function focusOnComponent(key) {\n      if (key) {\n        var component = this.getComponent(key);\n\n        if (component) {\n          component.focus();\n        }\n      }\n    }\n    /**\n     * Show the errors of this form within the alert dialog.\n     *\n     * @param {Object} error - An optional additional error to display along with the component errors.\n     * @returns {*}\n     */\n\n    /* eslint-disable no-unused-vars */\n\n  }, {\n    key: \"showErrors\",\n    value: function showErrors(error, triggerEvent, onChange) {\n      var _this17 = this;\n\n      this.loading = false;\n      var errors = this.errors;\n\n      if (error) {\n        if (Array.isArray(error)) {\n          errors = errors.concat(error);\n        } else {\n          errors.push(error);\n        }\n      } else {\n        errors = _get(_getPrototypeOf(Webform.prototype), \"errors\", this);\n      }\n\n      errors = errors.concat(this.customErrors);\n\n      if (!errors.length) {\n        this.setAlert(false);\n        return;\n      } // Mark any components as invalid if in a custom message.\n\n\n      errors.forEach(function (err) {\n        var _err$components = err.components,\n            components = _err$components === void 0 ? [] : _err$components;\n\n        if (err.component) {\n          components.push(err.component);\n        }\n\n        if (err.path) {\n          components.push(err.path);\n        }\n\n        components.forEach(function (path) {\n          var originalPath = _this17._parentPath + (0, _utils.getStringFromComponentPath)(path);\n\n          var component = _this17.getComponent(path, _lodash.default.identity, originalPath);\n\n          if (err.fromServer) {\n            if (component.serverErrors) {\n              component.serverErrors.push(err);\n            } else {\n              component.serverErrors = [err];\n            }\n          }\n\n          var components = _lodash.default.compact(Array.isArray(component) ? component : [component]);\n\n          components.forEach(function (component) {\n            return component.setCustomValidity(err.message, true);\n          });\n        });\n      });\n      var displayedErrors = [];\n      errors.forEach(function (err) {\n        if (err) {\n          var createListItem = function createListItem(message, index) {\n            var messageFromIndex = !_lodash.default.isUndefined(index) && err.messages && err.messages[index];\n            var keyOrPath = messageFromIndex && messageFromIndex.formattedKeyOrPath || messageFromIndex.path || err.component && err.component.key || err.fromServer && err.path;\n            var formattedKeyOrPath = keyOrPath ? (0, _utils.getStringFromComponentPath)(keyOrPath) : '';\n            formattedKeyOrPath = _this17._parentPath + formattedKeyOrPath;\n\n            if (typeof err !== 'string' && !err.formattedKeyOrPath) {\n              err.formattedKeyOrPath = formattedKeyOrPath;\n            }\n\n            return {\n              message: (0, _utils.unescapeHTML)(message),\n              keyOrPath: formattedKeyOrPath\n            };\n          };\n\n          err.messages = _lodash.default.uniqBy(err.messages, function (message) {\n            return message.message;\n          });\n\n          if (err.messages && err.messages.length) {\n            var component = err.component;\n            err.messages.forEach(function (_ref, index) {\n              var message = _ref.message,\n                  context = _ref.context,\n                  fromServer = _ref.fromServer;\n              var text = context !== null && context !== void 0 && context.hasLabel || fromServer ? _this17.t('alertMessage', {\n                message: _this17.t(message)\n              }) : _this17.t('alertMessageWithLabel', {\n                label: _this17.t(component.label),\n                message: _this17.t(message)\n              });\n              displayedErrors.push(createListItem(text, index));\n            });\n          } else if (err) {\n            var message = _lodash.default.isObject(err) ? _this17.t('alertMessage', {\n              message: _this17.t(err.message || '')\n            }) : _this17.t('alertMessage', {\n              message: _this17.t(err)\n            });\n            displayedErrors.push(createListItem(message));\n          }\n        }\n      });\n      var errorsList = this.renderTemplate('errorsList', {\n        errors: displayedErrors\n      });\n      this.root.setAlert('danger', errorsList);\n\n      if (triggerEvent) {\n        this.emit('error', errors);\n      }\n\n      return errors;\n    }\n    /* eslint-enable no-unused-vars */\n\n    /**\n     * Called when the submission has completed, or if the submission needs to be sent to an external library.\n     *\n     * @param {Object} submission - The submission object.\n     * @param {boolean} saved - Whether or not this submission was saved to the server.\n     * @returns {object} - The submission object.\n     */\n\n  }, {\n    key: \"onSubmit\",\n    value: function onSubmit(submission, saved) {\n      var _this$triggerSaveDraf;\n\n      this.loading = false;\n      this.submitting = false;\n      this.setPristine(true); // We want to return the submitted submission and setValue will mutate the submission so cloneDeep it here.\n\n      this.setValue((0, _utils.fastCloneDeep)(submission), {\n        noValidate: true,\n        noCheck: true\n      });\n      this.setAlert('success', \"<p>\".concat(this.t('complete'), \"</p>\")); // Cancel triggered saveDraft to prevent overriding the submitted state\n\n      if (this.draftEnabled && (_this$triggerSaveDraf = this.triggerSaveDraft) !== null && _this$triggerSaveDraf !== void 0 && _this$triggerSaveDraf.cancel) {\n        this.triggerSaveDraft.cancel();\n      }\n\n      this.emit('submit', submission, saved);\n\n      if (saved) {\n        this.emit('submitDone', submission);\n      }\n\n      return submission;\n    }\n  }, {\n    key: \"normalizeError\",\n    value: function normalizeError(error) {\n      if (error) {\n        if (_typeof(error) === 'object' && 'details' in error) {\n          error = error.details;\n        }\n\n        if (typeof error === 'string') {\n          error = {\n            message: error\n          };\n        }\n      }\n\n      return error;\n    }\n    /**\n     * Called when an error occurs during the submission.\n     *\n     * @param {Object} error - The error that occured.\n     */\n\n  }, {\n    key: \"onSubmissionError\",\n    value: function onSubmissionError(error) {\n      error = this.normalizeError(error);\n      this.submitting = false;\n      this.setPristine(false);\n      this.emit('submitError', error); // Allow for silent cancellations (no error message, no submit button error state)\n\n      if (error && error.silent) {\n        this.emit('change', {\n          isValid: true\n        }, {\n          silent: true\n        });\n        return false;\n      }\n\n      var errors = this.showErrors(error, true);\n\n      if (this.root && this.root.alert) {\n        this.scrollIntoView(this.root.alert);\n      }\n\n      return errors;\n    }\n    /**\n     * Trigger the change event for this form.\n     *\n     * @param changed\n     * @param flags\n     */\n\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, changed, modified, changes) {\n      flags = flags || {};\n      var isChangeEventEmitted = false; // For any change events, clear any custom errors for that component.\n\n      if (changed && changed.component) {\n        this.customErrors = this.customErrors.filter(function (err) {\n          return err.component && err.component !== changed.component.key;\n        });\n      }\n\n      _get(_getPrototypeOf(Webform.prototype), \"onChange\", this).call(this, flags, true);\n\n      var value = _lodash.default.clone(this.submission);\n\n      flags.changed = value.changed = changed;\n      flags.changes = changes;\n\n      if (modified && this.pristine) {\n        this.pristine = false;\n      }\n\n      value.isValid = this.checkData(value.data, flags);\n      this.loading = false;\n\n      if (this.submitted) {\n        this.showErrors();\n      } // See if we need to save the draft of the form.\n\n\n      if (modified && this.options.saveDraft) {\n        this.triggerSaveDraft();\n      }\n\n      if (!flags || !flags.noEmit) {\n        this.emit('change', value, flags, modified);\n        isChangeEventEmitted = true;\n      } // The form is initialized after the first change event occurs.\n\n\n      if (isChangeEventEmitted && !this.initialized) {\n        this.emit('initialized');\n        this.initialized = true;\n      }\n    }\n  }, {\n    key: \"checkData\",\n    value: function checkData(data) {\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var valid = _get(_getPrototypeOf(Webform.prototype), \"checkData\", this).call(this, data, flags);\n\n      if ((_lodash.default.isEmpty(flags) || flags.noValidate) && this.submitted) {\n        this.showErrors();\n      }\n\n      return valid;\n    }\n    /**\n     * Send a delete request to the server.\n     */\n\n  }, {\n    key: \"deleteSubmission\",\n    value: function deleteSubmission() {\n      var _this18 = this;\n\n      return this.formio.deleteSubmission().then(function () {\n        _this18.emit('submissionDeleted', _this18.submission);\n\n        _this18.resetValue();\n      });\n    }\n    /**\n     * Cancels the submission.\n     *\n     * @alias reset\n     */\n\n  }, {\n    key: \"cancel\",\n    value: function cancel(noconfirm) {\n      var shouldReset = this.hook('beforeCancel', true);\n\n      if (shouldReset && (noconfirm || confirm(this.t('confirmCancel')))) {\n        this.resetValue();\n        return true;\n      } else {\n        this.emit('cancelSubmit');\n        return false;\n      }\n    }\n  }, {\n    key: \"setMetadata\",\n    value: function setMetadata(submission) {\n      // Add in metadata about client submitting the form\n      submission.metadata = submission.metadata || {};\n\n      _lodash.default.defaults(submission.metadata, {\n        timezone: _lodash.default.get(this, '_submission.metadata.timezone', (0, _utils.currentTimezone)()),\n        offset: parseInt(_lodash.default.get(this, '_submission.metadata.offset', (0, _moment.default)().utcOffset()), 10),\n        origin: document.location.origin,\n        referrer: document.referrer,\n        browserName: navigator.appName,\n        userAgent: navigator.userAgent,\n        pathName: window.location.pathname,\n        onLine: navigator.onLine\n      });\n    }\n  }, {\n    key: \"submitForm\",\n    value: function submitForm() {\n      var _this19 = this;\n\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.clearServerErrors();\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        // Read-only forms should never submit.\n        if (_this19.options.readOnly) {\n          return resolve({\n            submission: _this19.submission,\n            saved: false\n          });\n        }\n\n        var submission = (0, _utils.fastCloneDeep)(_this19.submission || {});\n\n        _this19.setMetadata(submission);\n\n        submission.state = options.state || 'submitted';\n        var isDraft = submission.state === 'draft';\n\n        _this19.hook('beforeSubmit', _objectSpread(_objectSpread({}, submission), {}, {\n          component: options.component\n        }), function (err, data) {\n          if (err) {\n            return reject(err);\n          }\n\n          submission._vnote = data && data._vnote ? data._vnote : '';\n\n          if (!isDraft && !submission.data) {\n            return reject('Invalid Submission');\n          }\n\n          if (!isDraft && !_this19.checkValidity(submission.data, true)) {\n            return reject();\n          }\n\n          _this19.everyComponent(function (comp) {\n            var persistent = comp.component.persistent;\n\n            if (persistent === 'client-only') {\n              _lodash.default.unset(submission.data, comp.path);\n            }\n          });\n\n          _this19.hook('customValidation', _objectSpread(_objectSpread({}, submission), {}, {\n            component: options.component\n          }), function (err) {\n            if (err) {\n              // If string is returned, cast to object.\n              if (typeof err === 'string') {\n                err = {\n                  message: err\n                };\n              } // Ensure err is an array.\n\n\n              err = Array.isArray(err) ? err : [err]; // Set as custom errors.\n\n              _this19.customErrors = err;\n              return reject();\n            }\n\n            _this19.loading = true; // Use the form action to submit the form if available.\n\n            if (_this19._form && _this19._form.action) {\n              var method = submission.data._id && _this19._form.action.includes(submission.data._id) ? 'PUT' : 'POST';\n              return _Formio.GlobalFormio.makeStaticRequest(_this19._form.action, method, submission, _this19.formio ? _this19.formio.options : {}).then(function (result) {\n                return resolve({\n                  submission: result,\n                  saved: true\n                });\n              }).catch(function (error) {\n                _this19.setServerErrors(error);\n\n                return reject(error);\n              });\n            }\n\n            var submitFormio = _this19.formio;\n\n            if (_this19.nosubmit || !submitFormio) {\n              return resolve({\n                submission: submission,\n                saved: false\n              });\n            } // If this is an actionUrl, then make sure to save the action and not the submission.\n\n\n            var submitMethod = submitFormio.actionUrl ? 'saveAction' : 'saveSubmission';\n            submitFormio[submitMethod](submission).then(function (result) {\n              return resolve({\n                submission: result,\n                saved: true\n              });\n            }).catch(function (error) {\n              _this19.setServerErrors(error);\n\n              return reject(error);\n            });\n          });\n        });\n      });\n    }\n  }, {\n    key: \"setServerErrors\",\n    value: function setServerErrors(error) {\n      if (error.details) {\n        this.serverErrors = error.details.filter(function (err) {\n          return err.level ? err.level === 'error' : err;\n        }).map(function (err) {\n          err.fromServer = true;\n          return err;\n        });\n      }\n    }\n  }, {\n    key: \"executeSubmit\",\n    value: function executeSubmit(options) {\n      var _this20 = this;\n\n      this.submitted = true;\n      this.submitting = true;\n      return this.submitForm(options).then(function (_ref2) {\n        var submission = _ref2.submission,\n            saved = _ref2.saved;\n        return _this20.onSubmit(submission, saved);\n      }).then(function (results) {\n        _this20.submissionInProcess = false;\n        return results;\n      }).catch(function (err) {\n        _this20.submissionInProcess = false;\n        return _nativePromiseOnly.default.reject(_this20.onSubmissionError(err));\n      });\n    }\n  }, {\n    key: \"clearServerErrors\",\n    value: function clearServerErrors() {\n      var _this$serverErrors,\n          _this21 = this;\n\n      (_this$serverErrors = this.serverErrors) === null || _this$serverErrors === void 0 ? void 0 : _this$serverErrors.forEach(function (error) {\n        if (error.path) {\n          var pathArray = (0, _utils.getArrayFromComponentPath)(error.path);\n\n          var component = _this21.getComponent(pathArray, _lodash.default.identity, error.formattedKeyOrPath);\n\n          if (component) {\n            component.serverErrors = [];\n          }\n        }\n      });\n      this.serverErrors = [];\n    }\n    /**\n     * Submits the form.\n     *\n     * @example\n     * import Webform from 'formiojs/Webform';\n     * let form = new Webform(document.getElementById('formio'));\n     * form.src = 'https://examples.form.io/example';\n     * form.submission = {data: {\n     *   firstName: 'Joe',\n     *   lastName: 'Smith',\n     *   email: 'joe@example.com'\n     * }};\n     * form.submit().then((submission) => {\n     *   console.log(submission);\n     * });\n     *\n     * @param {boolean} before - If this submission occured from the before handlers.\n     *\n     * @returns {Promise} - A promise when the form is done submitting.\n     */\n\n  }, {\n    key: \"submit\",\n    value: function submit(before, options) {\n      var _this22 = this;\n\n      this.submissionInProcess = true;\n\n      if (!before) {\n        return this.beforeSubmit(options).then(function () {\n          return _this22.executeSubmit(options);\n        });\n      } else {\n        return this.executeSubmit(options);\n      }\n    }\n  }, {\n    key: \"submitUrl\",\n    value: function submitUrl(URL, headers) {\n      var _this23 = this;\n\n      if (!URL) {\n        return console.warn('Missing URL argument');\n      }\n\n      var submission = this.submission || {};\n      var API_URL = URL;\n      var settings = {\n        method: 'POST',\n        headers: {}\n      };\n\n      if (headers && headers.length > 0) {\n        headers.map(function (e) {\n          if (e.header !== '' && e.value !== '') {\n            settings.headers[e.header] = _this23.interpolate(e.value, submission);\n          }\n        });\n      }\n\n      if (API_URL && settings) {\n        _Formio.GlobalFormio.makeStaticRequest(API_URL, settings.method, submission, {\n          headers: settings.headers\n        }).then(function () {\n          _this23.emit('requestDone');\n\n          _this23.setAlert('success', '<p> Success </p>');\n        }).catch(function (e) {\n          _this23.showErrors(\"\".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e));\n\n          _this23.emit('error', \"\".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e));\n\n          console.error(\"\".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e));\n\n          _this23.setAlert('danger', \"<p> \".concat(e.statusText ? e.statusText : '', \" \").concat(e.status ? e.status : e, \" </p>\"));\n        });\n      } else {\n        this.emit('error', 'You should add a URL to this button.');\n        this.setAlert('warning', 'You should add a URL to this button.');\n        return console.warn('You should add a URL to this button.');\n      }\n    }\n  }, {\n    key: \"triggerRecaptcha\",\n    value: function triggerRecaptcha() {\n      if (!this || !this.components) {\n        return;\n      }\n\n      var recaptchaComponent = (0, _utils.searchComponents)(this.components, {\n        'component.type': 'recaptcha',\n        'component.eventType': 'formLoad'\n      });\n\n      if (recaptchaComponent.length > 0) {\n        recaptchaComponent[0].verify(\"\".concat(this.form.name ? this.form.name : 'form', \"Load\"));\n      }\n    }\n  }, {\n    key: \"nosubmit\",\n    get: function get() {\n      return this._nosubmit || false;\n    },\n    set: function set(value) {\n      this._nosubmit = !!value;\n      this.emit('nosubmit', this._nosubmit);\n    }\n  }, {\n    key: \"conditions\",\n    get: function get() {\n      var _this$schema$settings, _this$schema$settings2;\n\n      return (_this$schema$settings = (_this$schema$settings2 = this.schema.settings) === null || _this$schema$settings2 === void 0 ? void 0 : _this$schema$settings2.conditions) !== null && _this$schema$settings !== void 0 ? _this$schema$settings : [];\n    }\n  }, {\n    key: \"variables\",\n    get: function get() {\n      var _this$schema$settings3, _this$schema$settings4;\n\n      return (_this$schema$settings3 = (_this$schema$settings4 = this.schema.settings) === null || _this$schema$settings4 === void 0 ? void 0 : _this$schema$settings4.variables) !== null && _this$schema$settings3 !== void 0 ? _this$schema$settings3 : [];\n    }\n  }]);\n\n  return Webform;\n}(_NestedDataComponent2.default);\n\nexports.default = Webform;\nWebform.setBaseUrl = _Formio.GlobalFormio.setBaseUrl;\nWebform.setApiUrl = _Formio.GlobalFormio.setApiUrl;\nWebform.setAppUrl = _Formio.GlobalFormio.setAppUrl;"],"mappings":"AAAA,YAAY;;AAEZA,OAAO,CAAC,+CAA+C,CAAC;AAExDA,OAAO,CAAC,yCAAyC,CAAC;AAElDA,OAAO,CAAC,mCAAmC,CAAC;AAE5CA,OAAO,CAAC,0DAA0D,CAAC;AAEnEA,OAAO,CAAC,mCAAmC,CAAC;AAE5CA,OAAO,CAAC,8BAA8B,CAAC;AAEvCA,OAAO,CAAC,2DAA2D,CAAC;AAEpEA,OAAO,CAAC,0CAA0C,CAAC;AAEnDA,OAAO,CAAC,uCAAuC,CAAC;AAEhDA,OAAO,CAAC,sCAAsC,CAAC;AAE/CA,OAAO,CAAC,uCAAuC,CAAC;AAEhDA,OAAO,CAAC,iDAAiD,CAAC;AAE1DC,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACE,OAAO,GAAG,KAAK,CAAC;AAExBL,OAAO,CAAC,mCAAmC,CAAC;AAE5CA,OAAO,CAAC,oCAAoC,CAAC;AAE7CA,OAAO,CAAC,qCAAqC,CAAC;AAE9CA,OAAO,CAAC,wCAAwC,CAAC;AAEjDA,OAAO,CAAC,iDAAiD,CAAC;AAE1DA,OAAO,CAAC,oCAAoC,CAAC;AAE7CA,OAAO,CAAC,oCAAoC,CAAC;AAE7CA,OAAO,CAAC,sCAAsC,CAAC;AAE/CA,OAAO,CAAC,uCAAuC,CAAC;AAEhDA,OAAO,CAAC,iCAAiC,CAAC;AAI1C,IAAIM,OAAO,GAAGC,sBAAsB,CAACP,OAAO,CAAC,QAAQ,CAAC,CAAC;AAEvD,IAAIQ,OAAO,GAAGD,sBAAsB,CAACP,OAAO,CAAC,QAAQ,CAAC,CAAC;AAEvD,IAAIS,gBAAgB,GAAGF,sBAAsB,CAACP,OAAO,CAAC,kBAAkB,CAAC,CAAC;AAE1E,IAAIU,aAAa,GAAGH,sBAAsB,CAACP,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAErE,IAAIW,QAAQ,GAAGJ,sBAAsB,CAACP,OAAO,CAAC,SAAS,CAAC,CAAC;AAEzD,IAAIY,KAAK,GAAGL,sBAAsB,CAACP,OAAO,CAAC,QAAQ,CAAC,CAAC;AAErD,IAAIa,OAAO,GAAGb,OAAO,CAAC,UAAU,CAAC;AAEjC,IAAIc,kBAAkB,GAAGP,sBAAsB,CAACP,OAAO,CAAC,qBAAqB,CAAC,CAAC;AAE/E,IAAIe,WAAW,GAAGR,sBAAsB,CAACP,OAAO,CAAC,yBAAyB,CAAC,CAAC;AAE5E,IAAIgB,qBAAqB,GAAGT,sBAAsB,CAACP,OAAO,CAAC,sDAAsD,CAAC,CAAC;AAEnH,IAAIiB,MAAM,GAAGjB,OAAO,CAAC,eAAe,CAAC;AAErC,IAAIkB,UAAU,GAAGlB,OAAO,CAAC,mBAAmB,CAAC;AAE7C,SAASO,sBAAsB,CAACY,GAAG,EAAE;EAAE,OAAOA,GAAG,IAAIA,GAAG,CAACC,UAAU,GAAGD,GAAG,GAAG;IAAEd,OAAO,EAAEc;EAAI,CAAC;AAAE;AAE9F,SAASE,OAAO,CAACF,GAAG,EAAE;EAAE,yBAAyB;;EAAE,OAAOE,OAAO,GAAG,UAAU,IAAI,OAAOC,MAAM,IAAI,QAAQ,IAAI,OAAOA,MAAM,CAACC,QAAQ,GAAG,UAAUJ,GAAG,EAAE;IAAE,OAAO,OAAOA,GAAG;EAAE,CAAC,GAAG,UAAUA,GAAG,EAAE;IAAE,OAAOA,GAAG,IAAI,UAAU,IAAI,OAAOG,MAAM,IAAIH,GAAG,CAACK,WAAW,KAAKF,MAAM,IAAIH,GAAG,KAAKG,MAAM,CAACG,SAAS,GAAG,QAAQ,GAAG,OAAON,GAAG;EAAE,CAAC,EAAEE,OAAO,CAACF,GAAG,CAAC;AAAE;AAE/U,SAASO,OAAO,CAACC,MAAM,EAAEC,cAAc,EAAE;EAAE,IAAIC,IAAI,GAAG5B,MAAM,CAAC4B,IAAI,CAACF,MAAM,CAAC;EAAE,IAAI1B,MAAM,CAAC6B,qBAAqB,EAAE;IAAE,IAAIC,OAAO,GAAG9B,MAAM,CAAC6B,qBAAqB,CAACH,MAAM,CAAC;IAAEC,cAAc,KAAKG,OAAO,GAAGA,OAAO,CAACC,MAAM,CAAC,UAAUC,GAAG,EAAE;MAAE,OAAOhC,MAAM,CAACiC,wBAAwB,CAACP,MAAM,EAAEM,GAAG,CAAC,CAACE,UAAU;IAAE,CAAC,CAAC,CAAC,EAAEN,IAAI,CAACO,IAAI,CAACC,KAAK,CAACR,IAAI,EAAEE,OAAO,CAAC;EAAE;EAAE,OAAOF,IAAI;AAAE;AAEpV,SAASS,aAAa,CAACC,MAAM,EAAE;EAAE,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,SAAS,CAACC,MAAM,EAAEF,CAAC,EAAE,EAAE;IAAE,IAAIG,MAAM,GAAG,IAAI,IAAIF,SAAS,CAACD,CAAC,CAAC,GAAGC,SAAS,CAACD,CAAC,CAAC,GAAG,CAAC,CAAC;IAAEA,CAAC,GAAG,CAAC,GAAGd,OAAO,CAACzB,MAAM,CAAC0C,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC,CAACC,OAAO,CAAC,UAAUC,GAAG,EAAE;MAAEC,eAAe,CAACP,MAAM,EAAEM,GAAG,EAAEF,MAAM,CAACE,GAAG,CAAC,CAAC;IAAE,CAAC,CAAC,GAAG5C,MAAM,CAAC8C,yBAAyB,GAAG9C,MAAM,CAAC+C,gBAAgB,CAACT,MAAM,EAAEtC,MAAM,CAAC8C,yBAAyB,CAACJ,MAAM,CAAC,CAAC,GAAGjB,OAAO,CAACzB,MAAM,CAAC0C,MAAM,CAAC,CAAC,CAACC,OAAO,CAAC,UAAUC,GAAG,EAAE;MAAE5C,MAAM,CAACC,cAAc,CAACqC,MAAM,EAAEM,GAAG,EAAE5C,MAAM,CAACiC,wBAAwB,CAACS,MAAM,EAAEE,GAAG,CAAC,CAAC;IAAE,CAAC,CAAC;EAAE;EAAE,OAAON,MAAM;AAAE;AAEzf,SAASU,eAAe,CAACC,QAAQ,EAAEC,WAAW,EAAE;EAAE,IAAI,EAAED,QAAQ,YAAYC,WAAW,CAAC,EAAE;IAAE,MAAM,IAAIC,SAAS,CAAC,mCAAmC,CAAC;EAAE;AAAE;AAExJ,SAASC,iBAAiB,CAACd,MAAM,EAAEe,KAAK,EAAE;EAAE,KAAK,IAAId,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGc,KAAK,CAACZ,MAAM,EAAEF,CAAC,EAAE,EAAE;IAAE,IAAIe,UAAU,GAAGD,KAAK,CAACd,CAAC,CAAC;IAAEe,UAAU,CAACpB,UAAU,GAAGoB,UAAU,CAACpB,UAAU,IAAI,KAAK;IAAEoB,UAAU,CAACC,YAAY,GAAG,IAAI;IAAE,IAAI,OAAO,IAAID,UAAU,EAAEA,UAAU,CAACE,QAAQ,GAAG,IAAI;IAAExD,MAAM,CAACC,cAAc,CAACqC,MAAM,EAAEgB,UAAU,CAACV,GAAG,EAAEU,UAAU,CAAC;EAAE;AAAE;AAE5T,SAASG,YAAY,CAACP,WAAW,EAAEQ,UAAU,EAAEC,WAAW,EAAE;EAAE,IAAID,UAAU,EAAEN,iBAAiB,CAACF,WAAW,CAAC1B,SAAS,EAAEkC,UAAU,CAAC;EAAE,IAAIC,WAAW,EAAEP,iBAAiB,CAACF,WAAW,EAAES,WAAW,CAAC;EAAE3D,MAAM,CAACC,cAAc,CAACiD,WAAW,EAAE,WAAW,EAAE;IAAEM,QAAQ,EAAE;EAAM,CAAC,CAAC;EAAE,OAAON,WAAW;AAAE;AAE5R,SAASU,IAAI,GAAG;EAAE,IAAI,OAAOC,OAAO,KAAK,WAAW,IAAIA,OAAO,CAACC,GAAG,EAAE;IAAEF,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,IAAI,EAAE;EAAE,CAAC,MAAM;IAAEH,IAAI,GAAG,SAASA,IAAI,CAACtB,MAAM,EAAE0B,QAAQ,EAAEC,QAAQ,EAAE;MAAE,IAAIC,IAAI,GAAGC,cAAc,CAAC7B,MAAM,EAAE0B,QAAQ,CAAC;MAAE,IAAI,CAACE,IAAI,EAAE;MAAQ,IAAIE,IAAI,GAAGpE,MAAM,CAACiC,wBAAwB,CAACiC,IAAI,EAAEF,QAAQ,CAAC;MAAE,IAAII,IAAI,CAACN,GAAG,EAAE;QAAE,OAAOM,IAAI,CAACN,GAAG,CAACO,IAAI,CAAC7B,SAAS,CAACC,MAAM,GAAG,CAAC,GAAGH,MAAM,GAAG2B,QAAQ,CAAC;MAAE;MAAE,OAAOG,IAAI,CAACjE,KAAK;IAAE,CAAC;EAAE;EAAE,OAAOyD,IAAI,CAACxB,KAAK,CAAC,IAAI,EAAEI,SAAS,CAAC;AAAE;AAExa,SAAS2B,cAAc,CAACzC,MAAM,EAAEsC,QAAQ,EAAE;EAAE,OAAO,CAAChE,MAAM,CAACwB,SAAS,CAAC8C,cAAc,CAACD,IAAI,CAAC3C,MAAM,EAAEsC,QAAQ,CAAC,EAAE;IAAEtC,MAAM,GAAG6C,eAAe,CAAC7C,MAAM,CAAC;IAAE,IAAIA,MAAM,KAAK,IAAI,EAAE;EAAO;EAAE,OAAOA,MAAM;AAAE;AAE7L,SAAS8C,SAAS,CAACC,QAAQ,EAAEC,UAAU,EAAE;EAAE,IAAI,OAAOA,UAAU,KAAK,UAAU,IAAIA,UAAU,KAAK,IAAI,EAAE;IAAE,MAAM,IAAIvB,SAAS,CAAC,oDAAoD,CAAC;EAAE;EAAEsB,QAAQ,CAACjD,SAAS,GAAGxB,MAAM,CAAC2E,MAAM,CAACD,UAAU,IAAIA,UAAU,CAAClD,SAAS,EAAE;IAAED,WAAW,EAAE;MAAEpB,KAAK,EAAEsE,QAAQ;MAAEjB,QAAQ,EAAE,IAAI;MAAED,YAAY,EAAE;IAAK;EAAE,CAAC,CAAC;EAAEvD,MAAM,CAACC,cAAc,CAACwE,QAAQ,EAAE,WAAW,EAAE;IAAEjB,QAAQ,EAAE;EAAM,CAAC,CAAC;EAAE,IAAIkB,UAAU,EAAEE,eAAe,CAACH,QAAQ,EAAEC,UAAU,CAAC;AAAE;AAEnc,SAASE,eAAe,CAACC,CAAC,EAAEC,CAAC,EAAE;EAAEF,eAAe,GAAG5E,MAAM,CAAC+E,cAAc,GAAG/E,MAAM,CAAC+E,cAAc,CAAChB,IAAI,EAAE,GAAG,SAASa,eAAe,CAACC,CAAC,EAAEC,CAAC,EAAE;IAAED,CAAC,CAACG,SAAS,GAAGF,CAAC;IAAE,OAAOD,CAAC;EAAE,CAAC;EAAE,OAAOD,eAAe,CAACC,CAAC,EAAEC,CAAC,CAAC;AAAE;AAEvM,SAASG,YAAY,CAACC,OAAO,EAAE;EAAE,IAAIC,yBAAyB,GAAGC,yBAAyB,EAAE;EAAE,OAAO,SAASC,oBAAoB,GAAG;IAAE,IAAIC,KAAK,GAAGf,eAAe,CAACW,OAAO,CAAC;MAAEK,MAAM;IAAE,IAAIJ,yBAAyB,EAAE;MAAE,IAAIK,SAAS,GAAGjB,eAAe,CAAC,IAAI,CAAC,CAAChD,WAAW;MAAEgE,MAAM,GAAG1B,OAAO,CAAC4B,SAAS,CAACH,KAAK,EAAE9C,SAAS,EAAEgD,SAAS,CAAC;IAAE,CAAC,MAAM;MAAED,MAAM,GAAGD,KAAK,CAAClD,KAAK,CAAC,IAAI,EAAEI,SAAS,CAAC;IAAE;IAAE,OAAOkD,0BAA0B,CAAC,IAAI,EAAEH,MAAM,CAAC;EAAE,CAAC;AAAE;AAExa,SAASG,0BAA0B,CAACC,IAAI,EAAEtB,IAAI,EAAE;EAAE,IAAIA,IAAI,KAAKjD,OAAO,CAACiD,IAAI,CAAC,KAAK,QAAQ,IAAI,OAAOA,IAAI,KAAK,UAAU,CAAC,EAAE;IAAE,OAAOA,IAAI;EAAE,CAAC,MAAM,IAAIA,IAAI,KAAK,KAAK,CAAC,EAAE;IAAE,MAAM,IAAIlB,SAAS,CAAC,0DAA0D,CAAC;EAAE;EAAE,OAAOyC,sBAAsB,CAACD,IAAI,CAAC;AAAE;AAE/R,SAASC,sBAAsB,CAACD,IAAI,EAAE;EAAE,IAAIA,IAAI,KAAK,KAAK,CAAC,EAAE;IAAE,MAAM,IAAIE,cAAc,CAAC,2DAA2D,CAAC;EAAE;EAAE,OAAOF,IAAI;AAAE;AAErK,SAASP,yBAAyB,GAAG;EAAE,IAAI,OAAOvB,OAAO,KAAK,WAAW,IAAI,CAACA,OAAO,CAAC4B,SAAS,EAAE,OAAO,KAAK;EAAE,IAAI5B,OAAO,CAAC4B,SAAS,CAACK,IAAI,EAAE,OAAO,KAAK;EAAE,IAAI,OAAOC,KAAK,KAAK,UAAU,EAAE,OAAO,IAAI;EAAE,IAAI;IAAEC,OAAO,CAACxE,SAAS,CAACyE,OAAO,CAAC5B,IAAI,CAACR,OAAO,CAAC4B,SAAS,CAACO,OAAO,EAAE,EAAE,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC;IAAE,OAAO,IAAI;EAAE,CAAC,CAAC,OAAOE,CAAC,EAAE;IAAE,OAAO,KAAK;EAAE;AAAE;AAExU,SAAS3B,eAAe,CAACM,CAAC,EAAE;EAAEN,eAAe,GAAGvE,MAAM,CAAC+E,cAAc,GAAG/E,MAAM,CAACmG,cAAc,CAACpC,IAAI,EAAE,GAAG,SAASQ,eAAe,CAACM,CAAC,EAAE;IAAE,OAAOA,CAAC,CAACG,SAAS,IAAIhF,MAAM,CAACmG,cAAc,CAACtB,CAAC,CAAC;EAAE,CAAC;EAAE,OAAON,eAAe,CAACM,CAAC,CAAC;AAAE;AAEnN,SAAShC,eAAe,CAAC3B,GAAG,EAAE0B,GAAG,EAAEzC,KAAK,EAAE;EAAE,IAAIyC,GAAG,IAAI1B,GAAG,EAAE;IAAElB,MAAM,CAACC,cAAc,CAACiB,GAAG,EAAE0B,GAAG,EAAE;MAAEzC,KAAK,EAAEA,KAAK;MAAE+B,UAAU,EAAE,IAAI;MAAEqB,YAAY,EAAE,IAAI;MAAEC,QAAQ,EAAE;IAAK,CAAC,CAAC;EAAE,CAAC,MAAM;IAAEtC,GAAG,CAAC0B,GAAG,CAAC,GAAGzC,KAAK;EAAE;EAAE,OAAOe,GAAG;AAAE;;AAEhN;AACAN,OAAO,CAACwF,YAAY,CAACC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;;AAEjCzF,OAAO,CAACwF,YAAY,CAACE,iBAAiB,GAAGxF,WAAW,CAACV,OAAO,CAACmG,YAAY;AAEzE,SAASC,UAAU,CAACC,KAAK,EAAE;EACzB,IAAIA,KAAK,KAAK,aAAa,EAAE;IAC3B,OAAO,IAAI;EACb;EAEA,OAAOA,KAAK,IAAI,EAAE;AACpB;AAEA,SAASC,UAAU,CAACC,OAAO,EAAE;EAC3BA,OAAO,GAAGtG,OAAO,CAACD,OAAO,CAACwG,QAAQ,CAACD,OAAO,EAAE;IAC1CE,aAAa,EAAE,KAAK;IACpBC,OAAO,EAAEN,UAAU,CAACG,OAAO,IAAIA,OAAO,CAACF,KAAK,GAAGE,OAAO,CAACF,KAAK,GAAG7F,OAAO,CAACwF,YAAY,CAACK,KAAK,CAAC;IAC1FM,OAAO,EAAErG,QAAQ,CAACN,OAAO;IACzB4G,SAAS,EAAE,KAAK;IAChBC,WAAW,EAAE,KAAK;IAClBC,iBAAiB,EAAE,IAAI;IACvBC,OAAO,EAAE,MAAM;IACfC,MAAM,EAAExG,OAAO,CAACwF,YAAY,CAACiB,GAAG,CAACC;EACnC,CAAC,CAAC;EAEF,IAAI,CAACX,OAAO,CAACY,MAAM,EAAE;IACnBZ,OAAO,CAACY,MAAM,GAAG,IAAI9G,aAAa,CAACL,OAAO,EAAE;EAC9C;EAEA,OAAOuG,OAAO;AAChB;AACA;AACA;AACA;;AAGA,IAAIa,OAAO,GAAG,aAAa,UAAUC,oBAAoB,EAAE;EACzDjD,SAAS,CAACgD,OAAO,EAAEC,oBAAoB,CAAC;EAExC,IAAIC,MAAM,GAAGzC,YAAY,CAACuC,OAAO,CAAC;;EAElC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEE;EACA,SAASA,OAAO,GAAG;IACjB,IAAIG,MAAM;IAEV3E,eAAe,CAAC,IAAI,EAAEwE,OAAO,CAAC;IAE9B,IAAII,OAAO,EAAEjB,OAAO;IAEpB,IAAInE,SAAS,CAAC,CAAC,CAAC,YAAYqF,WAAW,IAAIrF,SAAS,CAAC,CAAC,CAAC,EAAE;MACvDoF,OAAO,GAAGpF,SAAS,CAAC,CAAC,CAAC;MACtBmE,OAAO,GAAGnE,SAAS,CAAC,CAAC,CAAC;IACxB,CAAC,MAAM;MACLmE,OAAO,GAAGnE,SAAS,CAAC,CAAC,CAAC;IACxB;IAEAmF,MAAM,GAAGD,MAAM,CAACrD,IAAI,CAAC,IAAI,EAAE,IAAI,EAAEqC,UAAU,CAACC,OAAO,CAAC,CAAC;IAErD9D,eAAe,CAAC+C,sBAAsB,CAAC+B,MAAM,CAAC,EAAE,kBAAkB,EAAE,UAAUG,KAAK,EAAE;MACnF,IAAIxF,MAAM,GAAGwF,KAAK,CAACxF,MAAM;MAEzB,IAAI,CAACqF,MAAM,CAACI,wBAAwB,CAACzF,MAAM,CAAC,EAAE;QAC5C;MACF;MAEA,IAAI0F,IAAI,GAAGF,KAAK,CAACG,OAAO,IAAIH,KAAK,CAACI,OAAO;MACzC,IAAIC,OAAO,GAAGL,KAAK,CAACK,OAAO;MAC3B,IAAIC,IAAI,GAAG,EAAE;MAEb,IAAI,EAAE,IAAID,OAAO,IAAIA,OAAO,IAAI,EAAE,EAAE;QAClCC,IAAI,GAAGC,MAAM,CAACC,YAAY,CAACH,OAAO,CAAC;MACrC,CAAC,MAAM,IAAIA,OAAO,KAAK,EAAE,EAAE;QACzBC,IAAI,GAAG,OAAO;MAChB,CAAC,MAAM,IAAID,OAAO,KAAK,EAAE,EAAE;QACzBC,IAAI,GAAG,KAAK;MACd;MAEA/H,OAAO,CAACD,OAAO,CAACmI,IAAI,CAACZ,MAAM,CAACa,SAAS,EAAE,UAAUC,QAAQ,EAAE;QACzD,IAAIA,QAAQ,CAACT,IAAI,IAAI,CAACA,IAAI,EAAE;UAC1B;QACF;QAEA,IAAIS,QAAQ,CAACA,QAAQ,KAAKL,IAAI,EAAE;UAC9BK,QAAQ,CAACb,OAAO,CAACc,KAAK,EAAE;UACxBZ,KAAK,CAACa,cAAc,EAAE;QACxB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IAEFhB,MAAM,CAACC,OAAO,GAAGA,OAAO,CAAC,CAAC;;IAE1BhH,OAAO,CAACwF,YAAY,CAACC,KAAK,CAACsB,MAAM,CAACiB,EAAE,CAAC,GAAGhD,sBAAsB,CAAC+B,MAAM,CAAC,CAAC,CAAC;;IAExE,IAAIA,MAAM,CAAChB,OAAO,CAACW,OAAO,EAAE;MAC1B1G,OAAO,CAACwF,YAAY,CAACyC,UAAU,CAAClB,MAAM,CAAChB,OAAO,CAACW,OAAO,CAAC;IACzD;IACA;AACJ;AACA;;IAGI,IAAIwB,IAAI,GAAGnI,KAAK,CAACP,OAAO;IAExB,IAAIuG,OAAO,IAAIA,OAAO,CAACmC,IAAI,IAAI,CAACnC,OAAO,CAACoC,SAAS,EAAE;MACjD;MACA,IAAIpC,OAAO,CAACmC,IAAI,CAACE,SAAS,EAAE;QAC1BF,IAAI,GAAGnC,OAAO,CAACmC,IAAI;MACrB,CAAC,MAAM;QACLzI,OAAO,CAACD,OAAO,CAACmI,IAAI,CAAC5B,OAAO,CAACmC,IAAI,EAAE,UAAUG,IAAI,EAAEC,IAAI,EAAE;UACvD,IAAIA,IAAI,KAAK,SAAS,EAAE;YACtB7I,OAAO,CAACD,OAAO,CAAC+I,KAAK,CAACL,IAAI,EAAEG,IAAI,CAAC;UACnC,CAAC,MAAM,IAAI,CAACH,IAAI,CAACE,SAAS,CAACE,IAAI,CAAC,EAAE;YAChC;YACAJ,IAAI,CAACE,SAAS,CAACE,IAAI,CAAC,GAAG;cACrBE,WAAW,EAAE/I,OAAO,CAACD,OAAO,CAACiJ,MAAM,CAAC,CAAC,CAAC,EAAErI,MAAM,CAACsI,aAAa,EAAE3I,KAAK,CAACP,OAAO,CAAC4I,SAAS,CAACO,EAAE,CAACH,WAAW,CAAC,EAAEH,IAAI;YAC7G,CAAC;UACH,CAAC,MAAM;YACL5I,OAAO,CAACD,OAAO,CAACiJ,MAAM,CAACP,IAAI,CAACE,SAAS,CAACE,IAAI,CAAC,CAACE,WAAW,EAAEH,IAAI,CAAC;UAChE;QACF,CAAC,CAAC;MACJ;MAEAtC,OAAO,CAACmC,IAAI,GAAGA,IAAI;MACnBnC,OAAO,CAACoC,SAAS,GAAG,IAAI;IAC1B;IAEA,IAAIpC,OAAO,IAAIA,OAAO,CAACmC,IAAI,EAAE;MAC3BnB,MAAM,CAAChB,OAAO,CAACmC,IAAI,GAAGnC,OAAO,CAACmC,IAAI;IACpC,CAAC,MAAM;MACLnB,MAAM,CAAChB,OAAO,CAACmC,IAAI,GAAGA,IAAI;IAC5B,CAAC,CAAC;;IAGF,IAAInB,MAAM,CAAChB,OAAO,CAAC6C,QAAQ,EAAE;MAC3B7B,MAAM,CAAChB,OAAO,CAACmC,IAAI,CAACW,GAAG,GAAG9B,MAAM,CAAChB,OAAO,CAAC6C,QAAQ;IACnD;IACA;AACJ;AACA;AACA;;IAGI7B,MAAM,CAAC+B,IAAI,GAAG,MAAM;IACpB/B,MAAM,CAACgC,IAAI,GAAG,EAAE;IAChBhC,MAAM,CAACiC,QAAQ,GAAG,KAAK;IACvBjC,MAAM,CAACkC,KAAK,GAAG,CAAC,CAAC;IACjBlC,MAAM,CAACmC,YAAY,GAAG,KAAK;IAC3BnC,MAAM,CAACoC,WAAW,GAAG,IAAI;IAEzB,IAAIpC,MAAM,CAAChB,OAAO,CAACO,iBAAiB,EAAE;MACpCS,MAAM,CAACqC,gBAAgB,GAAG3J,OAAO,CAACD,OAAO,CAAC6J,QAAQ,CAACtC,MAAM,CAACX,SAAS,CAACjD,IAAI,CAAC6B,sBAAsB,CAAC+B,MAAM,CAAC,CAAC,EAAEA,MAAM,CAAChB,OAAO,CAACO,iBAAiB,CAAC;IAC7I,CAAC,MAAM;MACLS,MAAM,CAACqC,gBAAgB,GAAGrC,MAAM,CAACX,SAAS,CAACjD,IAAI,CAAC6B,sBAAsB,CAAC+B,MAAM,CAAC,CAAC;IACjF;IAEAA,MAAM,CAACuC,YAAY,GAAG,EAAE;IACxB;AACJ;AACA;AACA;;IAEIvC,MAAM,CAACwC,QAAQ,GAAG,KAAK;IACvB;AACJ;AACA;AACA;AACA;;IAEIxC,MAAM,CAACyC,SAAS,GAAG,KAAK;IACxB;AACJ;AACA;AACA;AACA;;IAEIzC,MAAM,CAAC0C,UAAU,GAAG,KAAK;IACzB;AACJ;AACA;AACA;;IAEI1C,MAAM,CAAC2C,MAAM,GAAG,IAAI;IACpB;AACJ;AACA;AACA;;IAEI3C,MAAM,CAAC4C,MAAM,GAAG,IAAI;IACpB;AACJ;AACA;AACA;;IAEI5C,MAAM,CAAC6C,KAAK,GAAG,IAAI;IACnB;AACJ;AACA;AACA;;IAEI7C,MAAM,CAAC8C,YAAY,GAAG,IAAI;IAC1B;AACJ;AACA;AACA;;IAEI9C,MAAM,CAAC+C,aAAa,GAAG,KAAK;IAC5B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEI/C,MAAM,CAACgD,SAAS,GAAG,IAAI9J,kBAAkB,CAACT,OAAO,CAAC,UAAUwK,OAAO,EAAEC,MAAM,EAAE;MAC3E;AACN;AACA;AACA;AACA;MACMlD,MAAM,CAACmD,gBAAgB,GAAGF,OAAO;MACjC;AACN;AACA;AACA;AACA;;MAEMjD,MAAM,CAACoD,eAAe,GAAGF,MAAM;IACjC,CAAC,CAAC;IACF;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEIlD,MAAM,CAACqD,eAAe,GAAG,IAAInK,kBAAkB,CAACT,OAAO,CAAC,UAAUwK,OAAO,EAAEC,MAAM,EAAE;MACjF;AACN;AACA;AACA;AACA;MACMlD,MAAM,CAACsD,sBAAsB,GAAGL,OAAO;MACvC;AACN;AACA;AACA;AACA;;MAEMjD,MAAM,CAACuD,qBAAqB,GAAGL,MAAM;IACvC,CAAC,CAAC;IACFlD,MAAM,CAACa,SAAS,GAAG,EAAE,CAAC,CAAC;;IAEvBb,MAAM,CAACwD,QAAQ,EAAE,CAACC,IAAI,CAAC,YAAY;MACjCzD,MAAM,CAAC6B,QAAQ,GAAG7B,MAAM,CAAChB,OAAO,CAAC6C,QAAQ;IAC3C,CAAC,CAAC,CAAC,CAAC;;IAGJ,IAAI7B,MAAM,CAAChB,OAAO,CAACK,SAAS,IAAI,CAACW,MAAM,CAAChB,OAAO,CAAC0E,gBAAgB,EAAE;MAChE,IAAIC,IAAI,GAAG1K,OAAO,CAACwF,YAAY,CAACmF,OAAO,EAAE,CAAC,CAAC;;MAG3C,IAAID,IAAI,IAAI,CAAC3D,MAAM,CAAC+C,aAAa,EAAE;QACjC/C,MAAM,CAAC6D,YAAY,CAACF,IAAI,CAACG,GAAG,CAAC;MAC/B;IACF;IAEA9D,MAAM,CAAC+D,SAAS,CAACC,WAAW,GAAG,KAAK,CAAC,CAAC;;IAEtChE,MAAM,CAACiE,IAAI,GAAGhG,sBAAsB,CAAC+B,MAAM,CAAC;IAC5CA,MAAM,CAACkE,SAAS,GAAGjG,sBAAsB,CAAC+B,MAAM,CAAC;IACjD,OAAOA,MAAM;EACf;EACA;;EAGAlE,YAAY,CAAC+D,OAAO,EAAE,CAAC;IACrB5E,GAAG,EAAE,UAAU;IACfkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAAC6C,OAAO,CAAC6C,QAAQ;IAC9B,CAAC;IACDsC,GAAG;IACH;AACJ;AACA;AACA;AACA;AACA;IACI,SAASA,GAAG,CAAC7C,IAAI,EAAE;MACjB,IAAI8C,MAAM,GAAG,IAAI;MAEjB,IAAI,CAACpF,OAAO,CAAC6C,QAAQ,GAAGP,IAAI;MAE5B,IAAI,IAAI,CAAClC,OAAO,CAACyC,QAAQ,KAAKP,IAAI,EAAE;QAClC;MACF;MAEA,IAAI;QACF,IAAI,CAAClC,OAAO,CAACiF,cAAc,CAAC/C,IAAI,EAAE,UAAUgD,GAAG,EAAE;UAC/C,IAAIA,GAAG,EAAE;YACP;UACF;UAEAF,MAAM,CAACG,MAAM,EAAE;UAEfH,MAAM,CAACI,IAAI,CAAC,iBAAiB,CAAC;QAChC,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOF,GAAG,EAAE;QACZ;MACF;IACF;EACF,CAAC,EAAE;IACDrJ,GAAG,EAAE,YAAY;IACjBkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI;IACb;EACF,CAAC,EAAE;IACDlB,GAAG,EAAE,kBAAkB;IACvBzC,KAAK,EAAE,SAASiM,gBAAgB,GAAG;MACjC,OAAO,IAAI,CAACC,KAAK;IACnB;EACF,CAAC,EAAE;IACDzJ,GAAG,EAAE,qBAAqB;IAC1BkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAACwI,IAAI,CAACC,UAAU;IAC7B;EACF,CAAC,EAAE;IACD3J,GAAG,EAAE,YAAY;IACjBkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAAC6C,OAAO,CAAC6F,UAAU;IAChC;IACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACD5J,GAAG,EAAE,aAAa;IAClBzC,KAAK,EAAE,SAASsM,WAAW,CAACvD,IAAI,EAAED,IAAI,EAAE;MACtC,IAAIyD,MAAM,GAAGlK,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKmK,SAAS,GAAGnK,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK;MAEtF,IAAIoK,YAAY,GAAGvM,OAAO,CAACD,OAAO,CAACiJ,MAAM,CAAC,CAAC,CAAC,EAAErI,MAAM,CAACsI,aAAa,EAAE3I,KAAK,CAACP,OAAO,CAAC4I,SAAS,CAACO,EAAE,CAACH,WAAW,CAAC,EAAEH,IAAI,CAAC;MAElH,IAAI,CAAClC,OAAO,CAAC8F,iBAAiB,CAAC3D,IAAI,EAAE,aAAa,EAAE0D,YAAY,EAAE,IAAI,EAAE,IAAI,CAAC;MAE7E,IAAIF,MAAM,EAAE;QACV,IAAI,CAAClD,QAAQ,GAAGN,IAAI;MACtB;IACF;IACA;AACJ;AACA;AACA;EAEE,CAAC,EAAE;IACDtG,GAAG,EAAE,UAAU;IACfzC,KAAK,EAAE,SAASgL,QAAQ,GAAG;MACzB,IAAI2B,MAAM,GAAG,IAAI;MAEjB,IAAI,IAAI,CAAC/F,OAAO,CAACgG,WAAW,EAAE;QAC5B,OAAOlM,kBAAkB,CAACT,OAAO,CAACwK,OAAO,CAAC,IAAI,CAAC7D,OAAO,CAAC;MACzD;MAEA,IAAI,CAACA,OAAO,CAACgG,WAAW,GAAG,IAAI;MAC/B,OAAO,IAAIlM,kBAAkB,CAACT,OAAO,CAAC,UAAUwK,OAAO,EAAEC,MAAM,EAAE;QAC/D,IAAI;UACFiC,MAAM,CAAC/F,OAAO,CAACiG,IAAI,CAAC3K,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEyK,MAAM,CAACnG,OAAO,CAACmC,IAAI,CAAC,EAAE;YACxEmE,iBAAiB,EAAE;UACrB,CAAC,CAAC,EAAE,UAAUhB,GAAG,EAAE;YACjB;YACAa,MAAM,CAACnG,OAAO,CAAC6C,QAAQ,GAAGsD,MAAM,CAAC/F,OAAO,CAACyC,QAAQ,CAAC0D,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YAE/D,IAAIjB,GAAG,EAAE;cACP,OAAOpB,MAAM,CAACoB,GAAG,CAAC;YACpB;YAEArB,OAAO,CAACkC,MAAM,CAAC/F,OAAO,CAAC;UACzB,CAAC,CAAC;QACJ,CAAC,CAAC,OAAOkF,GAAG,EAAE;UACZ,OAAOpB,MAAM,CAACoB,GAAG,CAAC;QACpB;MACF,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACDrJ,GAAG,EAAE,0BAA0B;IAC/BzC,KAAK,EAAE,SAAS4H,wBAAwB,CAACH,OAAO,EAAE;MAChD,IAAIA,OAAO,CAACuF,QAAQ,KAAK,UAAU,EAAE;QACnC,OAAO,KAAK;MACd;MAEA,IAAIvF,OAAO,CAACuF,QAAQ,KAAK,OAAO,EAAE;QAChC,OAAO,CAAC,MAAM,EAAE,OAAO,EAAE,UAAU,CAAC,CAACC,OAAO,CAACxF,OAAO,CAAC8B,IAAI,CAAC,KAAK,CAAC,CAAC;MACnE;MAEA,OAAO,IAAI;IACb;EACF,CAAC,EAAE;IACD9G,GAAG,EAAE,aAAa;IAClBzC,KAAK,EAAE,SAASkN,WAAW,CAACzF,OAAO,EAAEa,QAAQ,EAAE;MAC7C,IAAI,CAACA,QAAQ,IAAI,CAAC,sBAAsB,CAAC6E,IAAI,CAAC7E,QAAQ,CAAC,EAAE;QACvD;MACF;MAEAA,QAAQ,GAAGpI,OAAO,CAACD,OAAO,CAACmN,UAAU,CAAC9E,QAAQ,CAAC;MAE/C,IAAIA,QAAQ,KAAK,OAAO,IAAIA,QAAQ,KAAK,KAAK,EAAE;QAC9C;QACA,IAAIb,OAAO,CAAC4F,OAAO,KAAK,QAAQ,EAAE;UAChC;QACF;QAEA,IAAI,CAAChF,SAAS,CAACrG,IAAI,CAAC;UAClBsG,QAAQ,EAAEA,QAAQ;UAClBb,OAAO,EAAEA;QACX,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,IAAI,CAACY,SAAS,CAACrG,IAAI,CAAC;UAClB6F,IAAI,EAAE,IAAI;UACVS,QAAQ,EAAEA,QAAQ;UAClBb,OAAO,EAAEA;QACX,CAAC,CAAC;MACJ;IACF;EACF,CAAC,EAAE;IACDhF,GAAG,EAAE,gBAAgB;IACrBzC,KAAK,EAAE,SAASsN,cAAc,CAAC7F,OAAO,EAAEa,QAAQ,EAAE;MAChD,IAAI,CAACA,QAAQ,IAAI,CAAC,sBAAsB,CAAC6E,IAAI,CAAC7E,QAAQ,CAAC,EAAE;QACvD;MACF;MAEApI,OAAO,CAACD,OAAO,CAACsN,MAAM,CAAC,IAAI,CAAClF,SAAS,EAAE;QACrCC,QAAQ,EAAEA,QAAQ;QAClBb,OAAO,EAAEA;MACX,CAAC,CAAC;IACJ;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDhF,GAAG,EAAE,KAAK;IACVkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAAC6F,IAAI;IAClB;IACA;AACJ;AACA,OAFI;;IAIAmC,GAAG;IACH;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACI,SAASA,GAAG,CAAC3L,KAAK,EAAE;MAClB,IAAI,CAACwN,MAAM,CAACxN,KAAK,CAAC;IACpB;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDyC,GAAG,EAAE,gBAAgB;IACrBzC,KAAK,EAAE,SAASyN,cAAc,GAAG;MAC/B,IAAIC,MAAM,GAAG,IAAI;MAEjB,IAAI,CAACC,iBAAiB,GAAG,IAAI;MAE7B,IAAI,IAAI,CAACxD,MAAM,CAACyD,YAAY,EAAE;QAC5B,IAAI,CAACtD,YAAY,GAAG,IAAI,CAACH,MAAM,CAACsD,cAAc,EAAE,CAACxC,IAAI,CAAC,UAAU4C,UAAU,EAAE;UAC1E,OAAOH,MAAM,CAACI,aAAa,CAACD,UAAU,CAAC;QACzC,CAAC,EAAE,UAAU/B,GAAG,EAAE;UAChB,OAAO4B,MAAM,CAAC3C,qBAAqB,CAACe,GAAG,CAAC;QAC1C,CAAC,CAAC,CAACiC,KAAK,CAAC,UAAUjC,GAAG,EAAE;UACtB,OAAO4B,MAAM,CAAC3C,qBAAqB,CAACe,GAAG,CAAC;QAC1C,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,IAAI,CAAChB,sBAAsB,EAAE;MAC/B;MAEA,OAAO,IAAI,CAACD,eAAe;IAC7B;IACA;AACJ;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDpI,GAAG,EAAE,QAAQ;IACbzC,KAAK,EAAE,SAASwN,MAAM,CAACxN,KAAK,EAAEwG,OAAO,EAAE;MACrC,IAAIwH,MAAM,GAAG,IAAI;MAEjB,IAAI,IAAI,CAACC,MAAM,CAACjO,KAAK,EAAEwG,OAAO,CAAC,EAAE;QAC/B,IAAI,CAACwD,QAAQ,GAAG,KAAK;QACrB,OAAO,IAAI,CAACG,MAAM,CAAC+D,QAAQ,CAAC;UAC1BC,MAAM,EAAE;YACNC,IAAI,EAAE;UACR;QACF,CAAC,CAAC,CAACnD,IAAI,CAAC,UAAUkB,IAAI,EAAE;UACtB,IAAIkC,OAAO,GAAGL,MAAM,CAACK,OAAO,CAAClC,IAAI,CAAC;UAElC6B,MAAM,CAACP,cAAc,EAAE;UAEvB,OAAOY,OAAO;QAChB,CAAC,CAAC,CAACN,KAAK,CAAC,UAAUjC,GAAG,EAAE;UACtBwC,OAAO,CAACC,IAAI,CAACzC,GAAG,CAAC;UAEjBkC,MAAM,CAACpD,eAAe,CAACkB,GAAG,CAAC;QAC7B,CAAC,CAAC;MACJ;MAEA,OAAOpL,kBAAkB,CAACT,OAAO,CAACwK,OAAO,EAAE;IAC7C;EACF,CAAC,EAAE;IACDhI,GAAG,EAAE,KAAK;IACVkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAAC6F,IAAI;IAClB;IACA;AACJ;AACA;AACA;AACA;AACA,OALI;;IAOAmC,GAAG;IACH;AACJ;AACA;AACA;AACA;IACI,SAASA,GAAG,CAAC3L,KAAK,EAAE;MAClB,IAAI,CAACiO,MAAM,CAACjO,KAAK,CAAC;IACpB;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDyC,GAAG,EAAE,QAAQ;IACbzC,KAAK,EAAE,SAASiO,MAAM,CAACjO,KAAK,EAAEwG,OAAO,EAAE;MACrC,IAAI,CAACxG,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAIA,KAAK,KAAK,IAAI,CAACwJ,IAAI,EAAE;QAC9D,OAAO,KAAK;MACd;MAEA,IAAI,CAACA,IAAI,GAAGxJ,KAAK;MACjB,IAAI,CAACgK,QAAQ,GAAG,IAAI;MACpB,IAAI,CAACG,MAAM,GAAG,IAAI,CAAC3D,OAAO,CAAC2D,MAAM,GAAG,IAAI1J,OAAO,CAACwF,YAAY,CAACjG,KAAK,EAAEwG,OAAO,CAAC;MAE5E,IAAI,IAAI,CAAC+C,IAAI,KAAK,MAAM,EAAE;QACxB;QACA,IAAI,CAAC/C,OAAO,CAACgI,GAAG,GAAGxO,KAAK;MAC1B;MAEA,OAAO,IAAI;IACb;EACF,CAAC,EAAE;IACDyC,GAAG,EAAE,OAAO;IACZkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,IAAI8K,MAAM,GAAG,IAAI;MAEjB,OAAO,IAAI,CAACjE,SAAS,CAACS,IAAI,CAAC,YAAY;QACrC,OAAOxH,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,OAAO,EAAEoN,MAAM,CAAC,CAACxD,IAAI,CAAC,YAAY;UAChF,OAAOwD,MAAM,CAACd,iBAAiB,GAAGc,MAAM,CAAC5D,eAAe,GAAG,IAAI;QACjE,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDpI,GAAG,EAAE,SAAS;IACdkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAAC8F,QAAQ;IACtB;IACA;AACJ;AACA;AACA;AACA,OAJI;;IAMAkC,GAAG,EAAE,SAASA,GAAG,CAAC+C,OAAO,EAAE;MACzB,IAAI,IAAI,CAACjF,QAAQ,KAAKiF,OAAO,EAAE;QAC7B,IAAI,CAACjF,QAAQ,GAAGiF,OAAO;QAEvB,IAAI,CAAC,IAAI,CAACtE,MAAM,IAAIsE,OAAO,EAAE;UAC3B,IAAI,CAACtE,MAAM,GAAG,IAAI,CAACuE,EAAE,CAAC,KAAK,EAAE;YAC3BC,KAAK,EAAE;UACT,CAAC,CAAC;UACF,IAAIC,OAAO,GAAG,IAAI,CAACF,EAAE,CAAC,KAAK,EAAE;YAC3BC,KAAK,EAAE;UACT,CAAC,CAAC;UACF,IAAI,CAACxE,MAAM,CAAC0E,WAAW,CAACD,OAAO,CAAC;QAClC;QACA;;QAGA,IAAI,IAAI,CAACzE,MAAM,EAAE;UACf,IAAI;YACF,IAAIsE,OAAO,EAAE;cACX,IAAI,CAACK,SAAS,CAAC,IAAI,CAAC3E,MAAM,EAAE,IAAI,CAAC4E,OAAO,CAAC;YAC3C,CAAC,MAAM;cACL,IAAI,CAACC,eAAe,CAAC,IAAI,CAAC7E,MAAM,EAAE,IAAI,CAAC4E,OAAO,CAAC;YACjD;UACF,CAAC,CAAC,OAAOlD,GAAG,EAAE,CAAC;UAAA;QAEjB;QACA;MAEF;IACF;IACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDrJ,GAAG,EAAE,SAAS;IACdzC,KAAK,EAAE,SAASqO,OAAO,CAAClC,IAAI,EAAE+C,KAAK,EAAE;MACnC,IAAIC,qBAAqB;QACrBC,MAAM,GAAG,IAAI;MAEjB,IAAIC,gBAAgB,GAAG,IAAI,CAAC3F,KAAK,KAAK,CAACyF,qBAAqB,GAAG,IAAI,CAACzF,KAAK,CAAC0C,UAAU,MAAM,IAAI,IAAI+C,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAAC7M,MAAM,CAAC;MAE3K,IAAI;QACF,IAAIgN,YAAY,EAAEC,qBAAqB;;QAEvC;QACA,IAAIF,gBAAgB,IAAIG,IAAI,CAACC,SAAS,CAAC,IAAI,CAAC/F,KAAK,CAAC,KAAK8F,IAAI,CAACC,SAAS,CAACtD,IAAI,CAAC,EAAE;UAC3E,OAAOzL,kBAAkB,CAACT,OAAO,CAACwK,OAAO,EAAE;QAC7C,CAAC,CAAC;;QAGF,IAAI,CAACf,KAAK,GAAGwF,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAK,KAAK,CAAC,IAAIA,KAAK,CAACQ,eAAe,GAAGvD,IAAI,GAAGjM,OAAO,CAACD,OAAO,CAAC0P,SAAS,CAACxD,IAAI,CAAC;QAEjH,IAAI,IAAI,CAACyD,SAAS,EAAE;UAClB,IAAI,CAACA,SAAS,CAAC1P,OAAO,CAACD,OAAO,CAAC0P,SAAS,CAAC,IAAI,CAACjG,KAAK,CAAC,EAAEyC,IAAI,CAAC;QAC7D;QAEA,IAAI,CAACmD,YAAY,GAAG,IAAI,CAACO,MAAM,MAAM,IAAI,IAAIP,YAAY,KAAK,KAAK,CAAC,IAAI,CAACC,qBAAqB,GAAGD,YAAY,CAAC/D,SAAS,MAAM,IAAI,IAAIgE,qBAAqB,KAAK,KAAK,CAAC,IAAIA,qBAAqB,CAACO,SAAS,EAAE;UACxM,OAAOpP,kBAAkB,CAACT,OAAO,CAACwK,OAAO,EAAE;QAC7C;MACF,CAAC,CAAC,OAAOqB,GAAG,EAAE;QACZwC,OAAO,CAACC,IAAI,CAACzC,GAAG,CAAC,CAAC,CAAC;;QAEnB,OAAOpL,kBAAkB,CAACT,OAAO,CAACwK,OAAO,EAAE;MAC7C,CAAC,CAAC;;MAGF,IAAI0B,IAAI,IAAIA,IAAI,CAAC4D,QAAQ,IAAI5D,IAAI,CAAC4D,QAAQ,CAAC3D,UAAU,EAAE;QACrD,IAAI,CAAC5F,OAAO,CAAC4F,UAAU,GAAGD,IAAI,CAAC4D,QAAQ,CAAC3D,UAAU;MACpD;MAEA,IAAID,IAAI,IAAIA,IAAI,CAAC6D,UAAU,EAAE;QAC3B,IAAI,CAACxJ,OAAO,CAACwJ,UAAU,GAAG7D,IAAI,CAAC6D,UAAU;MAC3C;MAEA,IAAI,QAAQ,IAAI7D,IAAI,IAAI,CAAC,CAAC,EAAE9L,gBAAgB,CAACJ,OAAO,EAAEkM,IAAI,CAAC8D,MAAM,EAAE,KAAK,CAAC,GAAG,CAAC,EAAE;QAC7E,IAAI,CAACC,KAAK,CAACjF,IAAI,CAAC,YAAY;UAC1BmE,MAAM,CAACe,QAAQ,CAAC,oBAAoB,EAAE,oGAAoG,CAAC;QAC7I,CAAC,CAAC;MACJ,CAAC,CAAC;;MAGF,IAAIhE,IAAI,IAAIA,IAAI,CAACiE,MAAM,EAAE;QACvB,IAAIC,UAAU,GAAG,IAAI;QAErB,IAAI,OAAOlE,IAAI,CAACiE,MAAM,KAAK,QAAQ,EAAE;UACnC,IAAI;YACFC,UAAU,GAAG,IAAI,CAACC,QAAQ,CAAC,SAAS,CAACC,MAAM,CAACpE,IAAI,CAACiE,MAAM,CAAC,CAAC;UAC3D,CAAC,CAAC,OAAOtE,GAAG,EAAE;YACZwC,OAAO,CAACC,IAAI,CAACzC,GAAG,CAAC;UACnB;QACF,CAAC,MAAM;UACLuE,UAAU,GAAGlE,IAAI,CAACiE,MAAM;QAC1B;QAEA,IAAIC,UAAU,EAAE;UACd5P,OAAO,CAACwF,YAAY,CAACuK,GAAG,CAACH,UAAU,CAAC,CAAC,CAAC;;UAGtC,IAAIA,UAAU,CAAC7J,OAAO,IAAI6J,UAAU,CAAC7J,OAAO,CAAC2F,IAAI,EAAE;YACjD,IAAI,CAAC3F,OAAO,GAAG3G,MAAM,CAACqJ,MAAM,CAAC,IAAI,CAAC1C,OAAO,EAAE6J,UAAU,CAAC7J,OAAO,CAAC2F,IAAI,CAAC;UACrE;QACF;MACF;MAEA,IAAI,CAACS,WAAW,GAAG,KAAK;MAExB,IAAI6D,OAAO,GAAG,IAAI,CAACA,OAAO,EAAE,IAAI/P,kBAAkB,CAACT,OAAO,CAACwK,OAAO,EAAE;MAEpE,OAAOgG,OAAO,CAACxF,IAAI,CAAC,YAAY;QAC9BmE,MAAM,CAACpD,IAAI,CAAC,UAAU,EAAEG,IAAI,CAAC;QAE7BiD,MAAM,CAACsB,gBAAgB,EAAE,CAAC,CAAC;;QAG3BC,UAAU,CAAC,YAAY;UACrBvB,MAAM,CAACwB,QAAQ,CAAC1B,KAAK,CAAC;UAEtBE,MAAM,CAACzE,gBAAgB,EAAE;QAC3B,CAAC,EAAE,CAAC,CAAC;QACL,OAAOyE,MAAM,CAAC5E,SAAS;MACzB,CAAC,CAAC;IACJ;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACD/H,GAAG,EAAE,MAAM;IACXkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,IAAI,CAAC,IAAI,CAAC+F,KAAK,EAAE;QACf,IAAI,CAACA,KAAK,GAAG;UACX0C,UAAU,EAAE;QACd,CAAC;MACH;MAEA,OAAO,IAAI,CAAC1C,KAAK;IACnB;IACA;AACJ;AACA;AACA;AACA;AACA,OALI;;IAOAiC,GAAG,EAAE,SAASA,GAAG,CAACQ,IAAI,EAAE;MACtB,IAAI,CAACkC,OAAO,CAAClC,IAAI,CAAC;IACpB;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACD1J,GAAG,EAAE,YAAY;IACjBkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAACkN,QAAQ,EAAE;IACxB;IACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAdI;;IAgBAlF,GAAG,EAAE,SAASA,GAAG,CAACkC,UAAU,EAAE;MAC5B,IAAI,CAACC,aAAa,CAACD,UAAU,CAAC;IAChC;IACA;AACJ;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDpL,GAAG,EAAE,eAAe;IACpBzC,KAAK,EAAE,SAAS8N,aAAa,CAACD,UAAU,EAAE;MACxC,IAAIiD,MAAM,GAAG,IAAI;MAEjB,IAAI5B,KAAK,GAAG7M,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKmK,SAAS,GAAGnK,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MAClF6M,KAAK,GAAGhN,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEgN,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE;QAClD6B,cAAc,EAAE7Q,OAAO,CAACD,OAAO,CAAC+Q,GAAG,CAAC9B,KAAK,EAAE,gBAAgB,CAAC,GAAGA,KAAK,CAAC6B,cAAc,GAAG;MACxF,CAAC,CAAC;MACF,OAAO,IAAI,CAACzG,YAAY,GAAG,IAAI,CAACE,SAAS,CAACS,IAAI,CAAC,UAAUgG,YAAY,EAAE;QACrE,IAAIA,YAAY,EAAE;UAChB/B,KAAK,GAAGhN,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAEgN,KAAK,CAAC,EAAE+B,YAAY,CAAC;QAC/D;QAEAH,MAAM,CAACvG,aAAa,GAAG,IAAI;QAE3BuG,MAAM,CAACI,aAAa,CAAChC,KAAK,CAAC;QAE3B4B,MAAM,CAACK,QAAQ,CAACtD,UAAU,EAAEqB,KAAK,CAAC;QAElC,OAAO4B,MAAM,CAAChG,sBAAsB,CAAC+C,UAAU,CAAC;MAClD,CAAC,EAAE,UAAU/B,GAAG,EAAE;QAChB,OAAOgF,MAAM,CAAC/F,qBAAqB,CAACe,GAAG,CAAC;MAC1C,CAAC,CAAC,CAACiC,KAAK,CAAC,UAAUjC,GAAG,EAAE;QACtB,OAAOgF,MAAM,CAAC/F,qBAAqB,CAACe,GAAG,CAAC;MAC1C,CAAC,CAAC;IACJ;IACA;AACJ;AACA;EAEE,CAAC,EAAE;IACDrJ,GAAG,EAAE,WAAW;IAChBzC,KAAK,EAAE,SAAS6G,SAAS,GAAG;MAC1B,IAAIuK,OAAO,GAAG,IAAI;MAElB,IAAI,CAAC,IAAI,CAACzH,YAAY,EAAE;QACtB;MACF;MAEA,IAAI,CAAC,IAAI,CAACQ,MAAM,EAAE;QAChBmE,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC8C,CAAC,CAAC,wBAAwB,CAAC,CAAC;QAC9C;MACF;MAEA,IAAI,CAAC5Q,OAAO,CAACwF,YAAY,CAACmF,OAAO,EAAE,EAAE;QACnCkD,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC8C,CAAC,CAAC,oBAAoB,CAAC,CAAC;QAC1C;MACF;MAEA,IAAIC,KAAK,GAAG,CAAC,CAAC,EAAEzQ,MAAM,CAACsI,aAAa,EAAE,IAAI,CAAC0E,UAAU,CAAC;MACtDyD,KAAK,CAACC,KAAK,GAAG,OAAO;MAErB,IAAI,CAAC,IAAI,CAAC3H,WAAW,EAAE;QACrB,IAAI,CAACoC,IAAI,CAAC,gBAAgB,CAAC;QAC3B,IAAI,CAACpC,WAAW,GAAG,IAAI;QACvB,IAAI,CAACO,MAAM,CAACqH,cAAc,CAACF,KAAK,CAAC,CAACrG,IAAI,CAAC,UAAUwG,GAAG,EAAE;UACpD;UACAL,OAAO,CAACvD,UAAU,CAACvC,GAAG,GAAGmG,GAAG,CAACnG,GAAG;UAChC8F,OAAO,CAACxH,WAAW,GAAG,KAAK;UAE3BwH,OAAO,CAACpF,IAAI,CAAC,WAAW,EAAEyF,GAAG,CAAC;QAChC,CAAC,CAAC;MACJ;IACF;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDhP,GAAG,EAAE,cAAc;IACnBzC,KAAK,EAAE,SAASqL,YAAY,CAACqG,MAAM,EAAE;MACnC,IAAIC,OAAO,GAAG,IAAI;MAElB,IAAI,CAAC,IAAI,CAACxH,MAAM,EAAE;QAChBmE,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC8C,CAAC,CAAC,2BAA2B,CAAC,CAAC;QACjD;MACF;MAEA,IAAI,CAACzH,WAAW,GAAG,IAAI;MACvB,IAAI,CAACO,MAAM,CAACyH,eAAe,CAAC;QAC1BzD,MAAM,EAAE;UACNoD,KAAK,EAAE,OAAO;UACdM,KAAK,EAAEH;QACT;MACF,CAAC,CAAC,CAACzG,IAAI,CAAC,UAAU6G,WAAW,EAAE;QAC7B,IAAIA,WAAW,CAACxP,MAAM,GAAG,CAAC,IAAI,CAACqP,OAAO,CAACnL,OAAO,CAAC0E,gBAAgB,EAAE;UAC/D,IAAIoG,KAAK,GAAG,CAAC,CAAC,EAAEzQ,MAAM,CAACsI,aAAa,EAAE2I,WAAW,CAAC,CAAC,CAAC,CAAC;UACrD,OAAOH,OAAO,CAAC7D,aAAa,CAACwD,KAAK,CAAC,CAACrG,IAAI,CAAC,YAAY;YACnD0G,OAAO,CAAChI,YAAY,GAAG,IAAI;YAC3BgI,OAAO,CAAC/H,WAAW,GAAG,KAAK;YAE3B+H,OAAO,CAAC3F,IAAI,CAAC,cAAc,EAAEsF,KAAK,CAAC;UACrC,CAAC,CAAC;QACJ,CAAC,CAAC;;QAGFK,OAAO,CAAChI,YAAY,GAAG,IAAI;QAC3BgI,OAAO,CAAC/H,WAAW,GAAG,KAAK;QAE3B+H,OAAO,CAAC3F,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC;MACpC,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACDvJ,GAAG,EAAE,QAAQ;IACbkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,IAAIsM,MAAM,GAAG,CAAC,CAAC,EAAEpP,MAAM,CAACsI,aAAa,EAAEjJ,OAAO,CAACD,OAAO,CAAC8R,IAAI,CAAC,IAAI,CAACrI,KAAK,EAAE,CAAC,YAAY,CAAC,CAAC,CAAC;MACxFuG,MAAM,CAAC7D,UAAU,GAAG,EAAE;MACtB,IAAI,CAAC4F,aAAa,CAAC,UAAUzG,SAAS,EAAE;QACtC,OAAO0E,MAAM,CAAC7D,UAAU,CAACpK,IAAI,CAACuJ,SAAS,CAAC0E,MAAM,CAAC;MACjD,CAAC,CAAC;MACF,OAAOA,MAAM;IACf;EACF,CAAC,EAAE;IACDxN,GAAG,EAAE,WAAW;IAChBzC,KAAK,EAAE,SAASiS,SAAS,CAACC,KAAK,EAAEC,KAAK,EAAE;MACtCjS,OAAO,CAACD,OAAO,CAACmS,SAAS,CAACF,KAAK,EAAEC,KAAK,EAAE,UAAUE,SAAS,EAAEC,SAAS,EAAE;QACtE,IAAIC,KAAK,CAACC,OAAO,CAACH,SAAS,CAAC,IAAIE,KAAK,CAACC,OAAO,CAACF,SAAS,CAAC,IAAID,SAAS,CAAC/P,MAAM,KAAKgQ,SAAS,CAAChQ,MAAM,EAAE;UACjG,OAAOgQ,SAAS;QAClB;MACF,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACD7P,GAAG,EAAE,UAAU;IACfzC,KAAK,EAAE,SAASmR,QAAQ,CAACtD,UAAU,EAAE;MACnC,IAAIqB,KAAK,GAAG7M,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKmK,SAAS,GAAGnK,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MAElF,IAAI,CAACwL,UAAU,IAAI,CAACA,UAAU,CAAC4E,IAAI,EAAE;QACnC5E,UAAU,GAAG;UACX4E,IAAI,EAAE,CAAC;QACT,CAAC;MACH,CAAC,CAAC;;MAGF,IAAI,CAACC,WAAW,CAACC,QAAQ,GAAG9E,UAAU,CAAC8E,QAAQ,IAAI,CAAC,CAAC;MACrD,IAAI,CAACC,OAAO,GAAG,CAAC,CAAC/E,UAAU,CAACvC,GAAG,CAAC,CAAC;;MAEjC,IAAI,CAAC,IAAI,CAAC9E,OAAO,CAACqM,kBAAkB,IAAIhF,UAAU,CAAC8E,QAAQ,IAAI9E,UAAU,CAAC8E,QAAQ,CAACG,QAAQ,EAAE;QAC3F,IAAI,CAACtM,OAAO,CAACqM,kBAAkB,GAAGhF,UAAU,CAAC8E,QAAQ,CAACG,QAAQ;MAChE;MAEA,IAAIC,OAAO,GAAGtP,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC6C,IAAI,CAAC,IAAI,EAAE2J,UAAU,CAAC4E,IAAI,EAAEvD,KAAK,CAAC;MAE3G,IAAI,CAACA,KAAK,CAAC8D,QAAQ,EAAE;QACnB,IAAI,CAACf,SAAS,CAAC,IAAI,CAACQ,IAAI,EAAE5E,UAAU,CAAC4E,IAAI,CAAC;MAC5C;MAEA5E,UAAU,CAAC4E,IAAI,GAAG,IAAI,CAACA,IAAI;MAC3B,IAAI,CAACC,WAAW,GAAG7E,UAAU;MAC7B,OAAOkF,OAAO;IAChB;EACF,CAAC,EAAE;IACDtQ,GAAG,EAAE,UAAU;IACfzC,KAAK,EAAE,SAAS6Q,QAAQ,GAAG;MACzB,IAAI,CAAC,IAAI,CAAC6B,WAAW,CAACD,IAAI,EAAE;QAC1B,IAAI,CAACC,WAAW,CAACD,IAAI,GAAG,CAAC,CAAC;MAC5B;MAEA,IAAI,IAAI,CAACQ,QAAQ,EAAE;QACjB,OAAO,IAAI,CAACP,WAAW;MACzB;MAEA,IAAI7E,UAAU,GAAG,IAAI,CAAC6E,WAAW;MACjC7E,UAAU,CAAC4E,IAAI,GAAG,IAAI,CAACA,IAAI;MAC3B,OAAO,IAAI,CAACC,WAAW;IACzB;IACA;AACJ;AACA;EAEE,CAAC,EAAE;IACDjQ,GAAG,EAAE,MAAM;IACXzC,KAAK,EAAE,SAAS6M,IAAI,GAAG;MACrB,IAAIqG,OAAO,GAAG,IAAI;MAElB,IAAI,CAACR,WAAW,GAAG,IAAI,CAACA,WAAW,IAAI;QACrCD,IAAI,EAAE,CAAC;MACT,CAAC,CAAC,CAAC;;MAEH,IAAI,IAAI,CAACrG,UAAU,IAAI,IAAI,CAACA,UAAU,CAAC9J,MAAM,EAAE;QAC7C,IAAI,CAAC6Q,iBAAiB,EAAE;QACxB,IAAI,CAAC/G,UAAU,GAAG,EAAE;MACtB;MAEA,IAAI,IAAI,CAACb,SAAS,EAAE;QAClB,IAAI,CAACA,SAAS,CAACa,UAAU,GAAG,IAAI,CAACD,IAAI,GAAG,IAAI,CAACA,IAAI,CAACC,UAAU,GAAG,EAAE;MACnE,CAAC,MAAM;QACL,IAAI,CAACb,SAAS,GAAG,IAAI,CAACY,IAAI;MAC5B;MAEA,IAAI,CAACZ,SAAS,CAAChC,IAAI,GAAG,MAAM;MAC5B,IAAI,CAACgC,SAAS,CAAC6H,KAAK,GAAG,KAAK;MAC5B,IAAI,CAACC,aAAa,EAAE;MACpB,IAAI,CAACC,EAAE,CAAC,cAAc,EAAE,UAAU9M,OAAO,EAAE;QACzC0M,OAAO,CAACK,MAAM,CAAC,KAAK,EAAE/M,OAAO,CAAC,CAACuH,KAAK,CAAC,UAAUhI,CAAC,EAAE;UAChD,OAAOA,CAAC,KAAK,KAAK,IAAIuI,OAAO,CAACkF,GAAG,CAACzN,CAAC,CAAC;QACtC,CAAC,CAAC;MACJ,CAAC,EAAE,IAAI,CAAC;MACR,IAAI,CAACuN,EAAE,CAAC,eAAe,EAAE,UAAUb,IAAI,EAAE;QACvC,OAAOS,OAAO,CAACO,aAAa,CAAChB,IAAI,EAAE,IAAI,EAAEA,IAAI,CAAC;MAChD,CAAC,EAAE,IAAI,CAAC;MACR,IAAI,CAACa,EAAE,CAAC,YAAY,EAAE,UAAUI,IAAI,EAAE;QACpC,OAAOR,OAAO,CAACS,SAAS,CAACD,IAAI,CAACE,GAAG,EAAEF,IAAI,CAACG,OAAO,CAAC;MAClD,CAAC,EAAE,IAAI,CAAC;MACR,IAAI,CAACP,EAAE,CAAC,WAAW,EAAE,YAAY;QAC/B,OAAOJ,OAAO,CAACY,UAAU,EAAE;MAC7B,CAAC,EAAE,IAAI,CAAC;MACR,IAAI,CAACR,EAAE,CAAC,kBAAkB,EAAE,YAAY;QACtC,OAAOJ,OAAO,CAACa,gBAAgB,EAAE;MACnC,CAAC,EAAE,IAAI,CAAC;MACR,IAAI,CAACT,EAAE,CAAC,aAAa,EAAE,YAAY;QACjC,OAAOJ,OAAO,CAACc,WAAW,EAAE;MAC9B,CAAC,EAAE,IAAI,CAAC;MACR,IAAI,CAACC,qBAAqB,EAAE;MAC5B,OAAO,IAAI,CAACzJ,SAAS;IACvB;EACF,CAAC,EAAE;IACD/H,GAAG,EAAE,uBAAuB;IAC5BzC,KAAK,EAAE,SAASiU,qBAAqB,GAAG;MACtC,IAAIC,OAAO,GAAG,IAAI;;MAElB;MACA;MACA,IAAI,CAAC,IAAI,CAAC/H,IAAI,IAAI,CAAC,IAAI,CAACA,IAAI,CAACgI,UAAU,IAAI,CAAC,CAAC,IAAI,CAACC,OAAO,IAAI,IAAI,CAAC7I,SAAS,CAAC8I,MAAM,KAAK,IAAI,CAAC9I,SAAS,CAACC,WAAW,IAAI,CAAC,IAAI,CAAC8I,YAAY,EAAE;QACvI,OAAO,KAAK;MACd;MAEA,IAAI,CAAC9J,SAAS,CAACS,IAAI,CAAC,YAAY;QAC9BiJ,OAAO,CAAC5D,QAAQ,CAAC4D,OAAO,CAAC/H,IAAI,CAACgI,UAAU,EAAE;UACxC/H,UAAU,EAAE8H,OAAO,CAAC9H,UAAU;UAC9BtJ,QAAQ,EAAEoR;QACZ,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACDzR,GAAG,EAAE,SAAS;IACdzC,KAAK,EAAE,SAASuU,OAAO,GAAG;MACxB,IAAIC,gBAAgB,GAAGnS,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKmK,SAAS,GAAGnK,SAAS,CAAC,CAAC,CAAC,GAAG,KAAK;MAChG,IAAI,CAACoS,GAAG,CAAC,cAAc,CAAC;MACxB,IAAI,CAACA,GAAG,CAAC,eAAe,CAAC;MACzB,IAAI,CAACA,GAAG,CAAC,YAAY,CAAC;MACtB,IAAI,CAACA,GAAG,CAAC,WAAW,CAAC;MACrB,IAAI,CAACA,GAAG,CAAC,kBAAkB,CAAC;MAC5B,IAAI,CAACA,GAAG,CAAC,aAAa,CAAC;MAEvB,IAAID,gBAAgB,EAAE;QACpB,IAAI,CAACxI,IAAI,CAAC,YAAY,EAAE,IAAI,CAACvD,EAAE,CAAC;QAChC,OAAOhI,OAAO,CAACwF,YAAY,CAACC,KAAK,CAAC,IAAI,CAACuC,EAAE,CAAC;MAC5C;MAEA,OAAOhF,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC6C,IAAI,CAAC,IAAI,CAAC;IAC7E;EACF,CAAC,EAAE;IACDzB,GAAG,EAAE,OAAO;IACZzC,KAAK,EAAE,SAAS0U,KAAK,CAACjN,OAAO,EAAE;MAC7B,IAAIkN,OAAO,GAAG,IAAI;MAElB,IAAIlN,OAAO,IAAI,IAAI,CAACA,OAAO,EAAE;QAC3B,OAAO,IAAI,CAACyI,KAAK,CAACjF,IAAI,CAAC,YAAY;UACjCxD,OAAO,GAAGA,OAAO,IAAIkN,OAAO,CAAClN,OAAO;UAEpChE,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,OAAO,EAAEsT,OAAO,CAAC,CAACzQ,IAAI,CAACyQ,OAAO,EAAElN,OAAO,CAAC;QACnF,CAAC,CAAC;MACJ;MAEA,OAAO,IAAI,CAACyI,KAAK;IACnB;EACF,CAAC,EAAE;IACDzN,GAAG,EAAE,cAAc;IACnBzC,KAAK,EAAE,SAAS4U,YAAY,GAAG;MAC7B,IAAIC,OAAO,GAAG,aAAa;MAE3B,IAAI,IAAI,CAACrO,OAAO,CAACsO,QAAQ,EAAE;QACzBD,OAAO,IAAI,mBAAmB;MAChC;MAEA,OAAOA,OAAO;IAChB;EACF,CAAC,EAAE;IACDpS,GAAG,EAAE,QAAQ;IACbzC,KAAK,EAAE,SAAS+U,MAAM,GAAG;MACvB,OAAOtR,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC6C,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC8Q,cAAc,CAAC,SAAS,EAAE;QACxGH,OAAO,EAAE,IAAI,CAACD,YAAY,EAAE;QAC5BK,QAAQ,EAAE,IAAI,CAACC,gBAAgB;MACjC,CAAC,CAAC,EAAE,IAAI,CAACC,WAAW,GAAG,SAAS,GAAG,MAAM,EAAE,IAAI,CAAC;IAClD;EACF,CAAC,EAAE;IACD1S,GAAG,EAAE,QAAQ;IACbzC,KAAK,EAAE,SAAS+L,MAAM,GAAG;MACvB;MACA,IAAI,CAAC,IAAI,CAACtE,OAAO,EAAE;QACjB,OAAO/G,kBAAkB,CAACT,OAAO,CAACwK,OAAO,EAAE;MAC7C;MAEA,IAAI,CAAC2K,KAAK,EAAE;MACZ,IAAI,CAACC,UAAU,CAAC,IAAI,CAAC5N,OAAO,EAAE,IAAI,CAACsN,MAAM,EAAE,CAAC;MAC5C,OAAO,IAAI,CAACO,MAAM,CAAC,IAAI,CAAC7N,OAAO,CAAC;IAClC;EACF,CAAC,EAAE;IACDhF,GAAG,EAAE,QAAQ;IACbzC,KAAK,EAAE,SAASsV,MAAM,CAAC7N,OAAO,EAAE;MAC9B,IAAI8N,OAAO,GAAG,IAAI;MAElB,IAAI,CAAC9N,OAAO,GAAGA,OAAO;MACtB,IAAI,CAAC+N,QAAQ,CAAC/N,OAAO,EAAE;QACrBgO,OAAO,EAAE;MACX,CAAC,CAAC;MACF,IAAIC,YAAY,GAAG,IAAI,CAACC,gBAAgB,CAAC,IAAI,CAACC,IAAI,CAACH,OAAO,CAAC;MAC3D,IAAI,CAACI,gBAAgB,CAACC,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACC,gBAAgB,CAAC;MACjE,IAAI,CAACC,WAAW,GAAG,IAAI;MACvB,IAAI,CAACC,IAAI,CAAC,eAAe,EAAExO,OAAO,EAAE,IAAI,CAAC;MACzC,OAAOiO,YAAY,CAACzK,IAAI,CAAC,YAAY;QACnCsK,OAAO,CAACvJ,IAAI,CAAC,QAAQ,EAAEuJ,OAAO,CAAC9N,OAAO,CAAC;QAEvC,OAAO8N,OAAO,CAACpE,QAAQ,CAACoE,OAAO,CAAC7C,WAAW,EAAE;UAC3CwD,aAAa,EAAE;QACjB,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACDzT,GAAG,EAAE,mBAAmB;IACxBzC,KAAK,EAAE,SAASmW,iBAAiB,GAAG;MAClC,IAAI/Q,MAAM,GAAG,KAAK;MAClB,CAAC,CAAC,EAAEtE,UAAU,CAACkR,aAAa,EAAE,IAAI,CAAC7F,IAAI,CAACC,UAAU,EAAE,UAAUb,SAAS,EAAE;QACvE,IAAIA,SAAS,CAAC6K,QAAQ,CAACC,QAAQ,EAAE;UAC/BjR,MAAM,GAAG,IAAI;UACb,OAAO,IAAI;QACb;MACF,CAAC,EAAE,IAAI,CAAC;MACR,OAAOA,MAAM;IACf;EACF,CAAC,EAAE;IACD3C,GAAG,EAAE,YAAY;IACjBzC,KAAK,EAAE,SAAS8T,UAAU,GAAG;MAC3B5T,OAAO,CAACD,OAAO,CAACmI,IAAI,CAAC,IAAI,CAACkO,aAAa,EAAE,EAAE,UAAUC,IAAI,EAAE;QACzD,OAAOA,IAAI,CAACzC,UAAU,EAAE;MAC1B,CAAC,CAAC;MAEF,IAAI,CAAC0C,WAAW,CAAC,IAAI,CAAC;MACtB,IAAI,CAAC5F,QAAQ,EAAE;IACjB;IACA;AACJ;AACA;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDnO,GAAG,EAAE,UAAU;IACfzC,KAAK,EAAE,SAASmQ,QAAQ,CAAC5G,IAAI,EAAEkN,OAAO,EAAEjQ,OAAO,EAAE;MAC/C,IAAIkQ,OAAO,GAAG,IAAI;MAElB,IAAI,CAACnN,IAAI,IAAI,IAAI,CAACU,SAAS,EAAE;QAC3B,IAAI,IAAI,CAACI,KAAK,EAAE;UACd,IAAI,IAAI,CAACuL,IAAI,CAACe,QAAQ,IAAI,IAAI,CAACf,IAAI,CAACe,QAAQ,CAACrU,MAAM,EAAE;YACnD,IAAI,CAACsT,IAAI,CAACe,QAAQ,CAACnU,OAAO,CAAC,UAAUoU,EAAE,EAAE;cACvCF,OAAO,CAACG,mBAAmB,CAACD,EAAE,EAAE,OAAO,CAAC;cAExCF,OAAO,CAACG,mBAAmB,CAACD,EAAE,EAAE,UAAU,CAAC;YAC7C,CAAC,CAAC;UACJ;UAEA,IAAI,CAACE,WAAW,CAAC,IAAI,CAACzM,KAAK,CAAC;UAC5B,IAAI,CAACA,KAAK,GAAG,IAAI;QACnB;QAEA;MACF;MAEA,IAAI,IAAI,CAAC7D,OAAO,CAACuQ,QAAQ,EAAE;QACzB,IAAI,CAACN,OAAO,EAAE;UACZ,IAAI,CAACzK,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC;QAC3B;QAEA;MACF;MAEA,IAAI,IAAI,CAAC3B,KAAK,EAAE;QACd,IAAI;UACF,IAAI,IAAI,CAACuL,IAAI,CAACe,QAAQ,IAAI,IAAI,CAACf,IAAI,CAACe,QAAQ,CAACrU,MAAM,EAAE;YACnD,IAAI,CAACsT,IAAI,CAACe,QAAQ,CAACnU,OAAO,CAAC,UAAUoU,EAAE,EAAE;cACvCF,OAAO,CAACG,mBAAmB,CAACD,EAAE,EAAE,OAAO,CAAC;cAExCF,OAAO,CAACG,mBAAmB,CAACD,EAAE,EAAE,UAAU,CAAC;YAC7C,CAAC,CAAC;UACJ;UAEA,IAAI,CAACE,WAAW,CAAC,IAAI,CAACzM,KAAK,CAAC;UAC5B,IAAI,CAACA,KAAK,GAAG,IAAI;QACnB,CAAC,CAAC,OAAOyB,GAAG,EAAE,CAAC;QAAA;MAEjB;MAEA,IAAI2K,OAAO,EAAE;QACX,IAAIO,KAAK,GAAG;UACVpI,KAAK,EAAEpI,OAAO,IAAIA,OAAO,CAACqO,OAAO,IAAI,cAAc,CAACtE,MAAM,CAAChH,IAAI,CAAC;UAChEd,EAAE,EAAE,aAAa,CAAC8H,MAAM,CAAC,IAAI,CAAC9H,EAAE;QAClC,CAAC;QACD,IAAIwO,eAAe,GAAG;UACpBR,OAAO,EAAEA,OAAO,YAAY/O,WAAW,GAAG+O,OAAO,CAACS,SAAS,GAAGT,OAAO;UACrEO,KAAK,EAAEA,KAAK;UACZzN,IAAI,EAAEA;QACR,CAAC;QACD,IAAI,CAACc,KAAK,GAAG,CAAC,CAAC,EAAExJ,MAAM,CAACsW,0BAA0B,EAAE,IAAI,CAACnC,cAAc,CAAC,OAAO,EAAEiC,eAAe,CAAC,EAAE,GAAG,CAAC1G,MAAM,CAACyG,KAAK,CAACvO,EAAE,CAAC,CAAC;MAC1H;MAEA,IAAI,CAAC,IAAI,CAAC4B,KAAK,EAAE;QACf;MACF;MAEA,IAAI,CAACmL,QAAQ,CAAC,IAAI,CAACnL,KAAK,EAAE;QACxBsM,QAAQ,EAAE;MACZ,CAAC,CAAC;MAEF,IAAI,IAAI,CAACf,IAAI,CAACe,QAAQ,IAAI,IAAI,CAACf,IAAI,CAACe,QAAQ,CAACrU,MAAM,EAAE;QACnD,IAAI,CAACsT,IAAI,CAACe,QAAQ,CAACnU,OAAO,CAAC,UAAUoU,EAAE,EAAE;UACvCF,OAAO,CAACb,gBAAgB,CAACe,EAAE,EAAE,OAAO,EAAE,UAAU7Q,CAAC,EAAE;YACjD,IAAItD,GAAG,GAAGsD,CAAC,CAACqR,aAAa,CAACC,OAAO,CAACC,YAAY;YAE9CZ,OAAO,CAACa,gBAAgB,CAAC9U,GAAG,CAAC;UAC/B,CAAC,CAAC;UAEFiU,OAAO,CAACb,gBAAgB,CAACe,EAAE,EAAE,SAAS,EAAE,UAAU7Q,CAAC,EAAE;YACnD,IAAIA,CAAC,CAACiC,OAAO,KAAK,EAAE,EAAE;cACpBjC,CAAC,CAACyC,cAAc,EAAE;cAClB,IAAI/F,GAAG,GAAGsD,CAAC,CAACqR,aAAa,CAACC,OAAO,CAACC,YAAY;cAE9CZ,OAAO,CAACa,gBAAgB,CAAC9U,GAAG,CAAC;YAC/B;UACF,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ;MAEA,IAAI,CAAC+U,OAAO,CAAC,IAAI,CAACnN,KAAK,CAAC;IAC1B;IACA;AACJ;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACD5H,GAAG,EAAE,kBAAkB;IACvBzC,KAAK,EAAE,SAASuX,gBAAgB,CAAC9U,GAAG,EAAE;MACpC,IAAIA,GAAG,EAAE;QACP,IAAI8I,SAAS,GAAG,IAAI,CAACkM,YAAY,CAAChV,GAAG,CAAC;QAEtC,IAAI8I,SAAS,EAAE;UACbA,SAAS,CAACmM,KAAK,EAAE;QACnB;MACF;IACF;IACA;AACJ;AACA;AACA;AACA;AACA;;IAEI;EAEF,CAAC,EAAE;IACDjV,GAAG,EAAE,YAAY;IACjBzC,KAAK,EAAE,SAAS2X,UAAU,CAACC,KAAK,EAAEC,YAAY,EAAEjH,QAAQ,EAAE;MACxD,IAAIkH,OAAO,GAAG,IAAI;MAElB,IAAI,CAACpJ,OAAO,GAAG,KAAK;MACpB,IAAIqJ,MAAM,GAAG,IAAI,CAACA,MAAM;MAExB,IAAIH,KAAK,EAAE;QACT,IAAIrF,KAAK,CAACC,OAAO,CAACoF,KAAK,CAAC,EAAE;UACxBG,MAAM,GAAGA,MAAM,CAACxH,MAAM,CAACqH,KAAK,CAAC;QAC/B,CAAC,MAAM;UACLG,MAAM,CAAC/V,IAAI,CAAC4V,KAAK,CAAC;QACpB;MACF,CAAC,MAAM;QACLG,MAAM,GAAGtU,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC;MACnE;MAEA0W,MAAM,GAAGA,MAAM,CAACxH,MAAM,CAAC,IAAI,CAACxG,YAAY,CAAC;MAEzC,IAAI,CAACgO,MAAM,CAACzV,MAAM,EAAE;QAClB,IAAI,CAAC6N,QAAQ,CAAC,KAAK,CAAC;QACpB;MACF,CAAC,CAAC;;MAGF4H,MAAM,CAACvV,OAAO,CAAC,UAAUsJ,GAAG,EAAE;QAC5B,IAAIkM,eAAe,GAAGlM,GAAG,CAACM,UAAU;UAChCA,UAAU,GAAG4L,eAAe,KAAK,KAAK,CAAC,GAAG,EAAE,GAAGA,eAAe;QAElE,IAAIlM,GAAG,CAACP,SAAS,EAAE;UACjBa,UAAU,CAACpK,IAAI,CAAC8J,GAAG,CAACP,SAAS,CAAC;QAChC;QAEA,IAAIO,GAAG,CAACmM,IAAI,EAAE;UACZ7L,UAAU,CAACpK,IAAI,CAAC8J,GAAG,CAACmM,IAAI,CAAC;QAC3B;QAEA7L,UAAU,CAAC5J,OAAO,CAAC,UAAUyV,IAAI,EAAE;UACjC,IAAIC,YAAY,GAAGJ,OAAO,CAACK,WAAW,GAAG,CAAC,CAAC,EAAEtX,MAAM,CAACuX,0BAA0B,EAAEH,IAAI,CAAC;UAErF,IAAI1M,SAAS,GAAGuM,OAAO,CAACL,YAAY,CAACQ,IAAI,EAAE/X,OAAO,CAACD,OAAO,CAACoY,QAAQ,EAAEH,YAAY,CAAC;UAElF,IAAIpM,GAAG,CAACwM,UAAU,EAAE;YAClB,IAAI/M,SAAS,CAACgN,YAAY,EAAE;cAC1BhN,SAAS,CAACgN,YAAY,CAACvW,IAAI,CAAC8J,GAAG,CAAC;YAClC,CAAC,MAAM;cACLP,SAAS,CAACgN,YAAY,GAAG,CAACzM,GAAG,CAAC;YAChC;UACF;UAEA,IAAIM,UAAU,GAAGlM,OAAO,CAACD,OAAO,CAACuY,OAAO,CAACjG,KAAK,CAACC,OAAO,CAACjH,SAAS,CAAC,GAAGA,SAAS,GAAG,CAACA,SAAS,CAAC,CAAC;UAE5Fa,UAAU,CAAC5J,OAAO,CAAC,UAAU+I,SAAS,EAAE;YACtC,OAAOA,SAAS,CAACkN,iBAAiB,CAAC3M,GAAG,CAAC2K,OAAO,EAAE,IAAI,CAAC;UACvD,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ,CAAC,CAAC;MACF,IAAIiC,eAAe,GAAG,EAAE;MACxBX,MAAM,CAACvV,OAAO,CAAC,UAAUsJ,GAAG,EAAE;QAC5B,IAAIA,GAAG,EAAE;UACP,IAAI6M,cAAc,GAAG,SAASA,cAAc,CAAClC,OAAO,EAAEmC,KAAK,EAAE;YAC3D,IAAIC,gBAAgB,GAAG,CAAC3Y,OAAO,CAACD,OAAO,CAAC6Y,WAAW,CAACF,KAAK,CAAC,IAAI9M,GAAG,CAACiN,QAAQ,IAAIjN,GAAG,CAACiN,QAAQ,CAACH,KAAK,CAAC;YACjG,IAAII,SAAS,GAAGH,gBAAgB,IAAIA,gBAAgB,CAACI,kBAAkB,IAAIJ,gBAAgB,CAACZ,IAAI,IAAInM,GAAG,CAACP,SAAS,IAAIO,GAAG,CAACP,SAAS,CAAC9I,GAAG,IAAIqJ,GAAG,CAACwM,UAAU,IAAIxM,GAAG,CAACmM,IAAI;YACpK,IAAIgB,kBAAkB,GAAGD,SAAS,GAAG,CAAC,CAAC,EAAEnY,MAAM,CAACuX,0BAA0B,EAAEY,SAAS,CAAC,GAAG,EAAE;YAC3FC,kBAAkB,GAAGnB,OAAO,CAACK,WAAW,GAAGc,kBAAkB;YAE7D,IAAI,OAAOnN,GAAG,KAAK,QAAQ,IAAI,CAACA,GAAG,CAACmN,kBAAkB,EAAE;cACtDnN,GAAG,CAACmN,kBAAkB,GAAGA,kBAAkB;YAC7C;YAEA,OAAO;cACLxC,OAAO,EAAE,CAAC,CAAC,EAAE5V,MAAM,CAACqY,YAAY,EAAEzC,OAAO,CAAC;cAC1CuC,SAAS,EAAEC;YACb,CAAC;UACH,CAAC;UAEDnN,GAAG,CAACiN,QAAQ,GAAG7Y,OAAO,CAACD,OAAO,CAACkZ,MAAM,CAACrN,GAAG,CAACiN,QAAQ,EAAE,UAAUtC,OAAO,EAAE;YACrE,OAAOA,OAAO,CAACA,OAAO;UACxB,CAAC,CAAC;UAEF,IAAI3K,GAAG,CAACiN,QAAQ,IAAIjN,GAAG,CAACiN,QAAQ,CAACzW,MAAM,EAAE;YACvC,IAAIiJ,SAAS,GAAGO,GAAG,CAACP,SAAS;YAC7BO,GAAG,CAACiN,QAAQ,CAACvW,OAAO,CAAC,UAAU4W,IAAI,EAAER,KAAK,EAAE;cAC1C,IAAInC,OAAO,GAAG2C,IAAI,CAAC3C,OAAO;gBACtB4C,OAAO,GAAGD,IAAI,CAACC,OAAO;gBACtBf,UAAU,GAAGc,IAAI,CAACd,UAAU;cAChC,IAAIgB,IAAI,GAAGD,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,IAAIA,OAAO,CAACE,QAAQ,IAAIjB,UAAU,GAAGR,OAAO,CAACzG,CAAC,CAAC,cAAc,EAAE;gBAC9GoF,OAAO,EAAEqB,OAAO,CAACzG,CAAC,CAACoF,OAAO;cAC5B,CAAC,CAAC,GAAGqB,OAAO,CAACzG,CAAC,CAAC,uBAAuB,EAAE;gBACtCmI,KAAK,EAAE1B,OAAO,CAACzG,CAAC,CAAC9F,SAAS,CAACiO,KAAK,CAAC;gBACjC/C,OAAO,EAAEqB,OAAO,CAACzG,CAAC,CAACoF,OAAO;cAC5B,CAAC,CAAC;cACFiC,eAAe,CAAC1W,IAAI,CAAC2W,cAAc,CAACW,IAAI,EAAEV,KAAK,CAAC,CAAC;YACnD,CAAC,CAAC;UACJ,CAAC,MAAM,IAAI9M,GAAG,EAAE;YACd,IAAI2K,OAAO,GAAGvW,OAAO,CAACD,OAAO,CAACwZ,QAAQ,CAAC3N,GAAG,CAAC,GAAGgM,OAAO,CAACzG,CAAC,CAAC,cAAc,EAAE;cACtEoF,OAAO,EAAEqB,OAAO,CAACzG,CAAC,CAACvF,GAAG,CAAC2K,OAAO,IAAI,EAAE;YACtC,CAAC,CAAC,GAAGqB,OAAO,CAACzG,CAAC,CAAC,cAAc,EAAE;cAC7BoF,OAAO,EAAEqB,OAAO,CAACzG,CAAC,CAACvF,GAAG;YACxB,CAAC,CAAC;YACF4M,eAAe,CAAC1W,IAAI,CAAC2W,cAAc,CAAClC,OAAO,CAAC,CAAC;UAC/C;QACF;MACF,CAAC,CAAC;MACF,IAAIiD,UAAU,GAAG,IAAI,CAAC1E,cAAc,CAAC,YAAY,EAAE;QACjD+C,MAAM,EAAEW;MACV,CAAC,CAAC;MACF,IAAI,CAACjN,IAAI,CAAC0E,QAAQ,CAAC,QAAQ,EAAEuJ,UAAU,CAAC;MAExC,IAAI7B,YAAY,EAAE;QAChB,IAAI,CAAC7L,IAAI,CAAC,OAAO,EAAE+L,MAAM,CAAC;MAC5B;MAEA,OAAOA,MAAM;IACf;IACA;;IAEA;AACJ;AACA;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDtV,GAAG,EAAE,UAAU;IACfzC,KAAK,EAAE,SAAS2Z,QAAQ,CAAC9L,UAAU,EAAE+L,KAAK,EAAE;MAC1C,IAAIC,qBAAqB;MAEzB,IAAI,CAACnL,OAAO,GAAG,KAAK;MACpB,IAAI,CAACxE,UAAU,GAAG,KAAK;MACvB,IAAI,CAACsM,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;;MAExB,IAAI,CAACrF,QAAQ,CAAC,CAAC,CAAC,EAAEtQ,MAAM,CAACsI,aAAa,EAAE0E,UAAU,CAAC,EAAE;QACnDiM,UAAU,EAAE,IAAI;QAChBC,OAAO,EAAE;MACX,CAAC,CAAC;MACF,IAAI,CAAC5J,QAAQ,CAAC,SAAS,EAAE,KAAK,CAACI,MAAM,CAAC,IAAI,CAACc,CAAC,CAAC,UAAU,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;;MAEpE,IAAI,IAAI,CAAC1H,YAAY,IAAI,CAACkQ,qBAAqB,GAAG,IAAI,CAAChQ,gBAAgB,MAAM,IAAI,IAAIgQ,qBAAqB,KAAK,KAAK,CAAC,IAAIA,qBAAqB,CAACG,MAAM,EAAE;QACrJ,IAAI,CAACnQ,gBAAgB,CAACmQ,MAAM,EAAE;MAChC;MAEA,IAAI,CAAChO,IAAI,CAAC,QAAQ,EAAE6B,UAAU,EAAE+L,KAAK,CAAC;MAEtC,IAAIA,KAAK,EAAE;QACT,IAAI,CAAC5N,IAAI,CAAC,YAAY,EAAE6B,UAAU,CAAC;MACrC;MAEA,OAAOA,UAAU;IACnB;EACF,CAAC,EAAE;IACDpL,GAAG,EAAE,gBAAgB;IACrBzC,KAAK,EAAE,SAASia,cAAc,CAACrC,KAAK,EAAE;MACpC,IAAIA,KAAK,EAAE;QACT,IAAI3W,OAAO,CAAC2W,KAAK,CAAC,KAAK,QAAQ,IAAI,SAAS,IAAIA,KAAK,EAAE;UACrDA,KAAK,GAAGA,KAAK,CAACsC,OAAO;QACvB;QAEA,IAAI,OAAOtC,KAAK,KAAK,QAAQ,EAAE;UAC7BA,KAAK,GAAG;YACNnB,OAAO,EAAEmB;UACX,CAAC;QACH;MACF;MAEA,OAAOA,KAAK;IACd;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDnV,GAAG,EAAE,mBAAmB;IACxBzC,KAAK,EAAE,SAASma,iBAAiB,CAACvC,KAAK,EAAE;MACvCA,KAAK,GAAG,IAAI,CAACqC,cAAc,CAACrC,KAAK,CAAC;MAClC,IAAI,CAAC1N,UAAU,GAAG,KAAK;MACvB,IAAI,CAACsM,WAAW,CAAC,KAAK,CAAC;MACvB,IAAI,CAACxK,IAAI,CAAC,aAAa,EAAE4L,KAAK,CAAC,CAAC,CAAC;;MAEjC,IAAIA,KAAK,IAAIA,KAAK,CAACwC,MAAM,EAAE;QACzB,IAAI,CAACpO,IAAI,CAAC,QAAQ,EAAE;UAClBqO,OAAO,EAAE;QACX,CAAC,EAAE;UACDD,MAAM,EAAE;QACV,CAAC,CAAC;QACF,OAAO,KAAK;MACd;MAEA,IAAIrC,MAAM,GAAG,IAAI,CAACJ,UAAU,CAACC,KAAK,EAAE,IAAI,CAAC;MAEzC,IAAI,IAAI,CAACnM,IAAI,IAAI,IAAI,CAACA,IAAI,CAACpB,KAAK,EAAE;QAChC,IAAI,CAACiQ,cAAc,CAAC,IAAI,CAAC7O,IAAI,CAACpB,KAAK,CAAC;MACtC;MAEA,OAAO0N,MAAM;IACf;IACA;AACJ;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDtV,GAAG,EAAE,UAAU;IACfzC,KAAK,EAAE,SAAS4Q,QAAQ,CAAC1B,KAAK,EAAE6D,OAAO,EAAEwH,QAAQ,EAAEC,OAAO,EAAE;MAC1DtL,KAAK,GAAGA,KAAK,IAAI,CAAC,CAAC;MACnB,IAAIuL,oBAAoB,GAAG,KAAK,CAAC,CAAC;;MAElC,IAAI1H,OAAO,IAAIA,OAAO,CAACxH,SAAS,EAAE;QAChC,IAAI,CAACxB,YAAY,GAAG,IAAI,CAACA,YAAY,CAACnI,MAAM,CAAC,UAAUkK,GAAG,EAAE;UAC1D,OAAOA,GAAG,CAACP,SAAS,IAAIO,GAAG,CAACP,SAAS,KAAKwH,OAAO,CAACxH,SAAS,CAAC9I,GAAG;QACjE,CAAC,CAAC;MACJ;MAEAgB,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC6C,IAAI,CAAC,IAAI,EAAEgL,KAAK,EAAE,IAAI,CAAC;MAElF,IAAIlP,KAAK,GAAGE,OAAO,CAACD,OAAO,CAACya,KAAK,CAAC,IAAI,CAAC7M,UAAU,CAAC;MAElDqB,KAAK,CAAC6D,OAAO,GAAG/S,KAAK,CAAC+S,OAAO,GAAGA,OAAO;MACvC7D,KAAK,CAACsL,OAAO,GAAGA,OAAO;MAEvB,IAAID,QAAQ,IAAI,IAAI,CAACI,QAAQ,EAAE;QAC7B,IAAI,CAACA,QAAQ,GAAG,KAAK;MACvB;MAEA3a,KAAK,CAACqa,OAAO,GAAG,IAAI,CAACO,SAAS,CAAC5a,KAAK,CAACyS,IAAI,EAAEvD,KAAK,CAAC;MACjD,IAAI,CAACR,OAAO,GAAG,KAAK;MAEpB,IAAI,IAAI,CAACzE,SAAS,EAAE;QAClB,IAAI,CAAC0N,UAAU,EAAE;MACnB,CAAC,CAAC;;MAGF,IAAI4C,QAAQ,IAAI,IAAI,CAAC/T,OAAO,CAACK,SAAS,EAAE;QACtC,IAAI,CAACgD,gBAAgB,EAAE;MACzB;MAEA,IAAI,CAACqF,KAAK,IAAI,CAACA,KAAK,CAAC2L,MAAM,EAAE;QAC3B,IAAI,CAAC7O,IAAI,CAAC,QAAQ,EAAEhM,KAAK,EAAEkP,KAAK,EAAEqL,QAAQ,CAAC;QAC3CE,oBAAoB,GAAG,IAAI;MAC7B,CAAC,CAAC;;MAGF,IAAIA,oBAAoB,IAAI,CAAC,IAAI,CAAC7N,WAAW,EAAE;QAC7C,IAAI,CAACZ,IAAI,CAAC,aAAa,CAAC;QACxB,IAAI,CAACY,WAAW,GAAG,IAAI;MACzB;IACF;EACF,CAAC,EAAE;IACDnK,GAAG,EAAE,WAAW;IAChBzC,KAAK,EAAE,SAAS4a,SAAS,CAACnI,IAAI,EAAE;MAC9B,IAAIvD,KAAK,GAAG7M,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKmK,SAAS,GAAGnK,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MAElF,IAAIyY,KAAK,GAAGrX,IAAI,CAACW,eAAe,CAACiD,OAAO,CAAChG,SAAS,CAAC,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC6C,IAAI,CAAC,IAAI,EAAEuO,IAAI,EAAEvD,KAAK,CAAC;MAE/F,IAAI,CAAChP,OAAO,CAACD,OAAO,CAAC8a,OAAO,CAAC7L,KAAK,CAAC,IAAIA,KAAK,CAAC4K,UAAU,KAAK,IAAI,CAAC7P,SAAS,EAAE;QAC1E,IAAI,CAAC0N,UAAU,EAAE;MACnB;MAEA,OAAOmD,KAAK;IACd;IACA;AACJ;AACA;EAEE,CAAC,EAAE;IACDrY,GAAG,EAAE,kBAAkB;IACvBzC,KAAK,EAAE,SAAS+T,gBAAgB,GAAG;MACjC,IAAIiH,OAAO,GAAG,IAAI;MAElB,OAAO,IAAI,CAAC7Q,MAAM,CAAC4J,gBAAgB,EAAE,CAAC9I,IAAI,CAAC,YAAY;QACrD+P,OAAO,CAAChP,IAAI,CAAC,mBAAmB,EAAEgP,OAAO,CAACnN,UAAU,CAAC;QAErDmN,OAAO,CAAClH,UAAU,EAAE;MACtB,CAAC,CAAC;IACJ;IACA;AACJ;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACDrR,GAAG,EAAE,QAAQ;IACbzC,KAAK,EAAE,SAASga,MAAM,CAACiB,SAAS,EAAE;MAChC,IAAIC,WAAW,GAAG,IAAI,CAACjF,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC;MAEjD,IAAIiF,WAAW,KAAKD,SAAS,IAAIE,OAAO,CAAC,IAAI,CAAC9J,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE;QAClE,IAAI,CAACyC,UAAU,EAAE;QACjB,OAAO,IAAI;MACb,CAAC,MAAM;QACL,IAAI,CAAC9H,IAAI,CAAC,cAAc,CAAC;QACzB,OAAO,KAAK;MACd;IACF;EACF,CAAC,EAAE;IACDvJ,GAAG,EAAE,aAAa;IAClBzC,KAAK,EAAE,SAASob,WAAW,CAACvN,UAAU,EAAE;MACtC;MACAA,UAAU,CAAC8E,QAAQ,GAAG9E,UAAU,CAAC8E,QAAQ,IAAI,CAAC,CAAC;MAE/CzS,OAAO,CAACD,OAAO,CAACwG,QAAQ,CAACoH,UAAU,CAAC8E,QAAQ,EAAE;QAC5CG,QAAQ,EAAE5S,OAAO,CAACD,OAAO,CAAC0D,GAAG,CAAC,IAAI,EAAE,+BAA+B,EAAE,CAAC,CAAC,EAAE9C,MAAM,CAACwa,eAAe,GAAG,CAAC;QACnGC,MAAM,EAAEC,QAAQ,CAACrb,OAAO,CAACD,OAAO,CAAC0D,GAAG,CAAC,IAAI,EAAE,6BAA6B,EAAE,CAAC,CAAC,EAAEvD,OAAO,CAACH,OAAO,GAAG,CAACub,SAAS,EAAE,CAAC,EAAE,EAAE,CAAC;QAClHC,MAAM,EAAE3F,QAAQ,CAAC4F,QAAQ,CAACD,MAAM;QAChCE,QAAQ,EAAE7F,QAAQ,CAAC6F,QAAQ;QAC3BC,WAAW,EAAEC,SAAS,CAACC,OAAO;QAC9BC,SAAS,EAAEF,SAAS,CAACE,SAAS;QAC9BC,QAAQ,EAAEC,MAAM,CAACP,QAAQ,CAACQ,QAAQ;QAClCC,MAAM,EAAEN,SAAS,CAACM;MACpB,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACD1Z,GAAG,EAAE,YAAY;IACjBzC,KAAK,EAAE,SAASoc,UAAU,GAAG;MAC3B,IAAIC,OAAO,GAAG,IAAI;MAElB,IAAI7V,OAAO,GAAGnE,SAAS,CAACC,MAAM,GAAG,CAAC,IAAID,SAAS,CAAC,CAAC,CAAC,KAAKmK,SAAS,GAAGnK,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MACpF,IAAI,CAACia,iBAAiB,EAAE;MACxB,OAAO,IAAI5b,kBAAkB,CAACT,OAAO,CAAC,UAAUwK,OAAO,EAAEC,MAAM,EAAE;QAC/D;QACA,IAAI2R,OAAO,CAAC7V,OAAO,CAACsO,QAAQ,EAAE;UAC5B,OAAOrK,OAAO,CAAC;YACboD,UAAU,EAAEwO,OAAO,CAACxO,UAAU;YAC9B+L,KAAK,EAAE;UACT,CAAC,CAAC;QACJ;QAEA,IAAI/L,UAAU,GAAG,CAAC,CAAC,EAAEhN,MAAM,CAACsI,aAAa,EAAEkT,OAAO,CAACxO,UAAU,IAAI,CAAC,CAAC,CAAC;QAEpEwO,OAAO,CAACjB,WAAW,CAACvN,UAAU,CAAC;QAE/BA,UAAU,CAAC0D,KAAK,GAAG/K,OAAO,CAAC+K,KAAK,IAAI,WAAW;QAC/C,IAAIgL,OAAO,GAAG1O,UAAU,CAAC0D,KAAK,KAAK,OAAO;QAE1C8K,OAAO,CAACpG,IAAI,CAAC,cAAc,EAAE/T,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAE2L,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE;UAC5EtC,SAAS,EAAE/E,OAAO,CAAC+E;QACrB,CAAC,CAAC,EAAE,UAAUO,GAAG,EAAE2G,IAAI,EAAE;UACvB,IAAI3G,GAAG,EAAE;YACP,OAAOpB,MAAM,CAACoB,GAAG,CAAC;UACpB;UAEA+B,UAAU,CAAC2O,MAAM,GAAG/J,IAAI,IAAIA,IAAI,CAAC+J,MAAM,GAAG/J,IAAI,CAAC+J,MAAM,GAAG,EAAE;UAE1D,IAAI,CAACD,OAAO,IAAI,CAAC1O,UAAU,CAAC4E,IAAI,EAAE;YAChC,OAAO/H,MAAM,CAAC,oBAAoB,CAAC;UACrC;UAEA,IAAI,CAAC6R,OAAO,IAAI,CAACF,OAAO,CAAC5I,aAAa,CAAC5F,UAAU,CAAC4E,IAAI,EAAE,IAAI,CAAC,EAAE;YAC7D,OAAO/H,MAAM,EAAE;UACjB;UAEA2R,OAAO,CAACI,cAAc,CAAC,UAAUlG,IAAI,EAAE;YACrC,IAAImG,UAAU,GAAGnG,IAAI,CAAChL,SAAS,CAACmR,UAAU;YAE1C,IAAIA,UAAU,KAAK,aAAa,EAAE;cAChCxc,OAAO,CAACD,OAAO,CAAC0c,KAAK,CAAC9O,UAAU,CAAC4E,IAAI,EAAE8D,IAAI,CAAC0B,IAAI,CAAC;YACnD;UACF,CAAC,CAAC;UAEFoE,OAAO,CAACpG,IAAI,CAAC,kBAAkB,EAAE/T,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,EAAE2L,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE;YAChFtC,SAAS,EAAE/E,OAAO,CAAC+E;UACrB,CAAC,CAAC,EAAE,UAAUO,GAAG,EAAE;YACjB,IAAIA,GAAG,EAAE;cACP;cACA,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;gBAC3BA,GAAG,GAAG;kBACJ2K,OAAO,EAAE3K;gBACX,CAAC;cACH,CAAC,CAAC;;cAGFA,GAAG,GAAGyG,KAAK,CAACC,OAAO,CAAC1G,GAAG,CAAC,GAAGA,GAAG,GAAG,CAACA,GAAG,CAAC,CAAC,CAAC;;cAExCuQ,OAAO,CAACtS,YAAY,GAAG+B,GAAG;cAC1B,OAAOpB,MAAM,EAAE;YACjB;YAEA2R,OAAO,CAAC3N,OAAO,GAAG,IAAI,CAAC,CAAC;;YAExB,IAAI2N,OAAO,CAAC3S,KAAK,IAAI2S,OAAO,CAAC3S,KAAK,CAACkT,MAAM,EAAE;cACzC,IAAIC,MAAM,GAAGhP,UAAU,CAAC4E,IAAI,CAACnH,GAAG,IAAI+Q,OAAO,CAAC3S,KAAK,CAACkT,MAAM,CAACE,QAAQ,CAACjP,UAAU,CAAC4E,IAAI,CAACnH,GAAG,CAAC,GAAG,KAAK,GAAG,MAAM;cACvG,OAAO7K,OAAO,CAACwF,YAAY,CAAC8W,iBAAiB,CAACV,OAAO,CAAC3S,KAAK,CAACkT,MAAM,EAAEC,MAAM,EAAEhP,UAAU,EAAEwO,OAAO,CAAClS,MAAM,GAAGkS,OAAO,CAAClS,MAAM,CAAC3D,OAAO,GAAG,CAAC,CAAC,CAAC,CAACyE,IAAI,CAAC,UAAU7F,MAAM,EAAE;gBAC3J,OAAOqF,OAAO,CAAC;kBACboD,UAAU,EAAEzI,MAAM;kBAClBwU,KAAK,EAAE;gBACT,CAAC,CAAC;cACJ,CAAC,CAAC,CAAC7L,KAAK,CAAC,UAAU6J,KAAK,EAAE;gBACxByE,OAAO,CAACW,eAAe,CAACpF,KAAK,CAAC;gBAE9B,OAAOlN,MAAM,CAACkN,KAAK,CAAC;cACtB,CAAC,CAAC;YACJ;YAEA,IAAIqF,YAAY,GAAGZ,OAAO,CAAClS,MAAM;YAEjC,IAAIkS,OAAO,CAACrS,QAAQ,IAAI,CAACiT,YAAY,EAAE;cACrC,OAAOxS,OAAO,CAAC;gBACboD,UAAU,EAAEA,UAAU;gBACtB+L,KAAK,EAAE;cACT,CAAC,CAAC;YACJ,CAAC,CAAC;;YAGF,IAAIsD,YAAY,GAAGD,YAAY,CAACE,SAAS,GAAG,YAAY,GAAG,gBAAgB;YAC3EF,YAAY,CAACC,YAAY,CAAC,CAACrP,UAAU,CAAC,CAAC5C,IAAI,CAAC,UAAU7F,MAAM,EAAE;cAC5D,OAAOqF,OAAO,CAAC;gBACboD,UAAU,EAAEzI,MAAM;gBAClBwU,KAAK,EAAE;cACT,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC7L,KAAK,CAAC,UAAU6J,KAAK,EAAE;cACxByE,OAAO,CAACW,eAAe,CAACpF,KAAK,CAAC;cAE9B,OAAOlN,MAAM,CAACkN,KAAK,CAAC;YACtB,CAAC,CAAC;UACJ,CAAC,CAAC;QACJ,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACDnV,GAAG,EAAE,iBAAiB;IACtBzC,KAAK,EAAE,SAASgd,eAAe,CAACpF,KAAK,EAAE;MACrC,IAAIA,KAAK,CAACsC,OAAO,EAAE;QACjB,IAAI,CAAC3B,YAAY,GAAGX,KAAK,CAACsC,OAAO,CAACtY,MAAM,CAAC,UAAUkK,GAAG,EAAE;UACtD,OAAOA,GAAG,CAACsR,KAAK,GAAGtR,GAAG,CAACsR,KAAK,KAAK,OAAO,GAAGtR,GAAG;QAChD,CAAC,CAAC,CAACuR,GAAG,CAAC,UAAUvR,GAAG,EAAE;UACpBA,GAAG,CAACwM,UAAU,GAAG,IAAI;UACrB,OAAOxM,GAAG;QACZ,CAAC,CAAC;MACJ;IACF;EACF,CAAC,EAAE;IACDrJ,GAAG,EAAE,eAAe;IACpBzC,KAAK,EAAE,SAASsd,aAAa,CAAC9W,OAAO,EAAE;MACrC,IAAI+W,OAAO,GAAG,IAAI;MAElB,IAAI,CAACtT,SAAS,GAAG,IAAI;MACrB,IAAI,CAACC,UAAU,GAAG,IAAI;MACtB,OAAO,IAAI,CAACkS,UAAU,CAAC5V,OAAO,CAAC,CAACyE,IAAI,CAAC,UAAUuS,KAAK,EAAE;QACpD,IAAI3P,UAAU,GAAG2P,KAAK,CAAC3P,UAAU;UAC7B+L,KAAK,GAAG4D,KAAK,CAAC5D,KAAK;QACvB,OAAO2D,OAAO,CAAC5D,QAAQ,CAAC9L,UAAU,EAAE+L,KAAK,CAAC;MAC5C,CAAC,CAAC,CAAC3O,IAAI,CAAC,UAAUwS,OAAO,EAAE;QACzBF,OAAO,CAACG,mBAAmB,GAAG,KAAK;QACnC,OAAOD,OAAO;MAChB,CAAC,CAAC,CAAC1P,KAAK,CAAC,UAAUjC,GAAG,EAAE;QACtByR,OAAO,CAACG,mBAAmB,GAAG,KAAK;QACnC,OAAOhd,kBAAkB,CAACT,OAAO,CAACyK,MAAM,CAAC6S,OAAO,CAACpD,iBAAiB,CAACrO,GAAG,CAAC,CAAC;MAC1E,CAAC,CAAC;IACJ;EACF,CAAC,EAAE;IACDrJ,GAAG,EAAE,mBAAmB;IACxBzC,KAAK,EAAE,SAASsc,iBAAiB,GAAG;MAClC,IAAIqB,kBAAkB;QAClBC,OAAO,GAAG,IAAI;MAElB,CAACD,kBAAkB,GAAG,IAAI,CAACpF,YAAY,MAAM,IAAI,IAAIoF,kBAAkB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,kBAAkB,CAACnb,OAAO,CAAC,UAAUoV,KAAK,EAAE;QACxI,IAAIA,KAAK,CAACK,IAAI,EAAE;UACd,IAAI4F,SAAS,GAAG,CAAC,CAAC,EAAEhd,MAAM,CAACid,yBAAyB,EAAElG,KAAK,CAACK,IAAI,CAAC;UAEjE,IAAI1M,SAAS,GAAGqS,OAAO,CAACnG,YAAY,CAACoG,SAAS,EAAE3d,OAAO,CAACD,OAAO,CAACoY,QAAQ,EAAET,KAAK,CAACqB,kBAAkB,CAAC;UAEnG,IAAI1N,SAAS,EAAE;YACbA,SAAS,CAACgN,YAAY,GAAG,EAAE;UAC7B;QACF;MACF,CAAC,CAAC;MACF,IAAI,CAACA,YAAY,GAAG,EAAE;IACxB;IACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAEE,CAAC,EAAE;IACD9V,GAAG,EAAE,QAAQ;IACbzC,KAAK,EAAE,SAASuT,MAAM,CAACwK,MAAM,EAAEvX,OAAO,EAAE;MACtC,IAAIwX,OAAO,GAAG,IAAI;MAElB,IAAI,CAACN,mBAAmB,GAAG,IAAI;MAE/B,IAAI,CAACK,MAAM,EAAE;QACX,OAAO,IAAI,CAACE,YAAY,CAACzX,OAAO,CAAC,CAACyE,IAAI,CAAC,YAAY;UACjD,OAAO+S,OAAO,CAACV,aAAa,CAAC9W,OAAO,CAAC;QACvC,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,OAAO,IAAI,CAAC8W,aAAa,CAAC9W,OAAO,CAAC;MACpC;IACF;EACF,CAAC,EAAE;IACD/D,GAAG,EAAE,WAAW;IAChBzC,KAAK,EAAE,SAAS2T,SAAS,CAACuK,GAAG,EAAErK,OAAO,EAAE;MACtC,IAAIsK,OAAO,GAAG,IAAI;MAElB,IAAI,CAACD,GAAG,EAAE;QACR,OAAO5P,OAAO,CAACC,IAAI,CAAC,sBAAsB,CAAC;MAC7C;MAEA,IAAIV,UAAU,GAAG,IAAI,CAACA,UAAU,IAAI,CAAC,CAAC;MACtC,IAAIuQ,OAAO,GAAGF,GAAG;MACjB,IAAInO,QAAQ,GAAG;QACb8M,MAAM,EAAE,MAAM;QACdhJ,OAAO,EAAE,CAAC;MACZ,CAAC;MAED,IAAIA,OAAO,IAAIA,OAAO,CAACvR,MAAM,GAAG,CAAC,EAAE;QACjCuR,OAAO,CAACwJ,GAAG,CAAC,UAAUtX,CAAC,EAAE;UACvB,IAAIA,CAAC,CAACsY,MAAM,KAAK,EAAE,IAAItY,CAAC,CAAC/F,KAAK,KAAK,EAAE,EAAE;YACrC+P,QAAQ,CAAC8D,OAAO,CAAC9N,CAAC,CAACsY,MAAM,CAAC,GAAGF,OAAO,CAACG,WAAW,CAACvY,CAAC,CAAC/F,KAAK,EAAE6N,UAAU,CAAC;UACvE;QACF,CAAC,CAAC;MACJ;MAEA,IAAIuQ,OAAO,IAAIrO,QAAQ,EAAE;QACvBtP,OAAO,CAACwF,YAAY,CAAC8W,iBAAiB,CAACqB,OAAO,EAAErO,QAAQ,CAAC8M,MAAM,EAAEhP,UAAU,EAAE;UAC3EgG,OAAO,EAAE9D,QAAQ,CAAC8D;QACpB,CAAC,CAAC,CAAC5I,IAAI,CAAC,YAAY;UAClBkT,OAAO,CAACnS,IAAI,CAAC,aAAa,CAAC;UAE3BmS,OAAO,CAAChO,QAAQ,CAAC,SAAS,EAAE,kBAAkB,CAAC;QACjD,CAAC,CAAC,CAACpC,KAAK,CAAC,UAAUhI,CAAC,EAAE;UACpBoY,OAAO,CAACxG,UAAU,CAAC,EAAE,CAACpH,MAAM,CAACxK,CAAC,CAACwY,UAAU,GAAGxY,CAAC,CAACwY,UAAU,GAAG,EAAE,EAAE,GAAG,CAAC,CAAChO,MAAM,CAACxK,CAAC,CAACyY,MAAM,GAAGzY,CAAC,CAACyY,MAAM,GAAGzY,CAAC,CAAC,CAAC;UAEpGoY,OAAO,CAACnS,IAAI,CAAC,OAAO,EAAE,EAAE,CAACuE,MAAM,CAACxK,CAAC,CAACwY,UAAU,GAAGxY,CAAC,CAACwY,UAAU,GAAG,EAAE,EAAE,GAAG,CAAC,CAAChO,MAAM,CAACxK,CAAC,CAACyY,MAAM,GAAGzY,CAAC,CAACyY,MAAM,GAAGzY,CAAC,CAAC,CAAC;UAEvGuI,OAAO,CAACsJ,KAAK,CAAC,EAAE,CAACrH,MAAM,CAACxK,CAAC,CAACwY,UAAU,GAAGxY,CAAC,CAACwY,UAAU,GAAG,EAAE,EAAE,GAAG,CAAC,CAAChO,MAAM,CAACxK,CAAC,CAACyY,MAAM,GAAGzY,CAAC,CAACyY,MAAM,GAAGzY,CAAC,CAAC,CAAC;UAE/FoY,OAAO,CAAChO,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAACI,MAAM,CAACxK,CAAC,CAACwY,UAAU,GAAGxY,CAAC,CAACwY,UAAU,GAAG,EAAE,EAAE,GAAG,CAAC,CAAChO,MAAM,CAACxK,CAAC,CAACyY,MAAM,GAAGzY,CAAC,CAACyY,MAAM,GAAGzY,CAAC,EAAE,OAAO,CAAC,CAAC;QAC3H,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,IAAI,CAACiG,IAAI,CAAC,OAAO,EAAE,sCAAsC,CAAC;QAC1D,IAAI,CAACmE,QAAQ,CAAC,SAAS,EAAE,sCAAsC,CAAC;QAChE,OAAO7B,OAAO,CAACC,IAAI,CAAC,sCAAsC,CAAC;MAC7D;IACF;EACF,CAAC,EAAE;IACD9L,GAAG,EAAE,kBAAkB;IACvBzC,KAAK,EAAE,SAAS0Q,gBAAgB,GAAG;MACjC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAACtE,UAAU,EAAE;QAC7B;MACF;MAEA,IAAIqS,kBAAkB,GAAG,CAAC,CAAC,EAAE5d,MAAM,CAAC6d,gBAAgB,EAAE,IAAI,CAACtS,UAAU,EAAE;QACrE,gBAAgB,EAAE,WAAW;QAC7B,qBAAqB,EAAE;MACzB,CAAC,CAAC;MAEF,IAAIqS,kBAAkB,CAACnc,MAAM,GAAG,CAAC,EAAE;QACjCmc,kBAAkB,CAAC,CAAC,CAAC,CAACE,MAAM,CAAC,EAAE,CAACpO,MAAM,CAAC,IAAI,CAACpE,IAAI,CAACyS,IAAI,GAAG,IAAI,CAACzS,IAAI,CAACyS,IAAI,GAAG,MAAM,EAAE,MAAM,CAAC,CAAC;MAC3F;IACF;EACF,CAAC,EAAE;IACDnc,GAAG,EAAE,UAAU;IACfkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,OAAO,IAAI,CAACkb,SAAS,IAAI,KAAK;IAChC,CAAC;IACDlT,GAAG,EAAE,SAASA,GAAG,CAAC3L,KAAK,EAAE;MACvB,IAAI,CAAC6e,SAAS,GAAG,CAAC,CAAC7e,KAAK;MACxB,IAAI,CAACgM,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC6S,SAAS,CAAC;IACvC;EACF,CAAC,EAAE;IACDpc,GAAG,EAAE,YAAY;IACjBkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,IAAImb,qBAAqB,EAAEC,sBAAsB;MAEjD,OAAO,CAACD,qBAAqB,GAAG,CAACC,sBAAsB,GAAG,IAAI,CAAC9O,MAAM,CAACF,QAAQ,MAAM,IAAI,IAAIgP,sBAAsB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,sBAAsB,CAACC,UAAU,MAAM,IAAI,IAAIF,qBAAqB,KAAK,KAAK,CAAC,GAAGA,qBAAqB,GAAG,EAAE;IACvP;EACF,CAAC,EAAE;IACDrc,GAAG,EAAE,WAAW;IAChBkB,GAAG,EAAE,SAASA,GAAG,GAAG;MAClB,IAAIsb,sBAAsB,EAAEC,sBAAsB;MAElD,OAAO,CAACD,sBAAsB,GAAG,CAACC,sBAAsB,GAAG,IAAI,CAACjP,MAAM,CAACF,QAAQ,MAAM,IAAI,IAAImP,sBAAsB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,sBAAsB,CAACC,SAAS,MAAM,IAAI,IAAIF,sBAAsB,KAAK,KAAK,CAAC,GAAGA,sBAAsB,GAAG,EAAE;IACzP;EACF,CAAC,CAAC,CAAC;EAEH,OAAO5X,OAAO;AAChB,CAAC,CAACzG,qBAAqB,CAACX,OAAO,CAAC;AAEhCF,OAAO,CAACE,OAAO,GAAGoH,OAAO;AACzBA,OAAO,CAACqB,UAAU,GAAGjI,OAAO,CAACwF,YAAY,CAACyC,UAAU;AACpDrB,OAAO,CAAC+X,SAAS,GAAG3e,OAAO,CAACwF,YAAY,CAACmZ,SAAS;AAClD/X,OAAO,CAACgY,SAAS,GAAG5e,OAAO,CAACwF,YAAY,CAACoZ,SAAS"},"metadata":{},"sourceType":"script"}