{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nrequire(\"core-js/modules/es.reflect.construct.js\");\nrequire(\"core-js/modules/es.reflect.get.js\");\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\nrequire(\"core-js/modules/es.symbol.js\");\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\nrequire(\"core-js/modules/es.symbol.description.js\");\nrequire(\"core-js/modules/es.symbol.iterator.js\");\nrequire(\"core-js/modules/es.array.iterator.js\");\nrequire(\"core-js/modules/es.string.iterator.js\");\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\nrequire(\"core-js/modules/es.array.from.js\");\nrequire(\"core-js/modules/es.array.slice.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/es.array.includes.js\");\nrequire(\"core-js/modules/es.string.includes.js\");\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\nrequire(\"core-js/modules/es.array.find.js\");\nrequire(\"core-js/modules/es.regexp.exec.js\");\nrequire(\"core-js/modules/es.string.split.js\");\nrequire(\"core-js/modules/es.array.map.js\");\nrequire(\"core-js/modules/es.object.keys.js\");\nrequire(\"core-js/modules/es.array.concat.js\");\nrequire(\"core-js/modules/es.array.find-index.js\");\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _Webform2 = _interopRequireDefault(require(\"./Webform\"));\nvar _Formio = require(\"./Formio\");\nvar _utils = require(\"./utils/utils\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _s, _e;\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n  return _arr;\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n  return arr2;\n}\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get.bind();\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get.apply(this, arguments);\n}\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return _possibleConstructorReturn(this, result);\n  };\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return _assertThisInitialized(self);\n}\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nvar Wizard = /*#__PURE__*/function (_Webform) {\n  _inherits(Wizard, _Webform);\n  var _super = _createSuper(Wizard);\n\n  /**\n   * Constructor for wizard based forms\n   * @param element Dom element to place this wizard.\n   * @param {Object} options Options object, supported options are:\n   *    - breadcrumbSettings.clickable: true (default) determines if the breadcrumb bar is clickable or not\n   *    - buttonSettings.show*(Previous, Next, Cancel): true (default) determines if the button is shown or not\n   *    - allowPrevious: false (default) determines if the breadcrumb bar is clickable or not for visited tabs\n   */\n  function Wizard() {\n    var _this;\n    _classCallCheck(this, Wizard);\n    var element, options;\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1] || {};\n    } else {\n      options = arguments[0] || {};\n    }\n    options.display = 'wizard';\n    _this = _super.call(this, element, options);\n    _this.pages = [];\n    _this.prefixComps = [];\n    _this.suffixComps = [];\n    _this.components = [];\n    _this.originalComponents = [];\n    _this.page = 0;\n    _this.currentPanel = null;\n    _this.currentPanels = null;\n    _this.currentNextPage = 0;\n    _this._seenPages = [0];\n    _this.subWizards = [];\n    _this.allPages = [];\n    _this.lastPromise = _nativePromiseOnly.default.resolve();\n    _this.enabledIndex = 0;\n    _this.editMode = false;\n    _this.originalOptions = _lodash.default.cloneDeep(_this.options);\n    return _this;\n  }\n  _createClass(Wizard, [{\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      var next = this.getNextPage();\n      if (_lodash.default.isNumber(next)) {\n        return next === -1;\n      }\n      return _lodash.default.isNull(next);\n    }\n  }, {\n    key: \"getPages\",\n    value: function getPages() {\n      var _this2 = this;\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _args$all = args.all,\n        all = _args$all === void 0 ? false : _args$all;\n      var pages = this.hasExtraPages ? this.components : this.pages;\n      var filteredPages = pages.filter(all ? _lodash.default.identity : function (p, index) {\n        return _this2._seenPages.includes(index);\n      });\n      return filteredPages;\n    }\n  }, {\n    key: \"hasExtraPages\",\n    get: function get() {\n      return !_lodash.default.isEmpty(this.subWizards);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return _get(_getPrototypeOf(Wizard.prototype), \"data\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n      this._data = value;\n      _lodash.default.each(this.getPages({\n        all: true\n      }), function (component) {\n        component.data = _this3.componentContext(component);\n      });\n    }\n  }, {\n    key: \"localData\",\n    get: function get() {\n      var _this$pages$this$page, _this$pages$this$page2;\n      return ((_this$pages$this$page = this.pages[this.page]) === null || _this$pages$this$page === void 0 ? void 0 : (_this$pages$this$page2 = _this$pages$this$page.root) === null || _this$pages$this$page2 === void 0 ? void 0 : _this$pages$this$page2.submission.data) || this.submission.data;\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      var visible = _get(_getPrototypeOf(Wizard.prototype), \"checkConditions\", this).call(this, data, flags, row);\n      this.establishPages(data);\n      return visible;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.submitting ? this.getPages({\n        all: this.isLastPage()\n      }) : _get(_getPrototypeOf(Wizard.prototype), \"getComponents\", this).call(this);\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      this.getPages({\n        all: true\n      }).forEach(function (page) {\n        return page.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this$pages,\n        _this4 = this;\n\n      // Check for and initlize button settings object\n      this.options.buttonSettings = _lodash.default.defaults(this.options.buttonSettings, {\n        showPrevious: true,\n        showNext: true,\n        showSubmit: true,\n        showCancel: !this.options.readOnly\n      });\n      if (!this.isSecondInit) {\n        var _this$options, _this$options$breadcr;\n        this.isClickableDefined = (_this$options = this.options) === null || _this$options === void 0 ? void 0 : (_this$options$breadcr = _this$options.breadcrumbSettings) === null || _this$options$breadcr === void 0 ? void 0 : _this$options$breadcr.hasOwnProperty('clickable');\n        this.isSecondInit = true;\n      }\n      this.options.breadcrumbSettings = _lodash.default.defaults(this.options.breadcrumbSettings, {\n        clickable: true\n      });\n      this.options.allowPrevious = this.options.allowPrevious || false;\n      this.page = 0;\n      var onReady = _get(_getPrototypeOf(Wizard.prototype), \"init\", this).call(this);\n      this.setComponentSchema();\n      if ((_this$pages = this.pages) !== null && _this$pages !== void 0 && _this$pages[this.page]) {\n        this.component = this.pages[this.page].component;\n      }\n      this.on('subWizardsUpdated', function (subForm) {\n        var subWizard = _this4.subWizards.find(function (subWizard) {\n          var _subWizard$subForm;\n          return (subForm === null || subForm === void 0 ? void 0 : subForm.id) && ((_subWizard$subForm = subWizard.subForm) === null || _subWizard$subForm === void 0 ? void 0 : _subWizard$subForm.id) === (subForm === null || subForm === void 0 ? void 0 : subForm.id);\n        });\n        if (_this4.subWizards.length && subWizard) {\n          subWizard.subForm.setValue(subForm._submission, {}, true);\n          _this4.establishPages();\n          _this4.redraw();\n        }\n      });\n      return onReady;\n    }\n  }, {\n    key: \"wizardKey\",\n    get: function get() {\n      return \"wizard-\".concat(this.id);\n    }\n  }, {\n    key: \"wizard\",\n    get: function get() {\n      return this.form;\n    },\n    set: function set(form) {\n      this.setForm(form);\n    }\n  }, {\n    key: \"buttons\",\n    get: function get() {\n      var _this5 = this;\n      var buttons = {};\n      [{\n        name: 'cancel',\n        method: 'cancel'\n      }, {\n        name: 'previous',\n        method: 'prevPage'\n      }, {\n        name: 'next',\n        method: 'nextPage'\n      }, {\n        name: 'submit',\n        method: 'submit'\n      }].forEach(function (button) {\n        if (_this5.hasButton(button.name)) {\n          buttons[button.name] = button;\n        }\n      });\n      return buttons;\n    }\n  }, {\n    key: \"buttonOrder\",\n    get: function get() {\n      var _this$options$propert, _this$options$propert2, _this$options$propert3;\n      var defaultButtonOrder = ['cancel', 'previous', 'next', 'submit'];\n      return (_this$options$propert = (_this$options$propert2 = this.options.properties) === null || _this$options$propert2 === void 0 ? void 0 : (_this$options$propert3 = _this$options$propert2.wizardButtonOrder) === null || _this$options$propert3 === void 0 ? void 0 : _this$options$propert3.toLowerCase().split(', ')) !== null && _this$options$propert !== void 0 ? _this$options$propert : defaultButtonOrder;\n    }\n  }, {\n    key: \"renderContext\",\n    get: function get() {\n      var _this$root, _this$root$component;\n      return {\n        disableWizardSubmit: this.form.disableWizardSubmit,\n        wizardKey: this.wizardKey,\n        isBreadcrumbClickable: this.isBreadcrumbClickable(),\n        isSubForm: !!this.parent && !((_this$root = this.root) !== null && _this$root !== void 0 && (_this$root$component = _this$root.component) !== null && _this$root$component !== void 0 && _this$root$component.type) === 'wizard',\n        panels: this.allPages.length ? this.allPages.map(function (page) {\n          return page.component;\n        }) : this.pages.map(function (page) {\n          return page.component;\n        }),\n        buttons: this.buttons,\n        currentPage: this.page,\n        buttonOrder: this.buttonOrder\n      };\n    }\n  }, {\n    key: \"prepareNavigationSettings\",\n    value: function prepareNavigationSettings(ctx) {\n      var currentPanel = this.currentPanel;\n      if (currentPanel && currentPanel.buttonSettings) {\n        Object.keys(currentPanel.buttonSettings).forEach(function () {\n          Object.keys(ctx.buttons).forEach(function (key) {\n            if (typeof currentPanel.buttonSettings[key] !== 'undefined' && !currentPanel.buttonSettings[key] || ctx.isSubForm) {\n              ctx.buttons[key] = null;\n            }\n          });\n        });\n      }\n      return this.renderTemplate('wizardNav', ctx);\n    }\n  }, {\n    key: \"prepareHeaderSettings\",\n    value: function prepareHeaderSettings(ctx, headerType) {\n      if (this.currentPanel && this.currentPanel.breadcrumb === 'none' || ctx.isSubForm) {\n        return null;\n      }\n      return this.renderTemplate(headerType, ctx);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n      var ctx = this.renderContext;\n      if (this.component.key) {\n        ctx.panels.map(function (panel) {\n          if (panel.key === _this6.component.key) {\n            _this6.currentPanel = panel;\n            ctx.wizardPageTooltip = _this6.getFormattedTooltip(panel.tooltip);\n          }\n        });\n      }\n      var wizardNav = this.prepareNavigationSettings(ctx);\n      var wizardHeaderType = \"wizardHeader\".concat(_lodash.default.get(this.form, 'settings.wizardHeaderType', ''));\n      var wizardHeaderLocation = _lodash.default.get(this.form, 'settings.wizardHeaderLocation', 'left');\n      var wizardHeader = this.prepareHeaderSettings(ctx, wizardHeaderType);\n      return this.renderTemplate('wizard', _objectSpread(_objectSpread({}, ctx), {}, {\n        className: _get(_getPrototypeOf(Wizard.prototype), \"getClassName\", this).call(this),\n        wizardHeader: wizardHeader,\n        wizardHeaderType: wizardHeaderType,\n        wizardHeaderLocation: wizardHeaderLocation,\n        wizardNav: wizardNav,\n        components: this.renderComponents([].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)))\n      }), this.builderMode ? 'builder' : 'form');\n    }\n  }, {\n    key: \"redrawNavigation\",\n    value: function redrawNavigation() {\n      if (this.element) {\n        var navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n        if (navElement) {\n          var _this$loadRefs;\n          this.detachNav();\n          navElement.outerHTML = this.renderTemplate('wizardNav', this.renderContext);\n          navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n          this.loadRefs(navElement, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _this$loadRefs));\n          this.attachNav();\n        }\n      }\n    }\n  }, {\n    key: \"redrawHeader\",\n    value: function redrawHeader() {\n      if (this.element) {\n        var headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n        if (headerElement) {\n          var _this$loadRefs2;\n          this.detachHeader();\n          headerElement.outerHTML = this.renderTemplate(\"wizardHeader\".concat(_lodash.default.get(this.form, 'settings.wizardHeaderType', '')), this.renderContext);\n          headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n          this.loadRefs(headerElement, (_this$loadRefs2 = {}, _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs2));\n          this.attachHeader();\n        }\n      }\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs3,\n        _this7 = this;\n      this.element = element;\n      this.loadRefs(element, (_this$loadRefs3 = {}, _defineProperty(_this$loadRefs3, this.wizardKey, 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-header\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs3));\n      if ((this.options.readOnly || this.editMode) && !this.enabledIndex) {\n        var _this$pages2;\n        this.enabledIndex = ((_this$pages2 = this.pages) === null || _this$pages2 === void 0 ? void 0 : _this$pages2.length) - 1;\n      }\n      this.hook('attachWebform', element, this);\n      var promises = this.attachComponents(this.refs[this.wizardKey], [].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)));\n      this.attachNav();\n      this.attachHeader();\n      return promises.then(function () {\n        _this7.emit('render', {\n          component: _this7.currentPage,\n          page: _this7.page\n        });\n        if (_this7.component.scrollToTop) {\n          _this7.scrollPageToTop();\n        }\n      });\n    }\n  }, {\n    key: \"scrollPageToTop\",\n    value: function scrollPageToTop() {\n      var _this$refs;\n      var pageTop = (_this$refs = this.refs[\"\".concat(this.wizardKey, \"-header\")]) !== null && _this$refs !== void 0 ? _this$refs : this.refs[this.wizardKey];\n      if (!pageTop) {\n        return;\n      }\n      if ('scrollIntoView' in pageTop) {\n        pageTop.scrollIntoView(true);\n      } else {\n        this.scrollIntoView(pageTop);\n      }\n    }\n  }, {\n    key: \"isBreadcrumbClickable\",\n    value: function isBreadcrumbClickable() {\n      var _this8 = this;\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this8.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return this.isClickableDefined ? this.options.breadcrumbSettings.clickable : _lodash.default.get(currentPage, 'component.breadcrumbClickable', true);\n    }\n  }, {\n    key: \"isAllowPrevious\",\n    value: function isAllowPrevious() {\n      var _this9 = this;\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this9.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return _lodash.default.get(currentPage.component, 'allowPrevious', this.options.allowPrevious);\n    }\n  }, {\n    key: \"handleNaviageteOnEnter\",\n    value: function handleNaviageteOnEnter(event) {\n      if (event.keyCode === 13) {\n        var clickEvent = new CustomEvent('click');\n        var buttonElement = this.refs[\"\".concat(this.wizardKey, \"-\").concat(this.buttons.next.name)];\n        if (buttonElement) {\n          buttonElement.dispatchEvent(clickEvent);\n        }\n      }\n    }\n  }, {\n    key: \"handleSaveOnEnter\",\n    value: function handleSaveOnEnter(event) {\n      if (event.keyCode === 13) {\n        var clickEvent = new CustomEvent('click');\n        var buttonElement = this.refs[\"\".concat(this.wizardKey, \"-\").concat(this.buttons.submit.name)];\n        if (buttonElement) {\n          buttonElement.dispatchEvent(clickEvent);\n        }\n      }\n    }\n  }, {\n    key: \"attachNav\",\n    value: function attachNav() {\n      var _this10 = this;\n      if (this.component.navigateOnEnter) {\n        this.addEventListener(document, 'keyup', this.handleNaviageteOnEnter.bind(this));\n      }\n      if (this.component.saveOnEnter) {\n        this.addEventListener(document, 'keyup', this.handleSaveOnEnter.bind(this));\n      }\n      _lodash.default.each(this.buttons, function (button) {\n        var buttonElement = _this10.refs[\"\".concat(_this10.wizardKey, \"-\").concat(button.name)];\n        _this10.addEventListener(buttonElement, 'click', function (event) {\n          event.preventDefault(); // Disable the button until done.\n\n          buttonElement.setAttribute('disabled', 'disabled');\n          _this10.setLoading(buttonElement, true); // Call the button method, then re-enable the button.\n\n          _this10[button.method]().then(function () {\n            buttonElement.removeAttribute('disabled');\n            _this10.setLoading(buttonElement, false);\n          }).catch(function () {\n            buttonElement.removeAttribute('disabled');\n            _this10.setLoading(buttonElement, false);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"emitWizardPageSelected\",\n    value: function emitWizardPageSelected(index) {\n      this.emit('wizardPageSelected', this.pages[index], index);\n    }\n  }, {\n    key: \"attachHeader\",\n    value: function attachHeader() {\n      var _this11 = this;\n      var isAllowPrevious = this.isAllowPrevious();\n      this.attachTooltips(this.refs[\"\".concat(this.wizardKey, \"-tooltip\")], this.currentPanel.tooltip);\n      if (this.isBreadcrumbClickable() || isAllowPrevious) {\n        var _this$refs2;\n        (_this$refs2 = this.refs[\"\".concat(this.wizardKey, \"-link\")]) === null || _this$refs2 === void 0 ? void 0 : _this$refs2.forEach(function (link, index) {\n          if (!isAllowPrevious || index <= _this11.enabledIndex) {\n            _this11.addEventListener(link, 'click', function (event) {\n              _this11.emit('wizardNavigationClicked', _this11.pages[index]);\n              event.preventDefault();\n              return _this11.setPage(index).then(function () {\n                _this11.emitWizardPageSelected(index);\n              });\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"detachNav\",\n    value: function detachNav() {\n      var _this12 = this;\n      if (this.component.navigateOnEnter) {\n        this.removeEventListener(document, 'keyup', this.handleNaviageteOnEnter.bind(this));\n      }\n      if (this.component.saveOnEnter) {\n        this.removeEventListener(document, 'keyup', this.handleSaveOnEnter.bind(this));\n      }\n      _lodash.default.each(this.buttons, function (button) {\n        _this12.removeEventListener(_this12.refs[\"\".concat(_this12.wizardKey, \"-\").concat(button.name)], 'click');\n      });\n    }\n  }, {\n    key: \"detachHeader\",\n    value: function detachHeader() {\n      var _this13 = this;\n      if (this.refs[\"\".concat(this.wizardKey, \"-link\")]) {\n        this.refs[\"\".concat(this.wizardKey, \"-link\")].forEach(function (link) {\n          _this13.removeEventListener(link, 'click');\n        });\n      }\n    }\n  }, {\n    key: \"transformPages\",\n    value: function transformPages() {\n      var _this14 = this;\n      var allComponents = [];\n      var components = this.getSortedComponents(this);\n      var defferedComponents = [];\n      this.allPages = []; // Get all components including all nested components and line up in the correct order\n\n      var getAllComponents = function getAllComponents(nestedComp, compsArr) {\n        var pushAllowed = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n        var nestedPages = [];\n        var dataArrayComponents = ['datagrid', 'editgrid', 'dynamicWizard'];\n        var currentComponents = nestedComp !== null && nestedComp !== void 0 && nestedComp.subForm ? _this14.getSortedComponents(nestedComp.subForm) : (nestedComp === null || nestedComp === void 0 ? void 0 : nestedComp.components) || [];\n        var visibleComponents = currentComponents.filter(function (comp) {\n          return comp._visible;\n        });\n        var filteredComponents = visibleComponents.filter(function (comp) {\n          return !dataArrayComponents.includes(comp.component.type) && (comp.type !== 'form' || comp.isNestedWizard);\n        });\n        var additionalComponents = currentComponents.filter(function (comp) {\n          var _comp$subForm;\n          return ((_comp$subForm = comp.subForm) === null || _comp$subForm === void 0 ? void 0 : _comp$subForm._form.display) !== 'wizard';\n        });\n        var hasNested = false;\n        (0, _utils.eachComponent)(filteredComponents, function (comp) {\n          if (comp && comp.component) {\n            if (comp.component.type === 'panel' && comp !== null && comp !== void 0 && comp.parent.wizard && !getAllComponents(comp, compsArr, false)) {\n              if (pushAllowed) {\n                _this14.setRootPanelId(comp);\n                nestedPages.push(comp);\n              }\n              hasNested = true;\n            }\n            if (comp.isNestedWizard && comp.subForm) {\n              var hasNestedForm = getAllComponents(comp, nestedPages, pushAllowed);\n              if (!hasNested) {\n                hasNested = hasNestedForm;\n              }\n            }\n          }\n        }, true);\n        if (nestedComp.component.type === 'panel') {\n          if (!hasNested && pushAllowed) {\n            _this14.setRootPanelId(nestedComp);\n            compsArr.push(nestedComp);\n          }\n          if (hasNested && additionalComponents.length) {\n            var newComp = _lodash.default.clone(nestedComp);\n            newComp.components = additionalComponents;\n            _this14.setRootPanelId(newComp);\n            defferedComponents.push(newComp);\n          }\n        }\n        if (pushAllowed) {\n          compsArr.push.apply(compsArr, _toConsumableArray(defferedComponents).concat(nestedPages));\n          defferedComponents = [];\n        }\n        return hasNested;\n      };\n      components.forEach(function (component) {\n        if (component.visible) {\n          getAllComponents(component, allComponents);\n        }\n      }, []); // recalculate pages only for root wizards, including the situation when the wizard is in a wrapper\n\n      if (this.localRoot && this.id === this.localRoot.id) {\n        allComponents.forEach(function (comp, index) {\n          comp.eachComponent(function (component) {\n            component.page = index;\n          });\n        });\n      }\n      this.allPages = allComponents;\n    }\n  }, {\n    key: \"getSortedComponents\",\n    value: function getSortedComponents(_ref) {\n      var components = _ref.components,\n        originalComponents = _ref.originalComponents;\n      // sorts components if they were shuffled after the conditional logic\n      var currentComponents = [];\n      var currentPages = [];\n      if (components && components.length) {\n        components.map(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n      originalComponents === null || originalComponents === void 0 ? void 0 : originalComponents.forEach(function (item) {\n        if (!item.key) {\n          item.key = item.title;\n        }\n        if (currentPages[item.key]) {\n          currentComponents.push(currentPages[item.key]);\n        }\n      });\n      return currentComponents;\n    }\n  }, {\n    key: \"findRootPanel\",\n    value: function findRootPanel(component) {\n      var _component$parent;\n      return (_component$parent = component.parent) !== null && _component$parent !== void 0 && _component$parent.parent ? this.findRootPanel(component.parent) : component;\n    }\n  }, {\n    key: \"setRootPanelId\",\n    value: function setRootPanelId(component) {\n      var _component$parent2;\n      if (component.rootPanelId && component.rootPanelId !== component.id) {\n        return;\n      }\n      var parent = (_component$parent2 = component.parent) !== null && _component$parent2 !== void 0 && _component$parent2.parent ? this.findRootPanel(component.parent) : component;\n      component.rootPanelId = parent.id;\n    }\n  }, {\n    key: \"establishPages\",\n    value: function establishPages() {\n      var _this15 = this;\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.data;\n      this.pages = [];\n      this.prefixComps = [];\n      this.suffixComps = [];\n      var visible = [];\n      var currentPages = {};\n      var pageOptions = _objectSpread(_objectSpread({}, _lodash.default.clone(this.options)), this.parent ? {\n        root: this\n      } : {});\n      if (this.components && this.components.length) {\n        this.components.forEach(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n      if (this.originalComponents) {\n        this.originalComponents.forEach(function (item) {\n          if (item.type === 'panel') {\n            if (!item.key) {\n              item.key = item.title;\n            }\n            var page = currentPages[item.key];\n            var forceShow = _this15.options.show ? _this15.options.show[item.key] : false;\n            var forceHide = _this15.options.hide ? _this15.options.hide[item.key] : false;\n            var isVisible = !page ? (0, _utils.checkCondition)(item, data, data, _this15.component, _this15) && !item.hidden : page.visible;\n            if (forceShow) {\n              isVisible = true;\n            } else if (forceHide) {\n              isVisible = false;\n            }\n            if (isVisible) {\n              visible.push(item);\n              if (page) {\n                _this15.pages.push(page);\n              }\n            }\n            if (!page && isVisible) {\n              page = _this15.createComponent(item, pageOptions);\n              page.visible = isVisible;\n              _this15.pages.push(page);\n              page.eachComponent(function (component) {\n                component.page = _this15.pages.length - 1;\n              });\n            }\n          } else if (item.type !== 'button') {\n            if (!_this15.pages.length) {\n              _this15.prefixComps.push(_this15.createComponent(item, pageOptions));\n            } else {\n              _this15.suffixComps.push(_this15.createComponent(item, pageOptions));\n            }\n          }\n        });\n      }\n      if (this.pages.length) {\n        this.emit('pagesChanged');\n      }\n      this.transformPages();\n      if (this.allPages && this.allPages.length) {\n        this.updatePages();\n      }\n      return visible;\n    }\n  }, {\n    key: \"updatePages\",\n    value: function updatePages() {\n      this.pages = this.allPages;\n    }\n  }, {\n    key: \"addComponents\",\n    value: function addComponents() {\n      this.establishPages();\n    }\n  }, {\n    key: \"setPage\",\n    value: function setPage(num) {\n      var _this16 = this;\n      if (num === this.page) {\n        return _nativePromiseOnly.default.resolve();\n      }\n      if (num >= 0 && num < this.pages.length) {\n        this.page = num;\n        this.pageFieldLogic(num);\n        this.getNextPage();\n        var parentNum = num;\n        if (this.hasExtraPages) {\n          var pageFromPages = this.pages[num];\n          var pageFromComponents = this.components[num];\n          if (!pageFromComponents || (pageFromPages === null || pageFromPages === void 0 ? void 0 : pageFromPages.id) !== pageFromComponents.id) {\n            parentNum = this.components.findIndex(function (comp) {\n              var _this16$pages, _this16$pages$parentN;\n              return comp.id === ((_this16$pages = _this16.pages) === null || _this16$pages === void 0 ? void 0 : (_this16$pages$parentN = _this16$pages[parentNum]) === null || _this16$pages$parentN === void 0 ? void 0 : _this16$pages$parentN.rootPanelId);\n            });\n          }\n        }\n        if (!this._seenPages.includes(parentNum)) {\n          this._seenPages = this._seenPages.concat(parentNum);\n        }\n        this.redraw().then(function () {\n          _this16.checkData(_this16.submission.data);\n        });\n        return _nativePromiseOnly.default.resolve();\n      } else if (!this.pages.length) {\n        this.redraw();\n        return _nativePromiseOnly.default.resolve();\n      }\n      return _nativePromiseOnly.default.reject('Page not found');\n    }\n  }, {\n    key: \"pageFieldLogic\",\n    value: function pageFieldLogic(page) {\n      var _this$pages3;\n      if ((_this$pages3 = this.pages) !== null && _this$pages3 !== void 0 && _this$pages3[page]) {\n        // Handle field logic on pages.\n        this.component = this.pages[page].component;\n        this.originalComponent = (0, _utils.fastCloneDeep)(this.component);\n        this.fieldLogic(this.data); // If disabled changed, be sure to distribute the setting.\n\n        this.disabled = this.shouldDisabled;\n      }\n    }\n  }, {\n    key: \"currentPage\",\n    get: function get() {\n      return this.pages && this.pages.length >= this.page ? this.pages[this.page] : {\n        components: []\n      };\n    }\n  }, {\n    key: \"getNextPage\",\n    value: function getNextPage() {\n      var _this$pages4;\n      if ((_this$pages4 = this.pages) !== null && _this$pages4 !== void 0 && _this$pages4[this.page]) {\n        var data = this.submission.data;\n        var form = this.pages[this.page].component; // Check conditional nextPage\n\n        if (form) {\n          var page = this.pages.length > this.page + 1 && !this.showAllErrors ? this.page + 1 : -1;\n          if (form.nextPage) {\n            var next = this.evaluate(form.nextPage, {\n              next: page,\n              data: data,\n              page: page,\n              form: form\n            }, 'next');\n            if (next === null) {\n              this.currentNextPage = null;\n              return null;\n            }\n            var pageNum = parseInt(next, 10);\n            if (!isNaN(parseInt(pageNum, 10)) && isFinite(pageNum)) {\n              this.currentNextPage = pageNum;\n              return pageNum;\n            }\n            this.currentNextPage = this.getPageIndexByKey(next);\n            return this.currentNextPage;\n          }\n          this.currentNextPage = page;\n          return page;\n        }\n        this.currentNextPage = null;\n      }\n      return null;\n    }\n  }, {\n    key: \"getPreviousPage\",\n    value: function getPreviousPage() {\n      return this.page - 1;\n    }\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var pages = this.getPages();\n      return _nativePromiseOnly.default.all(pages.map(function (page) {\n        page.options.beforeSubmit = true;\n        return page.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this17 = this;\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        _this17.hook(next ? 'beforeNext' : 'beforePrev', _this17.currentPage, _this17.submission, function (err) {\n          if (err) {\n            _this17.showErrors(err, true);\n            reject(err);\n          }\n          var form = _this17.currentPage;\n          if (form) {\n            form.beforePage(next).then(resolve).catch(reject);\n          } else {\n            resolve();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"emitNextPage\",\n    value: function emitNextPage() {\n      this.emit('nextPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"nextPage\",\n    value: function nextPage() {\n      var _this18 = this;\n\n      // Read-only forms should not worry about validation before going to next page, nor should they submit.\n      if (this.options.readOnly) {\n        return this.beforePage(true).then(function () {\n          return _this18.setPage(_this18.getNextPage()).then(function () {\n            _this18.emitNextPage();\n          });\n        });\n      } // Validate the form, before go to the next page\n\n      if (this.checkValidity(this.localData, true, this.localData, true)) {\n        this.checkData(this.submission.data);\n        return this.beforePage(true).then(function () {\n          return _this18.setPage(_this18.getNextPage()).then(function () {\n            if (!(_this18.options.readOnly || _this18.editMode) && _this18.enabledIndex < _this18.page) {\n              _this18.enabledIndex = _this18.page;\n              _this18.redraw();\n            }\n            _this18.emitNextPage();\n          });\n        });\n      } else {\n        this.currentPage.components.forEach(function (comp) {\n          return comp.setPristine(false);\n        });\n        return _nativePromiseOnly.default.reject(this.showErrors([], true));\n      }\n    }\n  }, {\n    key: \"emitPrevPage\",\n    value: function emitPrevPage() {\n      this.emit('prevPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"prevPage\",\n    value: function prevPage() {\n      var _this19 = this;\n      return this.beforePage().then(function () {\n        return _this19.setPage(_this19.getPreviousPage()).then(function () {\n          _this19.emitPrevPage();\n        });\n      });\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel(noconfirm) {\n      var _this20 = this;\n      if (this.options.readOnly) {\n        return _nativePromiseOnly.default.resolve();\n      }\n      if (_get(_getPrototypeOf(Wizard.prototype), \"cancel\", this).call(this, noconfirm)) {\n        this.setPristine(true);\n        return this.setPage(0).then(function () {\n          if (_this20.enabledIndex) {\n            _this20.enabledIndex = 0;\n          }\n          _this20.onChange();\n          _this20.redraw();\n          return _this20.page;\n        });\n      }\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"getPageIndexByKey\",\n    value: function getPageIndexByKey(key) {\n      var pageIndex = this.page;\n      this.pages.forEach(function (page, index) {\n        if (page.component.key === key) {\n          pageIndex = index;\n          return false;\n        }\n      });\n      return pageIndex;\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.wizard;\n    }\n  }, {\n    key: \"setComponentSchema\",\n    value: function setComponentSchema() {\n      var _this21 = this;\n      var pageKeys = {};\n      this.originalComponents = [];\n      this.component.components.map(function (item) {\n        if (item.type === 'panel') {\n          item.key = (0, _utils.uniqueKey)(pageKeys, item.key || 'panel');\n          pageKeys[item.key] = true;\n          if (_this21.wizard.full) {\n            _this21.options.show = _this21.options.show || {};\n            _this21.options.show[item.key] = true;\n          } else if (_this21.wizard.hasOwnProperty('full') && !_lodash.default.isEqual(_this21.originalOptions.show, _this21.options.show)) {\n            _this21.options.show = _objectSpread({}, _this21.originalOptions.show || {});\n          }\n        }\n        _this21.originalComponents.push(_lodash.default.clone(item));\n      });\n      if (!Object.keys(pageKeys).length) {\n        var newPage = {\n          type: 'panel',\n          title: 'Page 1',\n          label: 'Page 1',\n          key: 'page1',\n          components: this.component.components\n        };\n        this.component.components = [newPage];\n        this.originalComponents.push(_lodash.default.clone(newPage));\n      }\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form, flags) {\n      if (!form) {\n        return;\n      }\n      return _get(_getPrototypeOf(Wizard.prototype), \"setForm\", this).call(this, form, flags);\n    }\n  }, {\n    key: \"onSetForm\",\n    value: function onSetForm(clonedForm, initialForm) {\n      this.component.components = (this._parentPath ? initialForm.components : clonedForm.components) || [];\n      this.setComponentSchema();\n    }\n  }, {\n    key: \"setEditMode\",\n    value: function setEditMode(submission) {\n      if (!this.editMode && submission._id && !this.options.readOnly) {\n        this.editMode = true;\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this22 = this;\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var ignoreEstablishment = arguments.length > 2 ? arguments[2] : undefined;\n      this._submission = submission;\n      if (flags && flags.fromSubmission && (this.options.readOnly || this.editMode) && !this.isHtmlRenderMode()) {\n        this._data = submission.data;\n      }\n      if (!ignoreEstablishment) {\n        this.establishPages(submission.data);\n      }\n      var changed = this.getPages({\n        all: true\n      }).reduce(function (changed, page) {\n        return _this22.setNestedValue(page, submission.data, flags, changed) || changed;\n      }, false);\n      if (changed) {\n        this.pageFieldLogic(this.page);\n      }\n      this.setEditMode(submission);\n      return changed;\n    }\n  }, {\n    key: \"isClickable\",\n    value: function isClickable(page, index) {\n      return this.page !== index && (0, _utils.firstNonNil)([_lodash.default.get(page, 'breadcrumbClickable'), this.options.breadcrumbSettings.clickable]);\n    }\n  }, {\n    key: \"hasButton\",\n    value: function hasButton(name) {\n      var nextPage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getNextPage();\n\n      // get page options with global options as default values\n      var _$get = _lodash.default.get(this.currentPage, 'component.buttonSettings', {}),\n        _$get$previous = _$get.previous,\n        previous = _$get$previous === void 0 ? this.options.buttonSettings.showPrevious : _$get$previous,\n        _$get$cancel = _$get.cancel,\n        cancel = _$get$cancel === void 0 ? this.options.buttonSettings.showCancel : _$get$cancel,\n        _$get$submit = _$get.submit,\n        submit = _$get$submit === void 0 ? this.options.buttonSettings.showSubmit : _$get$submit,\n        _$get$next = _$get.next,\n        next = _$get$next === void 0 ? this.options.buttonSettings.showNext : _$get$next;\n      switch (name) {\n        case 'previous':\n          return previous && this.getPreviousPage() > -1;\n        case 'next':\n          return next && nextPage !== null && nextPage !== -1;\n        case 'cancel':\n          return cancel && !this.options.readOnly;\n        case 'submit':\n          return submit && !this.options.readOnly && (nextPage === null || this.page === this.pages.length - 1);\n        default:\n          return true;\n      }\n    }\n  }, {\n    key: \"pageId\",\n    value: function pageId(page) {\n      if (page.key) {\n        // Some panels have the same key....\n        return \"\".concat(page.key, \"-\").concat(page.title);\n      } else if (page.components && page.components.length > 0) {\n        return this.pageId(page.components[0]);\n      } else {\n        return page.title;\n      }\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, changed, modified, changes) {\n      var _this23 = this;\n      _get(_getPrototypeOf(Wizard.prototype), \"onChange\", this).call(this, flags, changed, modified, changes);\n      if (this.alert && !this.submitted) {\n        this.checkValidity(this.localData, false, this.localData, true);\n        this.showErrors([], true, true);\n      } // If the pages change, need to redraw the header.\n\n      var currentPanels;\n      var panels;\n      var currentNextPage = this.currentNextPage;\n      if (this.hasExtraPages) {\n        currentPanels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n        this.establishPages();\n        panels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n      } else {\n        var _this$currentPanel, _this$currentPanels;\n        currentPanels = this.currentPanels || this.pages.map(function (page) {\n          return page.component.key;\n        });\n        panels = this.establishPages().map(function (panel) {\n          return panel.key;\n        });\n        this.currentPanels = panels;\n        if ((_this$currentPanel = this.currentPanel) !== null && _this$currentPanel !== void 0 && _this$currentPanel.key && (_this$currentPanels = this.currentPanels) !== null && _this$currentPanels !== void 0 && _this$currentPanels.length) {\n          this.setPage(this.currentPanels.findIndex(function (panel) {\n            return panel === _this23.currentPanel.key;\n          }));\n        }\n      }\n      if (!_lodash.default.isEqual(panels, currentPanels) || flags && flags.fromSubmission) {\n        this.redrawHeader();\n      } // If the next page changes, then make sure to redraw navigation.\n\n      if (currentNextPage !== this.getNextPage()) {\n        this.redrawNavigation();\n      }\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      var _this$parent, _this$parent$componen;\n      if ((_this$parent = this.parent) !== null && _this$parent !== void 0 && (_this$parent$componen = _this$parent.component) !== null && _this$parent$componen !== void 0 && _this$parent$componen.modalEdit) {\n        return this.parent.redraw();\n      }\n      return _get(_getPrototypeOf(Wizard.prototype), \"redraw\", this).call(this);\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, currentPageOnly) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n      var components = !currentPageOnly || this.isLastPage() ? this.getComponents() : this.currentPage.components;\n      return components.reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row) && check;\n      }, true);\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      if (!this.isLastPage()) {\n        return this.currentPage.errors;\n      }\n      return _get(_getPrototypeOf(Wizard.prototype), \"errors\", this);\n    }\n  }, {\n    key: \"focusOnComponent\",\n    value: function focusOnComponent(key) {\n      var _this24 = this;\n      var pageIndex = 0;\n      var _this$pages$filter = this.pages.filter(function (page, index) {\n          var hasComponent = false;\n          page.getComponent(key, function (comp) {\n            if (comp.path === key) {\n              pageIndex = index;\n              hasComponent = true;\n            }\n          });\n          return hasComponent;\n        }),\n        _this$pages$filter2 = _slicedToArray(_this$pages$filter, 1),\n        page = _this$pages$filter2[0];\n      if (page && page !== this.currentPage) {\n        return this.setPage(pageIndex).then(function () {\n          _this24.checkValidity(_this24.submission.data, true, _this24.submission.data);\n          _this24.showErrors();\n          _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", _this24).call(_this24, key);\n        });\n      }\n      return _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", this).call(this, key);\n    }\n  }]);\n  return Wizard;\n}(_Webform2.default);\nexports.default = Wizard;\nWizard.setBaseUrl = _Formio.GlobalFormio.setBaseUrl;\nWizard.setApiUrl = _Formio.GlobalFormio.setApiUrl;\nWizard.setAppUrl = _Formio.GlobalFormio.setAppUrl;","map":{"version":3,"names":["_typeof","obj","Symbol","iterator","constructor","prototype","require","Object","defineProperty","exports","value","default","_nativePromiseOnly","_interopRequireDefault","_lodash","_Webform2","_Formio","_utils","__esModule","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","_i","_arr","_n","_d","_s","_e","call","next","done","push","length","err","Array","isArray","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","o","minLen","_arrayLikeToArray","n","toString","slice","name","from","test","iter","len","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_get","Reflect","get","bind","property","receiver","base","_superPropBase","desc","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","Wizard","_Webform","_super","_this","element","options","HTMLElement","display","pages","prefixComps","suffixComps","components","originalComponents","page","currentPanel","currentPanels","currentNextPage","_seenPages","subWizards","allPages","lastPromise","resolve","enabledIndex","editMode","originalOptions","cloneDeep","isLastPage","getNextPage","isNumber","isNull","getPages","_this2","args","undefined","_args$all","all","hasExtraPages","filteredPages","identity","index","includes","isEmpty","set","_this3","_data","each","component","data","componentContext","_this$pages$this$page","_this$pages$this$page2","root","submission","checkConditions","flags","row","visible","establishPages","getComponents","submitting","resetValue","setPristine","init","_this$pages","_this4","buttonSettings","defaults","showPrevious","showNext","showSubmit","showCancel","readOnly","isSecondInit","_this$options","_this$options$breadcr","isClickableDefined","breadcrumbSettings","clickable","allowPrevious","onReady","setComponentSchema","on","subForm","subWizard","find","_subWizard$subForm","id","setValue","_submission","redraw","concat","form","setForm","_this5","buttons","method","button","hasButton","_this$options$propert","_this$options$propert2","_this$options$propert3","defaultButtonOrder","properties","wizardButtonOrder","toLowerCase","split","_this$root","_this$root$component","disableWizardSubmit","wizardKey","isBreadcrumbClickable","isSubForm","parent","type","panels","map","currentPage","buttonOrder","prepareNavigationSettings","ctx","renderTemplate","prepareHeaderSettings","headerType","breadcrumb","render","_this6","renderContext","panel","wizardPageTooltip","getFormattedTooltip","tooltip","wizardNav","wizardHeaderType","wizardHeaderLocation","wizardHeader","className","renderComponents","builderMode","redrawNavigation","navElement","querySelector","_this$loadRefs","detachNav","outerHTML","loadRefs","attachNav","redrawHeader","headerElement","_this$loadRefs2","detachHeader","attachHeader","attach","_this$loadRefs3","_this7","_this$pages2","hook","promises","attachComponents","refs","then","emit","scrollToTop","scrollPageToTop","_this$refs","pageTop","scrollIntoView","_this8","isEqual","isAllowPrevious","_this9","handleNaviageteOnEnter","event","keyCode","clickEvent","CustomEvent","buttonElement","dispatchEvent","handleSaveOnEnter","submit","_this10","navigateOnEnter","addEventListener","document","saveOnEnter","preventDefault","setAttribute","setLoading","removeAttribute","catch","emitWizardPageSelected","_this11","attachTooltips","_this$refs2","link","setPage","_this12","removeEventListener","_this13","transformPages","_this14","allComponents","getSortedComponents","defferedComponents","getAllComponents","nestedComp","compsArr","pushAllowed","nestedPages","dataArrayComponents","currentComponents","visibleComponents","comp","_visible","filteredComponents","isNestedWizard","additionalComponents","_comp$subForm","_form","hasNested","eachComponent","wizard","setRootPanelId","hasNestedForm","newComp","clone","localRoot","_ref","currentPages","title","item","findRootPanel","_component$parent","_component$parent2","rootPanelId","_this15","pageOptions","forceShow","show","forceHide","hide","isVisible","checkCondition","hidden","createComponent","updatePages","addComponents","num","_this16","pageFieldLogic","parentNum","pageFromPages","pageFromComponents","findIndex","_this16$pages","_this16$pages$parentN","checkData","reject","_this$pages3","originalComponent","fastCloneDeep","fieldLogic","disabled","shouldDisabled","_this$pages4","showAllErrors","nextPage","evaluate","pageNum","parseInt","isNaN","isFinite","getPageIndexByKey","getPreviousPage","beforeSubmit","beforePage","_this17","showErrors","emitNextPage","_this18","checkValidity","localData","emitPrevPage","prevPage","_this19","cancel","noconfirm","_this20","onChange","pageIndex","_this21","pageKeys","uniqueKey","full","newPage","label","onSetForm","clonedForm","initialForm","_parentPath","setEditMode","_id","_this22","ignoreEstablishment","fromSubmission","isHtmlRenderMode","changed","reduce","setNestedValue","isClickable","firstNonNil","_$get","_$get$previous","previous","_$get$cancel","_$get$submit","_$get$next","pageId","modified","changes","_this23","alert","submitted","_this$currentPanel","_this$currentPanels","_this$parent","_this$parent$componen","modalEdit","dirty","currentPageOnly","setCustomValidity","check","errors","focusOnComponent","_this24","_this$pages$filter","hasComponent","getComponent","path","_this$pages$filter2","setBaseUrl","GlobalFormio","setApiUrl","setAppUrl"],"sources":["D:/task/node_modules/formiojs/Wizard.js"],"sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nrequire(\"core-js/modules/es.reflect.construct.js\");\n\nrequire(\"core-js/modules/es.reflect.get.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.array.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nrequire(\"core-js/modules/es.array.from.js\");\n\nrequire(\"core-js/modules/es.array.slice.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nrequire(\"core-js/modules/es.string.includes.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.array.find.js\");\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nrequire(\"core-js/modules/es.string.split.js\");\n\nrequire(\"core-js/modules/es.array.map.js\");\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nrequire(\"core-js/modules/es.array.find-index.js\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of.js\");\n\nvar _nativePromiseOnly = _interopRequireDefault(require(\"native-promise-only\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Webform2 = _interopRequireDefault(require(\"./Webform\"));\n\nvar _Formio = require(\"./Formio\");\n\nvar _utils = require(\"./utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get.bind(); } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar Wizard = /*#__PURE__*/function (_Webform) {\n  _inherits(Wizard, _Webform);\n\n  var _super = _createSuper(Wizard);\n\n  /**\n   * Constructor for wizard based forms\n   * @param element Dom element to place this wizard.\n   * @param {Object} options Options object, supported options are:\n   *    - breadcrumbSettings.clickable: true (default) determines if the breadcrumb bar is clickable or not\n   *    - buttonSettings.show*(Previous, Next, Cancel): true (default) determines if the button is shown or not\n   *    - allowPrevious: false (default) determines if the breadcrumb bar is clickable or not for visited tabs\n   */\n  function Wizard() {\n    var _this;\n\n    _classCallCheck(this, Wizard);\n\n    var element, options;\n\n    if (arguments[0] instanceof HTMLElement || arguments[1]) {\n      element = arguments[0];\n      options = arguments[1] || {};\n    } else {\n      options = arguments[0] || {};\n    }\n\n    options.display = 'wizard';\n    _this = _super.call(this, element, options);\n    _this.pages = [];\n    _this.prefixComps = [];\n    _this.suffixComps = [];\n    _this.components = [];\n    _this.originalComponents = [];\n    _this.page = 0;\n    _this.currentPanel = null;\n    _this.currentPanels = null;\n    _this.currentNextPage = 0;\n    _this._seenPages = [0];\n    _this.subWizards = [];\n    _this.allPages = [];\n    _this.lastPromise = _nativePromiseOnly.default.resolve();\n    _this.enabledIndex = 0;\n    _this.editMode = false;\n    _this.originalOptions = _lodash.default.cloneDeep(_this.options);\n    return _this;\n  }\n\n  _createClass(Wizard, [{\n    key: \"isLastPage\",\n    value: function isLastPage() {\n      var next = this.getNextPage();\n\n      if (_lodash.default.isNumber(next)) {\n        return next === -1;\n      }\n\n      return _lodash.default.isNull(next);\n    }\n  }, {\n    key: \"getPages\",\n    value: function getPages() {\n      var _this2 = this;\n\n      var args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _args$all = args.all,\n          all = _args$all === void 0 ? false : _args$all;\n      var pages = this.hasExtraPages ? this.components : this.pages;\n      var filteredPages = pages.filter(all ? _lodash.default.identity : function (p, index) {\n        return _this2._seenPages.includes(index);\n      });\n      return filteredPages;\n    }\n  }, {\n    key: \"hasExtraPages\",\n    get: function get() {\n      return !_lodash.default.isEmpty(this.subWizards);\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      return _get(_getPrototypeOf(Wizard.prototype), \"data\", this);\n    },\n    set: function set(value) {\n      var _this3 = this;\n\n      this._data = value;\n\n      _lodash.default.each(this.getPages({\n        all: true\n      }), function (component) {\n        component.data = _this3.componentContext(component);\n      });\n    }\n  }, {\n    key: \"localData\",\n    get: function get() {\n      var _this$pages$this$page, _this$pages$this$page2;\n\n      return ((_this$pages$this$page = this.pages[this.page]) === null || _this$pages$this$page === void 0 ? void 0 : (_this$pages$this$page2 = _this$pages$this$page.root) === null || _this$pages$this$page2 === void 0 ? void 0 : _this$pages$this$page2.submission.data) || this.submission.data;\n    }\n  }, {\n    key: \"checkConditions\",\n    value: function checkConditions(data, flags, row) {\n      var visible = _get(_getPrototypeOf(Wizard.prototype), \"checkConditions\", this).call(this, data, flags, row);\n\n      this.establishPages(data);\n      return visible;\n    }\n  }, {\n    key: \"getComponents\",\n    value: function getComponents() {\n      return this.submitting ? this.getPages({\n        all: this.isLastPage()\n      }) : _get(_getPrototypeOf(Wizard.prototype), \"getComponents\", this).call(this);\n    }\n  }, {\n    key: \"resetValue\",\n    value: function resetValue() {\n      this.getPages({\n        all: true\n      }).forEach(function (page) {\n        return page.resetValue();\n      });\n      this.setPristine(true);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this$pages,\n          _this4 = this;\n\n      // Check for and initlize button settings object\n      this.options.buttonSettings = _lodash.default.defaults(this.options.buttonSettings, {\n        showPrevious: true,\n        showNext: true,\n        showSubmit: true,\n        showCancel: !this.options.readOnly\n      });\n\n      if (!this.isSecondInit) {\n        var _this$options, _this$options$breadcr;\n\n        this.isClickableDefined = (_this$options = this.options) === null || _this$options === void 0 ? void 0 : (_this$options$breadcr = _this$options.breadcrumbSettings) === null || _this$options$breadcr === void 0 ? void 0 : _this$options$breadcr.hasOwnProperty('clickable');\n        this.isSecondInit = true;\n      }\n\n      this.options.breadcrumbSettings = _lodash.default.defaults(this.options.breadcrumbSettings, {\n        clickable: true\n      });\n      this.options.allowPrevious = this.options.allowPrevious || false;\n      this.page = 0;\n\n      var onReady = _get(_getPrototypeOf(Wizard.prototype), \"init\", this).call(this);\n\n      this.setComponentSchema();\n\n      if ((_this$pages = this.pages) !== null && _this$pages !== void 0 && _this$pages[this.page]) {\n        this.component = this.pages[this.page].component;\n      }\n\n      this.on('subWizardsUpdated', function (subForm) {\n        var subWizard = _this4.subWizards.find(function (subWizard) {\n          var _subWizard$subForm;\n\n          return (subForm === null || subForm === void 0 ? void 0 : subForm.id) && ((_subWizard$subForm = subWizard.subForm) === null || _subWizard$subForm === void 0 ? void 0 : _subWizard$subForm.id) === (subForm === null || subForm === void 0 ? void 0 : subForm.id);\n        });\n\n        if (_this4.subWizards.length && subWizard) {\n          subWizard.subForm.setValue(subForm._submission, {}, true);\n\n          _this4.establishPages();\n\n          _this4.redraw();\n        }\n      });\n      return onReady;\n    }\n  }, {\n    key: \"wizardKey\",\n    get: function get() {\n      return \"wizard-\".concat(this.id);\n    }\n  }, {\n    key: \"wizard\",\n    get: function get() {\n      return this.form;\n    },\n    set: function set(form) {\n      this.setForm(form);\n    }\n  }, {\n    key: \"buttons\",\n    get: function get() {\n      var _this5 = this;\n\n      var buttons = {};\n      [{\n        name: 'cancel',\n        method: 'cancel'\n      }, {\n        name: 'previous',\n        method: 'prevPage'\n      }, {\n        name: 'next',\n        method: 'nextPage'\n      }, {\n        name: 'submit',\n        method: 'submit'\n      }].forEach(function (button) {\n        if (_this5.hasButton(button.name)) {\n          buttons[button.name] = button;\n        }\n      });\n      return buttons;\n    }\n  }, {\n    key: \"buttonOrder\",\n    get: function get() {\n      var _this$options$propert, _this$options$propert2, _this$options$propert3;\n\n      var defaultButtonOrder = ['cancel', 'previous', 'next', 'submit'];\n      return (_this$options$propert = (_this$options$propert2 = this.options.properties) === null || _this$options$propert2 === void 0 ? void 0 : (_this$options$propert3 = _this$options$propert2.wizardButtonOrder) === null || _this$options$propert3 === void 0 ? void 0 : _this$options$propert3.toLowerCase().split(', ')) !== null && _this$options$propert !== void 0 ? _this$options$propert : defaultButtonOrder;\n    }\n  }, {\n    key: \"renderContext\",\n    get: function get() {\n      var _this$root, _this$root$component;\n\n      return {\n        disableWizardSubmit: this.form.disableWizardSubmit,\n        wizardKey: this.wizardKey,\n        isBreadcrumbClickable: this.isBreadcrumbClickable(),\n        isSubForm: !!this.parent && !((_this$root = this.root) !== null && _this$root !== void 0 && (_this$root$component = _this$root.component) !== null && _this$root$component !== void 0 && _this$root$component.type) === 'wizard',\n        panels: this.allPages.length ? this.allPages.map(function (page) {\n          return page.component;\n        }) : this.pages.map(function (page) {\n          return page.component;\n        }),\n        buttons: this.buttons,\n        currentPage: this.page,\n        buttonOrder: this.buttonOrder\n      };\n    }\n  }, {\n    key: \"prepareNavigationSettings\",\n    value: function prepareNavigationSettings(ctx) {\n      var currentPanel = this.currentPanel;\n\n      if (currentPanel && currentPanel.buttonSettings) {\n        Object.keys(currentPanel.buttonSettings).forEach(function () {\n          Object.keys(ctx.buttons).forEach(function (key) {\n            if (typeof currentPanel.buttonSettings[key] !== 'undefined' && !currentPanel.buttonSettings[key] || ctx.isSubForm) {\n              ctx.buttons[key] = null;\n            }\n          });\n        });\n      }\n\n      return this.renderTemplate('wizardNav', ctx);\n    }\n  }, {\n    key: \"prepareHeaderSettings\",\n    value: function prepareHeaderSettings(ctx, headerType) {\n      if (this.currentPanel && this.currentPanel.breadcrumb === 'none' || ctx.isSubForm) {\n        return null;\n      }\n\n      return this.renderTemplate(headerType, ctx);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var ctx = this.renderContext;\n\n      if (this.component.key) {\n        ctx.panels.map(function (panel) {\n          if (panel.key === _this6.component.key) {\n            _this6.currentPanel = panel;\n            ctx.wizardPageTooltip = _this6.getFormattedTooltip(panel.tooltip);\n          }\n        });\n      }\n\n      var wizardNav = this.prepareNavigationSettings(ctx);\n      var wizardHeaderType = \"wizardHeader\".concat(_lodash.default.get(this.form, 'settings.wizardHeaderType', ''));\n\n      var wizardHeaderLocation = _lodash.default.get(this.form, 'settings.wizardHeaderLocation', 'left');\n\n      var wizardHeader = this.prepareHeaderSettings(ctx, wizardHeaderType);\n      return this.renderTemplate('wizard', _objectSpread(_objectSpread({}, ctx), {}, {\n        className: _get(_getPrototypeOf(Wizard.prototype), \"getClassName\", this).call(this),\n        wizardHeader: wizardHeader,\n        wizardHeaderType: wizardHeaderType,\n        wizardHeaderLocation: wizardHeaderLocation,\n        wizardNav: wizardNav,\n        components: this.renderComponents([].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)))\n      }), this.builderMode ? 'builder' : 'form');\n    }\n  }, {\n    key: \"redrawNavigation\",\n    value: function redrawNavigation() {\n      if (this.element) {\n        var navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n\n        if (navElement) {\n          var _this$loadRefs;\n\n          this.detachNav();\n          navElement.outerHTML = this.renderTemplate('wizardNav', this.renderContext);\n          navElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-nav\"));\n          this.loadRefs(navElement, (_this$loadRefs = {}, _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _this$loadRefs));\n          this.attachNav();\n        }\n      }\n    }\n  }, {\n    key: \"redrawHeader\",\n    value: function redrawHeader() {\n      if (this.element) {\n        var headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n\n        if (headerElement) {\n          var _this$loadRefs2;\n\n          this.detachHeader();\n          headerElement.outerHTML = this.renderTemplate(\"wizardHeader\".concat(_lodash.default.get(this.form, 'settings.wizardHeaderType', '')), this.renderContext);\n          headerElement = this.element.querySelector(\"#\".concat(this.wizardKey, \"-header\"));\n          this.loadRefs(headerElement, (_this$loadRefs2 = {}, _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs2, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs2));\n          this.attachHeader();\n        }\n      }\n    }\n  }, {\n    key: \"attach\",\n    value: function attach(element) {\n      var _this$loadRefs3,\n          _this7 = this;\n\n      this.element = element;\n      this.loadRefs(element, (_this$loadRefs3 = {}, _defineProperty(_this$loadRefs3, this.wizardKey, 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-header\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-cancel\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-previous\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-next\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-submit\"), 'single'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-link\"), 'multiple'), _defineProperty(_this$loadRefs3, \"\".concat(this.wizardKey, \"-tooltip\"), 'multiple'), _this$loadRefs3));\n\n      if ((this.options.readOnly || this.editMode) && !this.enabledIndex) {\n        var _this$pages2;\n\n        this.enabledIndex = ((_this$pages2 = this.pages) === null || _this$pages2 === void 0 ? void 0 : _this$pages2.length) - 1;\n      }\n\n      this.hook('attachWebform', element, this);\n      var promises = this.attachComponents(this.refs[this.wizardKey], [].concat(_toConsumableArray(this.prefixComps), _toConsumableArray(this.currentPage.components), _toConsumableArray(this.suffixComps)));\n      this.attachNav();\n      this.attachHeader();\n      return promises.then(function () {\n        _this7.emit('render', {\n          component: _this7.currentPage,\n          page: _this7.page\n        });\n\n        if (_this7.component.scrollToTop) {\n          _this7.scrollPageToTop();\n        }\n      });\n    }\n  }, {\n    key: \"scrollPageToTop\",\n    value: function scrollPageToTop() {\n      var _this$refs;\n\n      var pageTop = (_this$refs = this.refs[\"\".concat(this.wizardKey, \"-header\")]) !== null && _this$refs !== void 0 ? _this$refs : this.refs[this.wizardKey];\n\n      if (!pageTop) {\n        return;\n      }\n\n      if ('scrollIntoView' in pageTop) {\n        pageTop.scrollIntoView(true);\n      } else {\n        this.scrollIntoView(pageTop);\n      }\n    }\n  }, {\n    key: \"isBreadcrumbClickable\",\n    value: function isBreadcrumbClickable() {\n      var _this8 = this;\n\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this8.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return this.isClickableDefined ? this.options.breadcrumbSettings.clickable : _lodash.default.get(currentPage, 'component.breadcrumbClickable', true);\n    }\n  }, {\n    key: \"isAllowPrevious\",\n    value: function isAllowPrevious() {\n      var _this9 = this;\n\n      var currentPage = null;\n      this.pages.map(function (page) {\n        if (_lodash.default.isEqual(_this9.currentPage.component, page.component)) {\n          currentPage = page;\n        }\n      });\n      return _lodash.default.get(currentPage.component, 'allowPrevious', this.options.allowPrevious);\n    }\n  }, {\n    key: \"handleNaviageteOnEnter\",\n    value: function handleNaviageteOnEnter(event) {\n      if (event.keyCode === 13) {\n        var clickEvent = new CustomEvent('click');\n        var buttonElement = this.refs[\"\".concat(this.wizardKey, \"-\").concat(this.buttons.next.name)];\n\n        if (buttonElement) {\n          buttonElement.dispatchEvent(clickEvent);\n        }\n      }\n    }\n  }, {\n    key: \"handleSaveOnEnter\",\n    value: function handleSaveOnEnter(event) {\n      if (event.keyCode === 13) {\n        var clickEvent = new CustomEvent('click');\n        var buttonElement = this.refs[\"\".concat(this.wizardKey, \"-\").concat(this.buttons.submit.name)];\n\n        if (buttonElement) {\n          buttonElement.dispatchEvent(clickEvent);\n        }\n      }\n    }\n  }, {\n    key: \"attachNav\",\n    value: function attachNav() {\n      var _this10 = this;\n\n      if (this.component.navigateOnEnter) {\n        this.addEventListener(document, 'keyup', this.handleNaviageteOnEnter.bind(this));\n      }\n\n      if (this.component.saveOnEnter) {\n        this.addEventListener(document, 'keyup', this.handleSaveOnEnter.bind(this));\n      }\n\n      _lodash.default.each(this.buttons, function (button) {\n        var buttonElement = _this10.refs[\"\".concat(_this10.wizardKey, \"-\").concat(button.name)];\n\n        _this10.addEventListener(buttonElement, 'click', function (event) {\n          event.preventDefault(); // Disable the button until done.\n\n          buttonElement.setAttribute('disabled', 'disabled');\n\n          _this10.setLoading(buttonElement, true); // Call the button method, then re-enable the button.\n\n\n          _this10[button.method]().then(function () {\n            buttonElement.removeAttribute('disabled');\n\n            _this10.setLoading(buttonElement, false);\n          }).catch(function () {\n            buttonElement.removeAttribute('disabled');\n\n            _this10.setLoading(buttonElement, false);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"emitWizardPageSelected\",\n    value: function emitWizardPageSelected(index) {\n      this.emit('wizardPageSelected', this.pages[index], index);\n    }\n  }, {\n    key: \"attachHeader\",\n    value: function attachHeader() {\n      var _this11 = this;\n\n      var isAllowPrevious = this.isAllowPrevious();\n      this.attachTooltips(this.refs[\"\".concat(this.wizardKey, \"-tooltip\")], this.currentPanel.tooltip);\n\n      if (this.isBreadcrumbClickable() || isAllowPrevious) {\n        var _this$refs2;\n\n        (_this$refs2 = this.refs[\"\".concat(this.wizardKey, \"-link\")]) === null || _this$refs2 === void 0 ? void 0 : _this$refs2.forEach(function (link, index) {\n          if (!isAllowPrevious || index <= _this11.enabledIndex) {\n            _this11.addEventListener(link, 'click', function (event) {\n              _this11.emit('wizardNavigationClicked', _this11.pages[index]);\n\n              event.preventDefault();\n              return _this11.setPage(index).then(function () {\n                _this11.emitWizardPageSelected(index);\n              });\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"detachNav\",\n    value: function detachNav() {\n      var _this12 = this;\n\n      if (this.component.navigateOnEnter) {\n        this.removeEventListener(document, 'keyup', this.handleNaviageteOnEnter.bind(this));\n      }\n\n      if (this.component.saveOnEnter) {\n        this.removeEventListener(document, 'keyup', this.handleSaveOnEnter.bind(this));\n      }\n\n      _lodash.default.each(this.buttons, function (button) {\n        _this12.removeEventListener(_this12.refs[\"\".concat(_this12.wizardKey, \"-\").concat(button.name)], 'click');\n      });\n    }\n  }, {\n    key: \"detachHeader\",\n    value: function detachHeader() {\n      var _this13 = this;\n\n      if (this.refs[\"\".concat(this.wizardKey, \"-link\")]) {\n        this.refs[\"\".concat(this.wizardKey, \"-link\")].forEach(function (link) {\n          _this13.removeEventListener(link, 'click');\n        });\n      }\n    }\n  }, {\n    key: \"transformPages\",\n    value: function transformPages() {\n      var _this14 = this;\n\n      var allComponents = [];\n      var components = this.getSortedComponents(this);\n      var defferedComponents = [];\n      this.allPages = []; // Get all components including all nested components and line up in the correct order\n\n      var getAllComponents = function getAllComponents(nestedComp, compsArr) {\n        var pushAllowed = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n        var nestedPages = [];\n        var dataArrayComponents = ['datagrid', 'editgrid', 'dynamicWizard'];\n        var currentComponents = nestedComp !== null && nestedComp !== void 0 && nestedComp.subForm ? _this14.getSortedComponents(nestedComp.subForm) : (nestedComp === null || nestedComp === void 0 ? void 0 : nestedComp.components) || [];\n        var visibleComponents = currentComponents.filter(function (comp) {\n          return comp._visible;\n        });\n        var filteredComponents = visibleComponents.filter(function (comp) {\n          return !dataArrayComponents.includes(comp.component.type) && (comp.type !== 'form' || comp.isNestedWizard);\n        });\n        var additionalComponents = currentComponents.filter(function (comp) {\n          var _comp$subForm;\n\n          return ((_comp$subForm = comp.subForm) === null || _comp$subForm === void 0 ? void 0 : _comp$subForm._form.display) !== 'wizard';\n        });\n        var hasNested = false;\n        (0, _utils.eachComponent)(filteredComponents, function (comp) {\n          if (comp && comp.component) {\n            if (comp.component.type === 'panel' && comp !== null && comp !== void 0 && comp.parent.wizard && !getAllComponents(comp, compsArr, false)) {\n              if (pushAllowed) {\n                _this14.setRootPanelId(comp);\n\n                nestedPages.push(comp);\n              }\n\n              hasNested = true;\n            }\n\n            if (comp.isNestedWizard && comp.subForm) {\n              var hasNestedForm = getAllComponents(comp, nestedPages, pushAllowed);\n\n              if (!hasNested) {\n                hasNested = hasNestedForm;\n              }\n            }\n          }\n        }, true);\n\n        if (nestedComp.component.type === 'panel') {\n          if (!hasNested && pushAllowed) {\n            _this14.setRootPanelId(nestedComp);\n\n            compsArr.push(nestedComp);\n          }\n\n          if (hasNested && additionalComponents.length) {\n            var newComp = _lodash.default.clone(nestedComp);\n\n            newComp.components = additionalComponents;\n\n            _this14.setRootPanelId(newComp);\n\n            defferedComponents.push(newComp);\n          }\n        }\n\n        if (pushAllowed) {\n          compsArr.push.apply(compsArr, _toConsumableArray(defferedComponents).concat(nestedPages));\n          defferedComponents = [];\n        }\n\n        return hasNested;\n      };\n\n      components.forEach(function (component) {\n        if (component.visible) {\n          getAllComponents(component, allComponents);\n        }\n      }, []); // recalculate pages only for root wizards, including the situation when the wizard is in a wrapper\n\n      if (this.localRoot && this.id === this.localRoot.id) {\n        allComponents.forEach(function (comp, index) {\n          comp.eachComponent(function (component) {\n            component.page = index;\n          });\n        });\n      }\n\n      this.allPages = allComponents;\n    }\n  }, {\n    key: \"getSortedComponents\",\n    value: function getSortedComponents(_ref) {\n      var components = _ref.components,\n          originalComponents = _ref.originalComponents;\n      // sorts components if they were shuffled after the conditional logic\n      var currentComponents = [];\n      var currentPages = [];\n\n      if (components && components.length) {\n        components.map(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n\n      originalComponents === null || originalComponents === void 0 ? void 0 : originalComponents.forEach(function (item) {\n        if (!item.key) {\n          item.key = item.title;\n        }\n\n        if (currentPages[item.key]) {\n          currentComponents.push(currentPages[item.key]);\n        }\n      });\n      return currentComponents;\n    }\n  }, {\n    key: \"findRootPanel\",\n    value: function findRootPanel(component) {\n      var _component$parent;\n\n      return (_component$parent = component.parent) !== null && _component$parent !== void 0 && _component$parent.parent ? this.findRootPanel(component.parent) : component;\n    }\n  }, {\n    key: \"setRootPanelId\",\n    value: function setRootPanelId(component) {\n      var _component$parent2;\n\n      if (component.rootPanelId && component.rootPanelId !== component.id) {\n        return;\n      }\n\n      var parent = (_component$parent2 = component.parent) !== null && _component$parent2 !== void 0 && _component$parent2.parent ? this.findRootPanel(component.parent) : component;\n      component.rootPanelId = parent.id;\n    }\n  }, {\n    key: \"establishPages\",\n    value: function establishPages() {\n      var _this15 = this;\n\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.data;\n      this.pages = [];\n      this.prefixComps = [];\n      this.suffixComps = [];\n      var visible = [];\n      var currentPages = {};\n\n      var pageOptions = _objectSpread(_objectSpread({}, _lodash.default.clone(this.options)), this.parent ? {\n        root: this\n      } : {});\n\n      if (this.components && this.components.length) {\n        this.components.forEach(function (page) {\n          if (page.component.type === 'panel') {\n            currentPages[page.component.key || page.component.title] = page;\n          }\n        });\n      }\n\n      if (this.originalComponents) {\n        this.originalComponents.forEach(function (item) {\n          if (item.type === 'panel') {\n            if (!item.key) {\n              item.key = item.title;\n            }\n\n            var page = currentPages[item.key];\n            var forceShow = _this15.options.show ? _this15.options.show[item.key] : false;\n            var forceHide = _this15.options.hide ? _this15.options.hide[item.key] : false;\n            var isVisible = !page ? (0, _utils.checkCondition)(item, data, data, _this15.component, _this15) && !item.hidden : page.visible;\n\n            if (forceShow) {\n              isVisible = true;\n            } else if (forceHide) {\n              isVisible = false;\n            }\n\n            if (isVisible) {\n              visible.push(item);\n\n              if (page) {\n                _this15.pages.push(page);\n              }\n            }\n\n            if (!page && isVisible) {\n              page = _this15.createComponent(item, pageOptions);\n              page.visible = isVisible;\n\n              _this15.pages.push(page);\n\n              page.eachComponent(function (component) {\n                component.page = _this15.pages.length - 1;\n              });\n            }\n          } else if (item.type !== 'button') {\n            if (!_this15.pages.length) {\n              _this15.prefixComps.push(_this15.createComponent(item, pageOptions));\n            } else {\n              _this15.suffixComps.push(_this15.createComponent(item, pageOptions));\n            }\n          }\n        });\n      }\n\n      if (this.pages.length) {\n        this.emit('pagesChanged');\n      }\n\n      this.transformPages();\n\n      if (this.allPages && this.allPages.length) {\n        this.updatePages();\n      }\n\n      return visible;\n    }\n  }, {\n    key: \"updatePages\",\n    value: function updatePages() {\n      this.pages = this.allPages;\n    }\n  }, {\n    key: \"addComponents\",\n    value: function addComponents() {\n      this.establishPages();\n    }\n  }, {\n    key: \"setPage\",\n    value: function setPage(num) {\n      var _this16 = this;\n\n      if (num === this.page) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (num >= 0 && num < this.pages.length) {\n        this.page = num;\n        this.pageFieldLogic(num);\n        this.getNextPage();\n        var parentNum = num;\n\n        if (this.hasExtraPages) {\n          var pageFromPages = this.pages[num];\n          var pageFromComponents = this.components[num];\n\n          if (!pageFromComponents || (pageFromPages === null || pageFromPages === void 0 ? void 0 : pageFromPages.id) !== pageFromComponents.id) {\n            parentNum = this.components.findIndex(function (comp) {\n              var _this16$pages, _this16$pages$parentN;\n\n              return comp.id === ((_this16$pages = _this16.pages) === null || _this16$pages === void 0 ? void 0 : (_this16$pages$parentN = _this16$pages[parentNum]) === null || _this16$pages$parentN === void 0 ? void 0 : _this16$pages$parentN.rootPanelId);\n            });\n          }\n        }\n\n        if (!this._seenPages.includes(parentNum)) {\n          this._seenPages = this._seenPages.concat(parentNum);\n        }\n\n        this.redraw().then(function () {\n          _this16.checkData(_this16.submission.data);\n        });\n        return _nativePromiseOnly.default.resolve();\n      } else if (!this.pages.length) {\n        this.redraw();\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      return _nativePromiseOnly.default.reject('Page not found');\n    }\n  }, {\n    key: \"pageFieldLogic\",\n    value: function pageFieldLogic(page) {\n      var _this$pages3;\n\n      if ((_this$pages3 = this.pages) !== null && _this$pages3 !== void 0 && _this$pages3[page]) {\n        // Handle field logic on pages.\n        this.component = this.pages[page].component;\n        this.originalComponent = (0, _utils.fastCloneDeep)(this.component);\n        this.fieldLogic(this.data); // If disabled changed, be sure to distribute the setting.\n\n        this.disabled = this.shouldDisabled;\n      }\n    }\n  }, {\n    key: \"currentPage\",\n    get: function get() {\n      return this.pages && this.pages.length >= this.page ? this.pages[this.page] : {\n        components: []\n      };\n    }\n  }, {\n    key: \"getNextPage\",\n    value: function getNextPage() {\n      var _this$pages4;\n\n      if ((_this$pages4 = this.pages) !== null && _this$pages4 !== void 0 && _this$pages4[this.page]) {\n        var data = this.submission.data;\n        var form = this.pages[this.page].component; // Check conditional nextPage\n\n        if (form) {\n          var page = this.pages.length > this.page + 1 && !this.showAllErrors ? this.page + 1 : -1;\n\n          if (form.nextPage) {\n            var next = this.evaluate(form.nextPage, {\n              next: page,\n              data: data,\n              page: page,\n              form: form\n            }, 'next');\n\n            if (next === null) {\n              this.currentNextPage = null;\n              return null;\n            }\n\n            var pageNum = parseInt(next, 10);\n\n            if (!isNaN(parseInt(pageNum, 10)) && isFinite(pageNum)) {\n              this.currentNextPage = pageNum;\n              return pageNum;\n            }\n\n            this.currentNextPage = this.getPageIndexByKey(next);\n            return this.currentNextPage;\n          }\n\n          this.currentNextPage = page;\n          return page;\n        }\n\n        this.currentNextPage = null;\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getPreviousPage\",\n    value: function getPreviousPage() {\n      return this.page - 1;\n    }\n  }, {\n    key: \"beforeSubmit\",\n    value: function beforeSubmit() {\n      var pages = this.getPages();\n      return _nativePromiseOnly.default.all(pages.map(function (page) {\n        page.options.beforeSubmit = true;\n        return page.beforeSubmit();\n      }));\n    }\n  }, {\n    key: \"beforePage\",\n    value: function beforePage(next) {\n      var _this17 = this;\n\n      return new _nativePromiseOnly.default(function (resolve, reject) {\n        _this17.hook(next ? 'beforeNext' : 'beforePrev', _this17.currentPage, _this17.submission, function (err) {\n          if (err) {\n            _this17.showErrors(err, true);\n\n            reject(err);\n          }\n\n          var form = _this17.currentPage;\n\n          if (form) {\n            form.beforePage(next).then(resolve).catch(reject);\n          } else {\n            resolve();\n          }\n        });\n      });\n    }\n  }, {\n    key: \"emitNextPage\",\n    value: function emitNextPage() {\n      this.emit('nextPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"nextPage\",\n    value: function nextPage() {\n      var _this18 = this;\n\n      // Read-only forms should not worry about validation before going to next page, nor should they submit.\n      if (this.options.readOnly) {\n        return this.beforePage(true).then(function () {\n          return _this18.setPage(_this18.getNextPage()).then(function () {\n            _this18.emitNextPage();\n          });\n        });\n      } // Validate the form, before go to the next page\n\n\n      if (this.checkValidity(this.localData, true, this.localData, true)) {\n        this.checkData(this.submission.data);\n        return this.beforePage(true).then(function () {\n          return _this18.setPage(_this18.getNextPage()).then(function () {\n            if (!(_this18.options.readOnly || _this18.editMode) && _this18.enabledIndex < _this18.page) {\n              _this18.enabledIndex = _this18.page;\n\n              _this18.redraw();\n            }\n\n            _this18.emitNextPage();\n          });\n        });\n      } else {\n        this.currentPage.components.forEach(function (comp) {\n          return comp.setPristine(false);\n        });\n        return _nativePromiseOnly.default.reject(this.showErrors([], true));\n      }\n    }\n  }, {\n    key: \"emitPrevPage\",\n    value: function emitPrevPage() {\n      this.emit('prevPage', {\n        page: this.page,\n        submission: this.submission\n      });\n    }\n  }, {\n    key: \"prevPage\",\n    value: function prevPage() {\n      var _this19 = this;\n\n      return this.beforePage().then(function () {\n        return _this19.setPage(_this19.getPreviousPage()).then(function () {\n          _this19.emitPrevPage();\n        });\n      });\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel(noconfirm) {\n      var _this20 = this;\n\n      if (this.options.readOnly) {\n        return _nativePromiseOnly.default.resolve();\n      }\n\n      if (_get(_getPrototypeOf(Wizard.prototype), \"cancel\", this).call(this, noconfirm)) {\n        this.setPristine(true);\n        return this.setPage(0).then(function () {\n          if (_this20.enabledIndex) {\n            _this20.enabledIndex = 0;\n          }\n\n          _this20.onChange();\n\n          _this20.redraw();\n\n          return _this20.page;\n        });\n      }\n\n      return _nativePromiseOnly.default.resolve();\n    }\n  }, {\n    key: \"getPageIndexByKey\",\n    value: function getPageIndexByKey(key) {\n      var pageIndex = this.page;\n      this.pages.forEach(function (page, index) {\n        if (page.component.key === key) {\n          pageIndex = index;\n          return false;\n        }\n      });\n      return pageIndex;\n    }\n  }, {\n    key: \"schema\",\n    get: function get() {\n      return this.wizard;\n    }\n  }, {\n    key: \"setComponentSchema\",\n    value: function setComponentSchema() {\n      var _this21 = this;\n\n      var pageKeys = {};\n      this.originalComponents = [];\n      this.component.components.map(function (item) {\n        if (item.type === 'panel') {\n          item.key = (0, _utils.uniqueKey)(pageKeys, item.key || 'panel');\n          pageKeys[item.key] = true;\n\n          if (_this21.wizard.full) {\n            _this21.options.show = _this21.options.show || {};\n            _this21.options.show[item.key] = true;\n          } else if (_this21.wizard.hasOwnProperty('full') && !_lodash.default.isEqual(_this21.originalOptions.show, _this21.options.show)) {\n            _this21.options.show = _objectSpread({}, _this21.originalOptions.show || {});\n          }\n        }\n\n        _this21.originalComponents.push(_lodash.default.clone(item));\n      });\n\n      if (!Object.keys(pageKeys).length) {\n        var newPage = {\n          type: 'panel',\n          title: 'Page 1',\n          label: 'Page 1',\n          key: 'page1',\n          components: this.component.components\n        };\n        this.component.components = [newPage];\n        this.originalComponents.push(_lodash.default.clone(newPage));\n      }\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form, flags) {\n      if (!form) {\n        return;\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"setForm\", this).call(this, form, flags);\n    }\n  }, {\n    key: \"onSetForm\",\n    value: function onSetForm(clonedForm, initialForm) {\n      this.component.components = (this._parentPath ? initialForm.components : clonedForm.components) || [];\n      this.setComponentSchema();\n    }\n  }, {\n    key: \"setEditMode\",\n    value: function setEditMode(submission) {\n      if (!this.editMode && submission._id && !this.options.readOnly) {\n        this.editMode = true;\n        this.redraw();\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(submission) {\n      var _this22 = this;\n\n      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var ignoreEstablishment = arguments.length > 2 ? arguments[2] : undefined;\n      this._submission = submission;\n\n      if (flags && flags.fromSubmission && (this.options.readOnly || this.editMode) && !this.isHtmlRenderMode()) {\n        this._data = submission.data;\n      }\n\n      if (!ignoreEstablishment) {\n        this.establishPages(submission.data);\n      }\n\n      var changed = this.getPages({\n        all: true\n      }).reduce(function (changed, page) {\n        return _this22.setNestedValue(page, submission.data, flags, changed) || changed;\n      }, false);\n\n      if (changed) {\n        this.pageFieldLogic(this.page);\n      }\n\n      this.setEditMode(submission);\n      return changed;\n    }\n  }, {\n    key: \"isClickable\",\n    value: function isClickable(page, index) {\n      return this.page !== index && (0, _utils.firstNonNil)([_lodash.default.get(page, 'breadcrumbClickable'), this.options.breadcrumbSettings.clickable]);\n    }\n  }, {\n    key: \"hasButton\",\n    value: function hasButton(name) {\n      var nextPage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getNextPage();\n\n      // get page options with global options as default values\n      var _$get = _lodash.default.get(this.currentPage, 'component.buttonSettings', {}),\n          _$get$previous = _$get.previous,\n          previous = _$get$previous === void 0 ? this.options.buttonSettings.showPrevious : _$get$previous,\n          _$get$cancel = _$get.cancel,\n          cancel = _$get$cancel === void 0 ? this.options.buttonSettings.showCancel : _$get$cancel,\n          _$get$submit = _$get.submit,\n          submit = _$get$submit === void 0 ? this.options.buttonSettings.showSubmit : _$get$submit,\n          _$get$next = _$get.next,\n          next = _$get$next === void 0 ? this.options.buttonSettings.showNext : _$get$next;\n\n      switch (name) {\n        case 'previous':\n          return previous && this.getPreviousPage() > -1;\n\n        case 'next':\n          return next && nextPage !== null && nextPage !== -1;\n\n        case 'cancel':\n          return cancel && !this.options.readOnly;\n\n        case 'submit':\n          return submit && !this.options.readOnly && (nextPage === null || this.page === this.pages.length - 1);\n\n        default:\n          return true;\n      }\n    }\n  }, {\n    key: \"pageId\",\n    value: function pageId(page) {\n      if (page.key) {\n        // Some panels have the same key....\n        return \"\".concat(page.key, \"-\").concat(page.title);\n      } else if (page.components && page.components.length > 0) {\n        return this.pageId(page.components[0]);\n      } else {\n        return page.title;\n      }\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(flags, changed, modified, changes) {\n      var _this23 = this;\n\n      _get(_getPrototypeOf(Wizard.prototype), \"onChange\", this).call(this, flags, changed, modified, changes);\n\n      if (this.alert && !this.submitted) {\n        this.checkValidity(this.localData, false, this.localData, true);\n        this.showErrors([], true, true);\n      } // If the pages change, need to redraw the header.\n\n\n      var currentPanels;\n      var panels;\n      var currentNextPage = this.currentNextPage;\n\n      if (this.hasExtraPages) {\n        currentPanels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n        this.establishPages();\n        panels = this.pages.map(function (page) {\n          return page.component.key;\n        });\n      } else {\n        var _this$currentPanel, _this$currentPanels;\n\n        currentPanels = this.currentPanels || this.pages.map(function (page) {\n          return page.component.key;\n        });\n        panels = this.establishPages().map(function (panel) {\n          return panel.key;\n        });\n        this.currentPanels = panels;\n\n        if ((_this$currentPanel = this.currentPanel) !== null && _this$currentPanel !== void 0 && _this$currentPanel.key && (_this$currentPanels = this.currentPanels) !== null && _this$currentPanels !== void 0 && _this$currentPanels.length) {\n          this.setPage(this.currentPanels.findIndex(function (panel) {\n            return panel === _this23.currentPanel.key;\n          }));\n        }\n      }\n\n      if (!_lodash.default.isEqual(panels, currentPanels) || flags && flags.fromSubmission) {\n        this.redrawHeader();\n      } // If the next page changes, then make sure to redraw navigation.\n\n\n      if (currentNextPage !== this.getNextPage()) {\n        this.redrawNavigation();\n      }\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      var _this$parent, _this$parent$componen;\n\n      if ((_this$parent = this.parent) !== null && _this$parent !== void 0 && (_this$parent$componen = _this$parent.component) !== null && _this$parent$componen !== void 0 && _this$parent$componen.modalEdit) {\n        return this.parent.redraw();\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"redraw\", this).call(this);\n    }\n  }, {\n    key: \"checkValidity\",\n    value: function checkValidity(data, dirty, row, currentPageOnly) {\n      if (!this.checkCondition(row, data)) {\n        this.setCustomValidity('');\n        return true;\n      }\n\n      var components = !currentPageOnly || this.isLastPage() ? this.getComponents() : this.currentPage.components;\n      return components.reduce(function (check, comp) {\n        return comp.checkValidity(data, dirty, row) && check;\n      }, true);\n    }\n  }, {\n    key: \"errors\",\n    get: function get() {\n      if (!this.isLastPage()) {\n        return this.currentPage.errors;\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"errors\", this);\n    }\n  }, {\n    key: \"focusOnComponent\",\n    value: function focusOnComponent(key) {\n      var _this24 = this;\n\n      var pageIndex = 0;\n\n      var _this$pages$filter = this.pages.filter(function (page, index) {\n        var hasComponent = false;\n        page.getComponent(key, function (comp) {\n          if (comp.path === key) {\n            pageIndex = index;\n            hasComponent = true;\n          }\n        });\n        return hasComponent;\n      }),\n          _this$pages$filter2 = _slicedToArray(_this$pages$filter, 1),\n          page = _this$pages$filter2[0];\n\n      if (page && page !== this.currentPage) {\n        return this.setPage(pageIndex).then(function () {\n          _this24.checkValidity(_this24.submission.data, true, _this24.submission.data);\n\n          _this24.showErrors();\n\n          _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", _this24).call(_this24, key);\n        });\n      }\n\n      return _get(_getPrototypeOf(Wizard.prototype), \"focusOnComponent\", this).call(this, key);\n    }\n  }]);\n\n  return Wizard;\n}(_Webform2.default);\n\nexports.default = Wizard;\nWizard.setBaseUrl = _Formio.GlobalFormio.setBaseUrl;\nWizard.setApiUrl = _Formio.GlobalFormio.setApiUrl;\nWizard.setAppUrl = _Formio.GlobalFormio.setAppUrl;"],"mappings":"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"},"metadata":{},"sourceType":"script"}