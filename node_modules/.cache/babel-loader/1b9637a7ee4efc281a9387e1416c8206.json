{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es.array.filter.js\");\nrequire(\"core-js/modules/es.object.to-string.js\");\nrequire(\"core-js/modules/es.array.splice.js\");\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\nvar _Evaluator = _interopRequireDefault(require(\"../../../../utils/Evaluator\"));\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar EditFormUtils = {\n  sortAndFilterComponents: function sortAndFilterComponents(components) {\n    return _lodash.default.filter(_lodash.default.sortBy(components, 'weight'), function (item) {\n      return !item.ignore;\n    });\n  },\n  unifyComponents: function unifyComponents(objValue, srcValue) {\n    if (objValue.key && srcValue.key) {\n      if (objValue.skipMerge || srcValue.skipMerge) {\n        return false;\n      }\n      if (objValue.key === srcValue.key) {\n        // Create complete objects by including missing keys.\n        _lodash.default.each(objValue, function (value, prop) {\n          if (objValue.overrideEditForm || !srcValue.hasOwnProperty(prop)) {\n            srcValue[prop] = value;\n          }\n        });\n        _lodash.default.each(srcValue, function (value, prop) {\n          if (srcValue.overrideEditForm || !objValue.hasOwnProperty(prop)) {\n            objValue[prop] = value;\n          }\n        });\n        if (objValue.components) {\n          srcValue.components = EditFormUtils.sortAndFilterComponents(_lodash.default.unionWith(objValue.components, srcValue.components, EditFormUtils.unifyComponents));\n        }\n        return true;\n      } else {\n        return false;\n      }\n    }\n    return _lodash.default.isEqual(objValue, srcValue);\n  },\n  logicVariablesTable: function logicVariablesTable(additional) {\n    additional = additional || '';\n    return {\n      type: 'htmlelement',\n      tag: 'div',\n      /* eslint-disable prefer-template */\n      content: '<p>The following variables are available in all scripts.</p>' + '<table class=\"table table-bordered table-condensed table-striped\">' + additional + '<tr><th>form</th><td>The complete form JSON object</td></tr>' + '<tr><th>submission</th><td>The complete submission object.</td></tr>' + '<tr><th>data</th><td>The complete submission data object.</td></tr>' + '<tr><th>row</th><td>Contextual \"row\" data, used within DataGrid, EditGrid, and Container components</td></tr>' + '<tr><th>component</th><td>The current component JSON</td></tr>' + '<tr><th>instance</th><td>The current component instance.</td></tr>' + '<tr><th>value</th><td>The current value of the component.</td></tr>' + '<tr><th>moment</th><td>The moment.js library for date manipulation.</td></tr>' + '<tr><th>_</th><td>An instance of <a href=\"https://lodash.com/docs/\" target=\"_blank\">Lodash</a>.</td></tr>' + '<tr><th>utils</th><td>An instance of the <a href=\"http://formio.github.io/formio.js/docs/identifiers.html#utils\" target=\"_blank\">FormioUtils</a> object.</td></tr>' + '<tr><th>util</th><td>An alias for \"utils\".</td></tr>' + '</table><br/>'\n      /* eslint-enable prefer-template */\n    };\n  },\n\n  javaScriptValue: function javaScriptValue(title, property, propertyJSON, weight, exampleHTML, exampleJSON) {\n    var additionalParams = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : '';\n    var excludeJSONLogic = arguments.length > 7 ? arguments[7] : undefined;\n    var components = [this.logicVariablesTable(additionalParams), {\n      type: 'panel',\n      title: 'JavaScript',\n      collapsible: true,\n      collapsed: false,\n      style: {\n        'margin-bottom': '10px'\n      },\n      key: \"\".concat(property, \"-js\"),\n      customConditional: function customConditional() {\n        return !_Evaluator.default.noeval || _Evaluator.default.protectedEval;\n      },\n      components: [{\n        type: 'textarea',\n        key: property,\n        rows: 5,\n        editor: 'ace',\n        hideLabel: true,\n        as: 'javascript',\n        input: true\n      }, {\n        type: 'htmlelement',\n        tag: 'div',\n        content: \"<p>Enter custom javascript code.</p>\".concat(exampleHTML)\n      }]\n    }, {\n      type: 'panel',\n      title: 'JSONLogic',\n      collapsible: true,\n      collapsed: true,\n      key: \"\".concat(property, \"-json\"),\n      components: [{\n        type: 'htmlelement',\n        tag: 'div',\n        /* eslint-disable prefer-template */\n        content: '<p>Execute custom logic using <a href=\"http://jsonlogic.com/\" target=\"_blank\">JSONLogic</a>.</p>' + '<p>Full <a href=\"https://lodash.com/docs\" target=\"_blank\">Lodash</a> support is provided using an \"_\" before each operation, such as <code>{\"_sum\": {var: \"data.a\"}}</code></p>' + exampleJSON\n        /* eslint-enable prefer-template */\n      }, {\n        type: 'textarea',\n        key: propertyJSON,\n        rows: 5,\n        editor: 'ace',\n        hideLabel: true,\n        as: 'json',\n        input: true\n      }]\n    }];\n    if (excludeJSONLogic) {\n      components.splice(2, 1);\n    }\n    return {\n      type: 'panel',\n      title: title,\n      theme: 'default',\n      collapsible: true,\n      collapsed: true,\n      key: \"\".concat(property, \"Panel\"),\n      weight: weight,\n      components: components\n    };\n  }\n};\nvar _default = EditFormUtils;\nexports.default = _default;","map":{"version":3,"names":["Object","defineProperty","exports","value","default","require","_lodash","_interopRequireDefault","_Evaluator","obj","__esModule","EditFormUtils","sortAndFilterComponents","components","filter","sortBy","item","ignore","unifyComponents","objValue","srcValue","key","skipMerge","each","prop","overrideEditForm","hasOwnProperty","unionWith","isEqual","logicVariablesTable","additional","type","tag","content","javaScriptValue","title","property","propertyJSON","weight","exampleHTML","exampleJSON","additionalParams","arguments","length","undefined","excludeJSONLogic","collapsible","collapsed","style","concat","customConditional","noeval","protectedEval","rows","editor","hideLabel","as","input","splice","theme","_default"],"sources":["D:/task/node_modules/formiojs/components/_classes/component/editForm/utils.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.array.splice.js\");\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _Evaluator = _interopRequireDefault(require(\"../../../../utils/Evaluator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar EditFormUtils = {\n  sortAndFilterComponents: function sortAndFilterComponents(components) {\n    return _lodash.default.filter(_lodash.default.sortBy(components, 'weight'), function (item) {\n      return !item.ignore;\n    });\n  },\n  unifyComponents: function unifyComponents(objValue, srcValue) {\n    if (objValue.key && srcValue.key) {\n      if (objValue.skipMerge || srcValue.skipMerge) {\n        return false;\n      }\n\n      if (objValue.key === srcValue.key) {\n        // Create complete objects by including missing keys.\n        _lodash.default.each(objValue, function (value, prop) {\n          if (objValue.overrideEditForm || !srcValue.hasOwnProperty(prop)) {\n            srcValue[prop] = value;\n          }\n        });\n\n        _lodash.default.each(srcValue, function (value, prop) {\n          if (srcValue.overrideEditForm || !objValue.hasOwnProperty(prop)) {\n            objValue[prop] = value;\n          }\n        });\n\n        if (objValue.components) {\n          srcValue.components = EditFormUtils.sortAndFilterComponents(_lodash.default.unionWith(objValue.components, srcValue.components, EditFormUtils.unifyComponents));\n        }\n\n        return true;\n      } else {\n        return false;\n      }\n    }\n\n    return _lodash.default.isEqual(objValue, srcValue);\n  },\n  logicVariablesTable: function logicVariablesTable(additional) {\n    additional = additional || '';\n    return {\n      type: 'htmlelement',\n      tag: 'div',\n\n      /* eslint-disable prefer-template */\n      content: '<p>The following variables are available in all scripts.</p>' + '<table class=\"table table-bordered table-condensed table-striped\">' + additional + '<tr><th>form</th><td>The complete form JSON object</td></tr>' + '<tr><th>submission</th><td>The complete submission object.</td></tr>' + '<tr><th>data</th><td>The complete submission data object.</td></tr>' + '<tr><th>row</th><td>Contextual \"row\" data, used within DataGrid, EditGrid, and Container components</td></tr>' + '<tr><th>component</th><td>The current component JSON</td></tr>' + '<tr><th>instance</th><td>The current component instance.</td></tr>' + '<tr><th>value</th><td>The current value of the component.</td></tr>' + '<tr><th>moment</th><td>The moment.js library for date manipulation.</td></tr>' + '<tr><th>_</th><td>An instance of <a href=\"https://lodash.com/docs/\" target=\"_blank\">Lodash</a>.</td></tr>' + '<tr><th>utils</th><td>An instance of the <a href=\"http://formio.github.io/formio.js/docs/identifiers.html#utils\" target=\"_blank\">FormioUtils</a> object.</td></tr>' + '<tr><th>util</th><td>An alias for \"utils\".</td></tr>' + '</table><br/>'\n      /* eslint-enable prefer-template */\n\n    };\n  },\n  javaScriptValue: function javaScriptValue(title, property, propertyJSON, weight, exampleHTML, exampleJSON) {\n    var additionalParams = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : '';\n    var excludeJSONLogic = arguments.length > 7 ? arguments[7] : undefined;\n    var components = [this.logicVariablesTable(additionalParams), {\n      type: 'panel',\n      title: 'JavaScript',\n      collapsible: true,\n      collapsed: false,\n      style: {\n        'margin-bottom': '10px'\n      },\n      key: \"\".concat(property, \"-js\"),\n      customConditional: function customConditional() {\n        return !_Evaluator.default.noeval || _Evaluator.default.protectedEval;\n      },\n      components: [{\n        type: 'textarea',\n        key: property,\n        rows: 5,\n        editor: 'ace',\n        hideLabel: true,\n        as: 'javascript',\n        input: true\n      }, {\n        type: 'htmlelement',\n        tag: 'div',\n        content: \"<p>Enter custom javascript code.</p>\".concat(exampleHTML)\n      }]\n    }, {\n      type: 'panel',\n      title: 'JSONLogic',\n      collapsible: true,\n      collapsed: true,\n      key: \"\".concat(property, \"-json\"),\n      components: [{\n        type: 'htmlelement',\n        tag: 'div',\n\n        /* eslint-disable prefer-template */\n        content: '<p>Execute custom logic using <a href=\"http://jsonlogic.com/\" target=\"_blank\">JSONLogic</a>.</p>' + '<p>Full <a href=\"https://lodash.com/docs\" target=\"_blank\">Lodash</a> support is provided using an \"_\" before each operation, such as <code>{\"_sum\": {var: \"data.a\"}}</code></p>' + exampleJSON\n        /* eslint-enable prefer-template */\n\n      }, {\n        type: 'textarea',\n        key: propertyJSON,\n        rows: 5,\n        editor: 'ace',\n        hideLabel: true,\n        as: 'json',\n        input: true\n      }]\n    }];\n\n    if (excludeJSONLogic) {\n      components.splice(2, 1);\n    }\n\n    return {\n      type: 'panel',\n      title: title,\n      theme: 'default',\n      collapsible: true,\n      collapsed: true,\n      key: \"\".concat(property, \"Panel\"),\n      weight: weight,\n      components: components\n    };\n  }\n};\nvar _default = EditFormUtils;\nexports.default = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script"}